!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){"use strict";c(1),c(2);var d=c(6);console.log(d)},function(a,b){"use strict";document.write("My App..."),console.log("Working...")},function(a,b,c){var d=c(3);"string"==typeof d&&(d=[[a.id,d,""]]);c(5)(d,{});d.locals&&(a.exports=d.locals)},function(a,b,c){b=a.exports=c(4)(),b.push([a.id,"html, body {\n  margin: 0;\n  padding: 0; }\n",""])},function(a,b){a.exports=function(){var a=[];return a.toString=function(){for(var a=[],b=0;b<this.length;b++){var c=this[b];c[2]?a.push("@media "+c[2]+"{"+c[1]+"}"):a.push(c[1])}return a.join("")},a.i=function(b,c){"string"==typeof b&&(b=[[null,b,""]]);for(var d={},e=0;e<this.length;e++){var f=this[e][0];"number"==typeof f&&(d[f]=!0)}for(e=0;e<b.length;e++){var g=b[e];"number"==typeof g[0]&&d[g[0]]||(c&&!g[2]?g[2]=c:c&&(g[2]="("+g[2]+") and ("+c+")"),a.push(g))}},a}},function(a,b,c){function d(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=n[d.id];if(e){e.refs++;for(var f=0;f<e.parts.length;f++)e.parts[f](d.parts[f]);for(;f<d.parts.length;f++)e.parts.push(j(d.parts[f],b))}else{for(var g=[],f=0;f<d.parts.length;f++)g.push(j(d.parts[f],b));n[d.id]={id:d.id,refs:1,parts:g}}}}function e(a){for(var b=[],c={},d=0;d<a.length;d++){var e=a[d],f=e[0],g=e[1],h=e[2],i=e[3],j={css:g,media:h,sourceMap:i};c[f]?c[f].parts.push(j):b.push(c[f]={id:f,parts:[j]})}return b}function f(a,b){var c=q(),d=t[t.length-1];if("top"===a.insertAt)d?d.nextSibling?c.insertBefore(b,d.nextSibling):c.appendChild(b):c.insertBefore(b,c.firstChild),t.push(b);else{if("bottom"!==a.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");c.appendChild(b)}}function g(a){a.parentNode.removeChild(a);var b=t.indexOf(a);b>=0&&t.splice(b,1)}function h(a){var b=document.createElement("style");return b.type="text/css",f(a,b),b}function i(a){var b=document.createElement("link");return b.rel="stylesheet",f(a,b),b}function j(a,b){var c,d,e;if(b.singleton){var f=s++;c=r||(r=h(b)),d=k.bind(null,c,f,!1),e=k.bind(null,c,f,!0)}else a.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(c=i(b),d=m.bind(null,c),e=function(){g(c),c.href&&URL.revokeObjectURL(c.href)}):(c=h(b),d=l.bind(null,c),e=function(){g(c)});return d(a),function(b){if(b){if(b.css===a.css&&b.media===a.media&&b.sourceMap===a.sourceMap)return;d(a=b)}else e()}}function k(a,b,c,d){var e=c?"":d.css;if(a.styleSheet)a.styleSheet.cssText=u(b,e);else{var f=document.createTextNode(e),g=a.childNodes;g[b]&&a.removeChild(g[b]),g.length?a.insertBefore(f,g[b]):a.appendChild(f)}}function l(a,b){var c=b.css,d=b.media;if(d&&a.setAttribute("media",d),a.styleSheet)a.styleSheet.cssText=c;else{for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(document.createTextNode(c))}}function m(a,b){var c=b.css,d=b.sourceMap;d&&(c+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(d))))+" */");var e=new Blob([c],{type:"text/css"}),f=a.href;a.href=URL.createObjectURL(e),f&&URL.revokeObjectURL(f)}var n={},o=function(a){var b;return function(){return"undefined"==typeof b&&(b=a.apply(this,arguments)),b}},p=o(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),q=o(function(){return document.head||document.getElementsByTagName("head")[0]}),r=null,s=0,t=[];a.exports=function(a,b){if("object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");b=b||{},"undefined"==typeof b.singleton&&(b.singleton=p()),"undefined"==typeof b.insertAt&&(b.insertAt="bottom");var c=e(a);return d(c,b),function(a){for(var f=[],g=0;g<c.length;g++){var h=c[g],i=n[h.id];i.refs--,f.push(i)}if(a){var j=e(a);d(j,b)}for(var g=0;g<f.length;g++){var i=f[g];if(0===i.refs){for(var k=0;k<i.parts.length;k++)i.parts[k]();delete n[i.id]}}}};var u=function(){var a=[];return function(b,c){return a[b]=c,a.filter(Boolean).join("\n")}}()},function(a,b,c){var d;!function(e,f){d=function(){return f()}.call(b,c,b,a),!(void 0!==d&&(a.exports=d))}(this,function(){"use strict";function a(a){c=a()}function b(a){a(c)}var c;return a(function(){var a=function(a,b){this.isUndef(a)||1===a?this.input=this.context.createGain():a>1&&(this.input=new Array(a)),this.isUndef(b)||1===b?this.output=this.context.createGain():b>1&&(this.output=new Array(a))};a.prototype.set=function(b,c,d){if(this.isObject(b))d=c;else if(this.isString(b)){var e={};e[b]=c,b=e}a:for(var f in b){c=b[f];var g=this;if(-1!==f.indexOf(".")){for(var h=f.split("."),i=0;i<h.length-1;i++)if(g=g[h[i]],g instanceof a){h.splice(0,i+1);var j=h.join(".");g.set(j,c);continue a}f=h[h.length-1]}var k=g[f];this.isUndef(k)||(a.Signal&&k instanceof a.Signal||a.Param&&k instanceof a.Param?k.value!==c&&(this.isUndef(d)?k.value=c:k.rampTo(c,d)):k instanceof AudioParam?k.value!==c&&(k.value=c):k instanceof a?k.set(c):k!==c&&(g[f]=c))}return this},a.prototype.get=function(b){this.isUndef(b)?b=this._collectDefaults(this.constructor):this.isString(b)&&(b=[b]);for(var c={},d=0;d<b.length;d++){var e=b[d],f=this,g=c;if(-1!==e.indexOf(".")){for(var h=e.split("."),i=0;i<h.length-1;i++){var j=h[i];g[j]=g[j]||{},g=g[j],f=f[j]}e=h[h.length-1]}var k=f[e];this.isObject(b[e])?g[e]=k.get():a.Signal&&k instanceof a.Signal?g[e]=k.value:a.Param&&k instanceof a.Param?g[e]=k.value:k instanceof AudioParam?g[e]=k.value:k instanceof a?g[e]=k.get():this.isFunction(k)||this.isUndef(k)||(g[e]=k)}return c},a.prototype._collectDefaults=function(a){var b=[];if(this.isUndef(a.defaults)||(b=Object.keys(a.defaults)),!this.isUndef(a._super))for(var c=this._collectDefaults(a._super),d=0;d<c.length;d++)-1===b.indexOf(c[d])&&b.push(c[d]);return b},a.prototype.toString=function(){for(var b in a){var c=b[0].match(/^[A-Z]$/),d=a[b]===this.constructor;if(this.isFunction(a[b])&&c&&d)return b}return"Tone"},Object.defineProperty(a.prototype,"numberOfInputs",{get:function(){return this.input?this.isArray(this.input)?this.input.length:1:0}}),Object.defineProperty(a.prototype,"numberOfOutputs",{get:function(){return this.output?this.isArray(this.output)?this.output.length:1:0}}),a.prototype.dispose=function(){return this.isUndef(this.input)||(this.input instanceof AudioNode&&this.input.disconnect(),this.input=null),this.isUndef(this.output)||(this.output instanceof AudioNode&&this.output.disconnect(),this.output=null),this},a.prototype.connect=function(a,b,c){return Array.isArray(this.output)?(b=this.defaultArg(b,0),this.output[b].connect(a,0,c)):this.output.connect(a,b,c),this},a.prototype.disconnect=function(a,b,c){this.isArray(this.output)?this.isNumber(a)?this.output[a].disconnect():(b=this.defaultArg(b,0),this.output[b].disconnect(a,0,c)):this.output.disconnect.apply(this.output,arguments)},a.prototype.connectSeries=function(){if(arguments.length>1)for(var a=arguments[0],b=1;b<arguments.length;b++){var c=arguments[b];a.connect(c),a=c}return this},a.prototype.chain=function(){if(arguments.length>0)for(var a=this,b=0;b<arguments.length;b++){var c=arguments[b];a.connect(c),a=c}return this},a.prototype.fan=function(){if(arguments.length>0)for(var a=0;a<arguments.length;a++)this.connect(arguments[a]);return this},AudioNode.prototype.chain=a.prototype.chain,AudioNode.prototype.fan=a.prototype.fan,a.prototype.defaultArg=function(a,b){if(this.isObject(a)&&this.isObject(b)){var c={};for(var d in a)c[d]=this.defaultArg(b[d],a[d]);for(var e in b)c[e]=this.defaultArg(a[e],b[e]);return c}return this.isUndef(a)?b:a},a.prototype.optionsObject=function(a,b,c){var d={};if(1===a.length&&this.isObject(a[0]))d=a[0];else for(var e=0;e<b.length;e++)d[b[e]]=a[e];return this.isUndef(c)?d:this.defaultArg(d,c)},a.prototype.isUndef=function(a){return"undefined"==typeof a},a.prototype.isFunction=function(a){return"function"==typeof a},a.prototype.isNumber=function(a){return"number"==typeof a},a.prototype.isObject=function(a){return"[object Object]"===Object.prototype.toString.call(a)&&a.constructor===Object},a.prototype.isBoolean=function(a){return"boolean"==typeof a},a.prototype.isArray=function(a){return Array.isArray(a)},a.prototype.isString=function(a){return"string"==typeof a},a.noOp=function(){},a.prototype._readOnly=function(a){if(Array.isArray(a))for(var b=0;b<a.length;b++)this._readOnly(a[b]);else Object.defineProperty(this,a,{writable:!1,enumerable:!0})},a.prototype._writable=function(a){if(Array.isArray(a))for(var b=0;b<a.length;b++)this._writable(a[b]);else Object.defineProperty(this,a,{writable:!0})},a.State={Started:"started",Stopped:"stopped",Paused:"paused"},a.prototype.equalPowerScale=function(a){var b=.5*Math.PI;return Math.sin(a*b)},a.prototype.dbToGain=function(a){return Math.pow(2,a/6)},a.prototype.gainToDb=function(a){return 20*(Math.log(a)/Math.LN10)},a.prototype.intervalToFrequencyRatio=function(a){return Math.pow(2,a/12)},a.prototype.now=function(){return a.context.now()},a.now=function(){return a.context.now()},a.extend=function(b,c){function d(){}a.prototype.isUndef(c)&&(c=a),d.prototype=c.prototype,b.prototype=new d,b.prototype.constructor=b,b._super=c};var b;return Object.defineProperty(a,"context",{get:function(){return b},set:function(c){b=a.Context&&c instanceof a.Context?c:new a.Context(c),a.Context&&a.Context.emit("init",b)}}),Object.defineProperty(a.prototype,"context",{get:function(){return a.context}}),a.setContext=function(b){a.context=b},Object.defineProperty(a.prototype,"blockTime",{get:function(){return 128/this.context.sampleRate}}),Object.defineProperty(a.prototype,"sampleTime",{get:function(){return 1/this.context.sampleRate}}),Object.defineProperty(a,"supported",{get:function(){var a=window.hasOwnProperty("AudioContext")||window.hasOwnProperty("webkitAudioContext"),b=window.hasOwnProperty("Promise"),c=window.hasOwnProperty("Worker");return a&&b&&c}}),a.version="r10",window.TONE_SILENCE_VERSION_LOGGING||console.log("%c * Tone.js "+a.version+" * ","background: #000; color: #fff"),a}),b(function(a){return a.SignalBase=function(){},a.extend(a.SignalBase),a.SignalBase.prototype.connect=function(b,c,d){return a.Signal&&a.Signal===b.constructor||a.Param&&a.Param===b.constructor||a.TimelineSignal&&a.TimelineSignal===b.constructor?(b._param.cancelScheduledValues(0),b._param.value=0,b.overridden=!0):b instanceof AudioParam&&(b.cancelScheduledValues(0),b.value=0),a.prototype.connect.call(this,b,c,d),this},a.SignalBase}),b(function(a){return a.WaveShaper=function(a,b){this._shaper=this.input=this.output=this.context.createWaveShaper(),this._curve=null,Array.isArray(a)?this.curve=a:isFinite(a)||this.isUndef(a)?this._curve=new Float32Array(this.defaultArg(a,1024)):this.isFunction(a)&&(this._curve=new Float32Array(this.defaultArg(b,1024)),this.setMap(a))},a.extend(a.WaveShaper,a.SignalBase),a.WaveShaper.prototype.setMap=function(a){for(var b=0,c=this._curve.length;c>b;b++){var d=b/(c-1)*2-1;this._curve[b]=a(d,b)}return this._shaper.curve=this._curve,this},Object.defineProperty(a.WaveShaper.prototype,"curve",{get:function(){return this._shaper.curve},set:function(a){this._curve=new Float32Array(a),this._shaper.curve=this._curve}}),Object.defineProperty(a.WaveShaper.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(a){if(-1===["none","2x","4x"].indexOf(a))throw new RangeError("Tone.WaveShaper: oversampling must be either 'none', '2x', or '4x'");this._shaper.oversample=a}}),a.WaveShaper.prototype.dispose=function(){return a.prototype.dispose.call(this),this._shaper.disconnect(),this._shaper=null,this._curve=null,this},a.WaveShaper}),b(function(a){return a.TimeBase=function(b,c){if(!(this instanceof a.TimeBase))return new a.TimeBase(b,c);if(this._expr=this._noOp,b instanceof a.TimeBase)this.copy(b);else if(!this.isUndef(c)||this.isNumber(b)){c=this.defaultArg(c,this._defaultUnits);var d=this._primaryExpressions[c].method;this._expr=d.bind(this,b)}else this.isString(b)?this.set(b):this.isUndef(b)&&(this._expr=this._defaultExpr())},a.extend(a.TimeBase),a.TimeBase.prototype.set=function(a){return this._expr=this._parseExprString(a),this},a.TimeBase.prototype.clone=function(){var a=new this.constructor;return a.copy(this),a},a.TimeBase.prototype.copy=function(a){var b=a._expr();return this.set(b)},a.TimeBase.prototype._primaryExpressions={n:{regexp:/^(\d+)n/i,method:function(a){return a=parseInt(a),1===a?this._beatsToUnits(this._timeSignature()):this._beatsToUnits(4/a)}},t:{regexp:/^(\d+)t/i,method:function(a){return a=parseInt(a),this._beatsToUnits(8/(3*parseInt(a)))}},m:{regexp:/^(\d+)m/i,method:function(a){return this._beatsToUnits(parseInt(a)*this._timeSignature())}},i:{regexp:/^(\d+)i/i,method:function(a){return this._ticksToUnits(parseInt(a))}},hz:{regexp:/^(\d+(?:\.\d+)?)hz/i,method:function(a){return this._frequencyToUnits(parseFloat(a))}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(a,b,c){var d=0;return a&&"0"!==a&&(d+=this._beatsToUnits(this._timeSignature()*parseFloat(a))),b&&"0"!==b&&(d+=this._beatsToUnits(parseFloat(b))),c&&"0"!==c&&(d+=this._beatsToUnits(parseFloat(c)/4)),d}},s:{regexp:/^(\d+(?:\.\d+)?s)/,method:function(a){return this._secondsToUnits(parseFloat(a))}},samples:{regexp:/^(\d+)samples/,method:function(a){return parseInt(a)/this.context.sampleRate}},"default":{regexp:/^(\d+(?:\.\d+)?)/,method:function(a){return this._primaryExpressions[this._defaultUnits].method.call(this,a)}}},a.TimeBase.prototype._binaryExpressions={"+":{regexp:/^\+/,precedence:2,method:function(a,b){return a()+b()}},"-":{regexp:/^\-/,precedence:2,method:function(a,b){return a()-b()}},"*":{regexp:/^\*/,precedence:1,method:function(a,b){return a()*b()}},"/":{regexp:/^\//,precedence:1,method:function(a,b){return a()/b()}}},a.TimeBase.prototype._unaryExpressions={neg:{regexp:/^\-/,method:function(a){return-a()}}},a.TimeBase.prototype._syntaxGlue={"(":{regexp:/^\(/},")":{regexp:/^\)/}},a.TimeBase.prototype._tokenize=function(a){function b(a,b){for(var c=["_binaryExpressions","_unaryExpressions","_primaryExpressions","_syntaxGlue"],d=0;d<c.length;d++){var e=b[c[d]];for(var f in e){var g=e[f],h=g.regexp,i=a.match(h);if(null!==i)return{method:g.method,precedence:g.precedence,regexp:g.regexp,value:i[0]}}}throw new SyntaxError("Tone.TimeBase: Unexpected token "+a)}for(var c=-1,d=[];a.length>0;){a=a.trim();var e=b(a,this);d.push(e),a=a.substr(e.value.length)}return{next:function(){return d[++c]},peek:function(){return d[c+1]}}},a.TimeBase.prototype._matchGroup=function(a,b,c){var d=!1;if(!this.isUndef(a))for(var e in b){var f=b[e];if(f.regexp.test(a.value)){if(this.isUndef(c))return f;if(f.precedence===c)return f}}return d},a.TimeBase.prototype._parseBinary=function(a,b){this.isUndef(b)&&(b=2);var c;c=0>b?this._parseUnary(a):this._parseBinary(a,b-1);for(var d=a.peek();d&&this._matchGroup(d,this._binaryExpressions,b);)d=a.next(),c=d.method.bind(this,c,this._parseBinary(a,b-1)),d=a.peek();return c},a.TimeBase.prototype._parseUnary=function(a){var b,c;b=a.peek();var d=this._matchGroup(b,this._unaryExpressions);return d?(b=a.next(),c=this._parseUnary(a),d.method.bind(this,c)):this._parsePrimary(a)},a.TimeBase.prototype._parsePrimary=function(a){var b,c;if(b=a.peek(),this.isUndef(b))throw new SyntaxError("Tone.TimeBase: Unexpected end of expression");if(this._matchGroup(b,this._primaryExpressions)){b=a.next();var d=b.value.match(b.regexp);return b.method.bind(this,d[1],d[2],d[3])}if(b&&"("===b.value){if(a.next(),c=this._parseBinary(a),b=a.next(),!b||")"!==b.value)throw new SyntaxError("Expected )");return c}throw new SyntaxError("Tone.TimeBase: Cannot process token "+b.value)},a.TimeBase.prototype._parseExprString=function(a){this.isString(a)||(a=a.toString());var b=this._tokenize(a),c=this._parseBinary(b);return c},a.TimeBase.prototype._noOp=function(){return 0},a.TimeBase.prototype._defaultExpr=function(){return this._noOp},a.TimeBase.prototype._defaultUnits="s",a.TimeBase.prototype._frequencyToUnits=function(a){return 1/a},a.TimeBase.prototype._beatsToUnits=function(b){return 60/a.Transport.bpm.value*b},a.TimeBase.prototype._secondsToUnits=function(a){return a},a.TimeBase.prototype._ticksToUnits=function(b){return b*(this._beatsToUnits(1)/a.Transport.PPQ)},a.TimeBase.prototype._timeSignature=function(){return a.Transport.timeSignature},a.TimeBase.prototype._pushExpr=function(b,c,d){return b instanceof a.TimeBase||(b=new this.constructor(b,d)),this._expr=this._binaryExpressions[c].method.bind(this,this._expr,b._expr),this},a.TimeBase.prototype.add=function(a,b){return this._pushExpr(a,"+",b)},a.TimeBase.prototype.sub=function(a,b){return this._pushExpr(a,"-",b)},a.TimeBase.prototype.mult=function(a,b){return this._pushExpr(a,"*",b)},a.TimeBase.prototype.div=function(a,b){return this._pushExpr(a,"/",b)},a.TimeBase.prototype.valueOf=function(){return this._expr()},a.TimeBase.prototype.dispose=function(){this._expr=null},a.TimeBase}),b(function(a){return a.Time=function(b,c){return this instanceof a.Time?(this._plusNow=!1,void a.TimeBase.call(this,b,c)):new a.Time(b,c)},a.extend(a.Time,a.TimeBase),a.Time.prototype._unaryExpressions=Object.create(a.TimeBase.prototype._unaryExpressions),a.Time.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(b){return a.Transport.nextSubdivision(b())}},a.Time.prototype._unaryExpressions.now={regexp:/^\+/,method:function(a){return this._plusNow=!0,a()}},a.Time.prototype.quantize=function(a,b){return b=this.defaultArg(b,1),this._expr=function(a,b,c){a=a(),b=b.toSeconds();var d=Math.round(a/b),e=d*b,f=e-a;return a+f*c}.bind(this,this._expr,new this.constructor(a),b),this},a.Time.prototype.addNow=function(){return this._plusNow=!0,this},a.Time.prototype._defaultExpr=function(){return this._plusNow=!0,this._noOp},a.Time.prototype.copy=function(b){return a.TimeBase.prototype.copy.call(this,b),this._plusNow=b._plusNow,this},a.Time.prototype.toNotation=function(){var a=this.toSeconds(),b=["1m","2n","4n","8n","16n","32n","64n","128n"],c=this._toNotationHelper(a,b),d=["1m","2n","2t","4n","4t","8n","8t","16n","16t","32n","32t","64n","64t","128n"],e=this._toNotationHelper(a,d);return e.split("+").length<c.split("+").length?e:c},a.Time.prototype._toNotationHelper=function(a,b){for(var c=this._notationToUnits(b[b.length-1]),d="",e=0;e<b.length;e++){var f=this._notationToUnits(b[e]),g=a/f,h=1e-6;if(h>1-g%1&&(g+=h),g=Math.floor(g),g>0){if(d+=1===g?b[e]:g.toString()+"*"+b[e],a-=g*f,c>a)break;d+=" + "}}return""===d&&(d="0"),d},a.Time.prototype._notationToUnits=function(a){for(var b=this._primaryExpressions,c=[b.n,b.t,b.m],d=0;d<c.length;d++){var e=c[d],f=a.match(e.regexp);if(f)return e.method.call(this,f[1])}},a.Time.prototype.toBarsBeatsSixteenths=function(){var a=this._beatsToUnits(1),b=this.toSeconds()/a,c=Math.floor(b/this._timeSignature()),d=b%1*4;b=Math.floor(b)%this._timeSignature(),d=d.toString(),d.length>3&&(d=parseFloat(d).toFixed(3));var e=[c,b,d];return e.join(":")},a.Time.prototype.toTicks=function(){var b=this._beatsToUnits(1),c=this.valueOf()/b;return Math.floor(c*a.Transport.PPQ)},a.Time.prototype.toSamples=function(){return this.toSeconds()*this.context.sampleRate},a.Time.prototype.toFrequency=function(){return 1/this.toSeconds()},a.Time.prototype.toSeconds=function(){return this.valueOf()},a.Time.prototype.toMilliseconds=function(){return 1e3*this.toSeconds()},a.Time.prototype.valueOf=function(){var a=this._expr();return a+(this._plusNow?this.now():0)},a.Time}),b(function(a){a.Frequency=function(b,c){return this instanceof a.Frequency?void a.TimeBase.call(this,b,c):new a.Frequency(b,c)},a.extend(a.Frequency,a.TimeBase),a.Frequency.prototype._primaryExpressions=Object.create(a.TimeBase.prototype._primaryExpressions),a.Frequency.prototype._primaryExpressions.midi={regexp:/^(\d+(?:\.\d+)?midi)/,method:function(a){return this.midiToFrequency(a)}},a.Frequency.prototype._primaryExpressions.note={regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method:function(a,c){var d=b[a.toLowerCase()],e=d+12*(parseInt(c)+1);return this.midiToFrequency(e)}},a.Frequency.prototype._primaryExpressions.tr={regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(a,b,c){var d=1;return a&&"0"!==a&&(d*=this._beatsToUnits(this._timeSignature()*parseFloat(a))),b&&"0"!==b&&(d*=this._beatsToUnits(parseFloat(b))),c&&"0"!==c&&(d*=this._beatsToUnits(parseFloat(c)/4)),d}},a.Frequency.prototype.transpose=function(a){return this._expr=function(a,b){var c=a();return c*this.intervalToFrequencyRatio(b)}.bind(this,this._expr,a),this},a.Frequency.prototype.harmonize=function(a){return this._expr=function(a,b){for(var c=a(),d=[],e=0;e<b.length;e++)d[e]=c*this.intervalToFrequencyRatio(b[e]);return d}.bind(this,this._expr,a),this},a.Frequency.prototype.toMidi=function(){return this.frequencyToMidi(this.valueOf())},a.Frequency.prototype.toNote=function(){var b=this.valueOf(),d=Math.log(b/a.Frequency.A4)/Math.LN2,e=Math.round(12*d)+57,f=Math.floor(e/12);0>f&&(e+=-12*f);var g=c[e%12];return g+f.toString()},a.Frequency.prototype.toSeconds=function(){return 1/this.valueOf()},a.Frequency.prototype.toFrequency=function(){return this.valueOf()},a.Frequency.prototype.toTicks=function(){var b=this._beatsToUnits(1),c=this.valueOf()/b;return Math.floor(c*a.Transport.PPQ)},a.Frequency.prototype._frequencyToUnits=function(a){return a},a.Frequency.prototype._ticksToUnits=function(b){return 1/(60*b/(a.Transport.bpm.value*a.Transport.PPQ))},a.Frequency.prototype._beatsToUnits=function(b){return 1/a.TimeBase.prototype._beatsToUnits.call(this,b)},a.Frequency.prototype._secondsToUnits=function(a){return 1/a},a.Frequency.prototype._defaultUnits="hz";var b={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},c=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return a.Frequency.A4=440,a.Frequency.prototype.midiToFrequency=function(b){return a.Frequency.A4*Math.pow(2,(b-69)/12)},a.Frequency.prototype.frequencyToMidi=function(b){return 69+12*Math.log(b/a.Frequency.A4)/Math.LN2},a.Frequency}),b(function(a){return a.TransportTime=function(b,c){return this instanceof a.TransportTime?void a.Time.call(this,b,c):new a.TransportTime(b,c)},a.extend(a.TransportTime,a.Time),a.TransportTime.prototype._unaryExpressions=Object.create(a.Time.prototype._unaryExpressions),a.TransportTime.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(b){var c=this._secondsToTicks(b()),d=Math.ceil(a.Transport.ticks/c);return this._ticksToUnits(d*c)}},a.TransportTime.prototype._secondsToTicks=function(b){var c=this._beatsToUnits(1),d=b/c;return Math.round(d*a.Transport.PPQ)},a.TransportTime.prototype.valueOf=function(){var b=this._secondsToTicks(this._expr());return b+(this._plusNow?a.Transport.ticks:0)},a.TransportTime.prototype.toTicks=function(){return this.valueOf()},a.TransportTime.prototype.toSeconds=function(){var b=this._expr();return b+(this._plusNow?a.Transport.seconds:0)},a.TransportTime.prototype.toFrequency=function(){return 1/this.toSeconds()},a.TransportTime}),b(function(a){return a.Emitter=function(){this._events={}},a.extend(a.Emitter),a.Emitter.prototype.on=function(a,b){for(var c=a.split(/\W+/),d=0;d<c.length;d++){var e=c[d];this._events.hasOwnProperty(e)||(this._events[e]=[]),this._events[e].push(b)}return this},a.Emitter.prototype.off=function(b,c){for(var d=b.split(/\W+/),e=0;e<d.length;e++)if(b=d[e],this._events.hasOwnProperty(b))if(a.prototype.isUndef(c))this._events[b]=[];else for(var f=this._events[b],g=0;g<f.length;g++)f[g]===c&&f.splice(g,1);return this},a.Emitter.prototype.emit=function(a){if(this._events){var b=Array.apply(null,arguments).slice(1);if(this._events.hasOwnProperty(a))for(var c=this._events[a],d=0,e=c.length;e>d;d++)c[d].apply(this,b)}return this},a.Emitter.mixin=function(b){var c=["on","off","emit"];b._events={};for(var d=0;d<c.length;d++){var e=c[d],f=a.Emitter.prototype[e];b[e]=f}},a.Emitter.prototype.dispose=function(){return a.prototype.dispose.call(this),this._events=null,this},a.Emitter}),b(function(a){function b(){function b(b,c,e){if(b.input)Array.isArray(b.input)?(a.prototype.isUndef(e)&&(e=0),this.connect(b.input[e])):this.connect(b.input,c,e);else try{b instanceof AudioNode?d.call(this,b,c,e):d.call(this,b,c)}catch(f){throw new Error("error connecting to node: "+b+"\n"+f)}}function c(b,c,d){if(b&&b.input&&Array.isArray(b.input))a.prototype.isUndef(d)&&(d=0),this.disconnect(b.input[d],c,d);else if(b&&b.input)this.disconnect(b.input,c,d);else try{e.apply(this,arguments)}catch(f){throw new Error("error disconnecting node: "+b+"\n"+f)}}var d=AudioNode.prototype.connect,e=AudioNode.prototype.disconnect;AudioNode.prototype.connect!==b&&(AudioNode.prototype.connect=b,AudioNode.prototype.disconnect=c)}return!window.hasOwnProperty("AudioContext")&&window.hasOwnProperty("webkitAudioContext")&&(window.AudioContext=window.webkitAudioContext),a.Context=function(b){a.Emitter.call(this),b||(b=new window.AudioContext),this._context=b;for(var c in this._context)this._defineProperty(this._context,c);this._latencyHint="interactive",this._lookAhead=.1,this._updateInterval=this._lookAhead/3,this._computedUpdateInterval=0,this._worker=this._createWorker(),this._constants={}},a.extend(a.Context,a.Emitter),a.Emitter.mixin(a.Context),a.Context.prototype._defineProperty=function(a,b){this.isUndef(this[b])&&Object.defineProperty(this,b,{get:function(){return"function"==typeof a[b]?a[b].bind(a):a[b]},set:function(c){a[b]=c}})},a.Context.prototype.now=function(){return this._context.currentTime},a.Context.prototype._createWorker=function(){window.URL=window.URL||window.webkitURL;var a=new Blob(["var timeoutTime = "+(1e3*this._updateInterval).toFixed(1)+";self.onmessage = function(msg){	timeoutTime = parseInt(msg.data);};function tick(){	setTimeout(tick, timeoutTime);	self.postMessage('tick');}tick();"]),b=URL.createObjectURL(a),c=new Worker(b);return c.addEventListener("message",function(){this.emit("tick")}.bind(this)),c.addEventListener("message",function(){var a=this.now();if(this.isNumber(this._lastUpdate)){var b=a-this._lastUpdate;this._computedUpdateInterval=Math.max(b,.97*this._computedUpdateInterval)}this._lastUpdate=a}.bind(this)),c},a.Context.prototype.getConstant=function(a){if(this._constants[a])return this._constants[a];for(var b=this._context.createBuffer(1,128,this._context.sampleRate),c=b.getChannelData(0),d=0;d<c.length;d++)c[d]=a;var e=this._context.createBufferSource();return e.channelCount=1,e.channelCountMode="explicit",e.buffer=b,e.loop=!0,e.start(0),this._constants[a]=e,e},Object.defineProperty(a.Context.prototype,"lag",{get:function(){var a=this._computedUpdateInterval-this._updateInterval;return a=Math.max(a,0)}}),Object.defineProperty(a.Context.prototype,"lookAhead",{get:function(){return this._lookAhead},set:function(a){this._lookAhead=a}}),Object.defineProperty(a.Context.prototype,"updateInterval",{get:function(){return this._updateInterval},set:function(b){this._updateInterval=Math.max(b,a.prototype.blockTime),this._worker.postMessage(Math.max(1e3*b,1))}}),Object.defineProperty(a.Context.prototype,"latencyHint",{get:function(){return this._latencyHint},set:function(a){var b=a;if(this._latencyHint=a,this.isString(a))switch(a){case"interactive":b=.1,this._context.latencyHint=a;break;case"playback":b=.8,this._context.latencyHint=a;break;case"balanced":b=.25,this._context.latencyHint=a;break;case"fastest":b=.01}this.lookAhead=b,this.updateInterval=b/3}}),a.supported?(b(),a.context=new a.Context):console.warn("This browser does not support Tone.js"),a.Context}),b(function(a){return a.Type={Default:"number",Time:"time",Frequency:"frequency",TransportTime:"transportTime",Ticks:"ticks",NormalRange:"normalRange",AudioRange:"audioRange",Decibels:"db",Interval:"interval",BPM:"bpm",Positive:"positive",Cents:"cents",Degrees:"degrees",MIDI:"midi",BarsBeatsSixteenths:"barsBeatsSixteenths",Samples:"samples",Hertz:"hertz",Note:"note",Milliseconds:"milliseconds",Seconds:"seconds",Notation:"notation"},a.prototype.toSeconds=function(b){return this.isNumber(b)?b:this.isUndef(b)?this.now():this.isString(b)?new a.Time(b).toSeconds():b instanceof a.TimeBase?b.toSeconds():void 0},a.prototype.toFrequency=function(b){return this.isNumber(b)?b:this.isString(b)||this.isUndef(b)?new a.Frequency(b).valueOf():b instanceof a.TimeBase?b.toFrequency():void 0},a.prototype.toTicks=function(b){return this.isNumber(b)||this.isString(b)?new a.TransportTime(b).toTicks():this.isUndef(b)?a.Transport.ticks:b instanceof a.TimeBase?b.toTicks():void 0},a}),b(function(a){return a.Param=function(){var b=this.optionsObject(arguments,["param","units","convert"],a.Param.defaults);this._param=this.input=b.param,this.units=b.units,this.convert=b.convert,this.overridden=!1,this._lfo=null,this.isObject(b.lfo)?this.value=b.lfo:this.isUndef(b.value)||(this.value=b.value)},a.extend(a.Param),a.Param.defaults={units:a.Type.Default,convert:!0,param:void 0},Object.defineProperty(a.Param.prototype,"value",{get:function(){return this._toUnits(this._param.value)},set:function(b){if(this.isObject(b)){if(this.isUndef(a.LFO))throw new Error("Include 'Tone.LFO' to use an LFO as a Param value.");this._lfo&&this._lfo.dispose(),this._lfo=new a.LFO(b).start(),this._lfo.connect(this.input)}else{var c=this._fromUnits(b);this._param.cancelScheduledValues(0),this._param.value=c}}}),a.Param.prototype._fromUnits=function(b){if(!this.convert&&!this.isUndef(this.convert))return b;switch(this.units){case a.Type.Time:return this.toSeconds(b);case a.Type.Frequency:return this.toFrequency(b);case a.Type.Decibels:return this.dbToGain(b);case a.Type.NormalRange:return Math.min(Math.max(b,0),1);case a.Type.AudioRange:return Math.min(Math.max(b,-1),1);case a.Type.Positive:return Math.max(b,0);default:return b}},a.Param.prototype._toUnits=function(b){if(!this.convert&&!this.isUndef(this.convert))return b;switch(this.units){case a.Type.Decibels:return this.gainToDb(b);default:return b}},a.Param.prototype._minOutput=1e-5,a.Param.prototype.setValueAtTime=function(a,b){return a=this._fromUnits(a),b=this.toSeconds(b),b<=this.now()+this.blockTime?this._param.value=a:this._param.setValueAtTime(a,b),this},a.Param.prototype.setRampPoint=function(a){a=this.defaultArg(a,this.now());var b=this._param.value;return 0===b&&(b=this._minOutput),this._param.setValueAtTime(b,a),this},a.Param.prototype.linearRampToValueAtTime=function(a,b){return a=this._fromUnits(a),this._param.linearRampToValueAtTime(a,this.toSeconds(b)),this},a.Param.prototype.exponentialRampToValueAtTime=function(a,b){return a=this._fromUnits(a),a=Math.max(this._minOutput,a),this._param.exponentialRampToValueAtTime(a,this.toSeconds(b)),this},a.Param.prototype.exponentialRampToValue=function(a,b,c){return c=this.toSeconds(c),this.setRampPoint(c),this.exponentialRampToValueAtTime(a,c+this.toSeconds(b)),this},a.Param.prototype.linearRampToValue=function(a,b,c){return c=this.toSeconds(c),this.setRampPoint(c),this.linearRampToValueAtTime(a,c+this.toSeconds(b)),this},a.Param.prototype.setTargetAtTime=function(a,b,c){return a=this._fromUnits(a),a=Math.max(this._minOutput,a),c=Math.max(this._minOutput,c),this._param.setTargetAtTime(a,this.toSeconds(b),c),this},a.Param.prototype.setValueCurveAtTime=function(a,b,c){for(var d=0;d<a.length;d++)a[d]=this._fromUnits(a[d]);return this._param.setValueCurveAtTime(a,this.toSeconds(b),this.toSeconds(c)),this},a.Param.prototype.cancelScheduledValues=function(a){return this._param.cancelScheduledValues(this.toSeconds(a)),this},a.Param.prototype.rampTo=function(b,c,d){return c=this.defaultArg(c,0),this.units===a.Type.Frequency||this.units===a.Type.BPM||this.units===a.Type.Decibels?this.exponentialRampToValue(b,c,d):this.linearRampToValue(b,c,d),this},Object.defineProperty(a.Param.prototype,"lfo",{get:function(){return this._lfo;
}}),a.Param.prototype.dispose=function(){return a.prototype.dispose.call(this),this._param=null,this._lfo&&(this._lfo.dispose(),this._lfo=null),this},a.Param}),b(function(a){return window.GainNode&&!AudioContext.prototype.createGain&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),a.Gain=function(){var b=this.optionsObject(arguments,["gain","units"],a.Gain.defaults);this.input=this.output=this._gainNode=this.context.createGain(),this.gain=new a.Param({param:this._gainNode.gain,units:b.units,value:b.gain,convert:b.convert}),this._readOnly("gain")},a.extend(a.Gain),a.Gain.defaults={gain:1,convert:!0},a.Gain.prototype.dispose=function(){a.Param.prototype.dispose.call(this),this._gainNode.disconnect(),this._gainNode=null,this._writable("gain"),this.gain.dispose(),this.gain=null},a.prototype.createInsOuts=function(b,c){1===b?this.input=new a.Gain:b>1&&(this.input=new Array(b)),1===c?this.output=new a.Gain:c>1&&(this.output=new Array(b))},a.Gain}),b(function(a){return a.Signal=function(){var b=this.optionsObject(arguments,["value","units"],a.Signal.defaults);this.output=this._gain=this.context.createGain(),b.param=this._gain.gain,a.Param.call(this,b),this.input=this._param=this._gain.gain,this.context.getConstant(1).chain(this._gain)},a.extend(a.Signal,a.Param),a.Signal.defaults={value:0,units:a.Type.Default,convert:!0},a.Signal.prototype.connect=a.SignalBase.prototype.connect,a.Signal.prototype.dispose=function(){return a.Param.prototype.dispose.call(this),this._param=null,this._gain.disconnect(),this._gain=null,this},a.Signal}),b(function(a){return a.Timeline=function(){var b=this.optionsObject(arguments,["memory"],a.Timeline.defaults);this._timeline=[],this._toRemove=[],this._iterating=!1,this.memory=b.memory},a.extend(a.Timeline),a.Timeline.defaults={memory:1/0},Object.defineProperty(a.Timeline.prototype,"length",{get:function(){return this._timeline.length}}),a.Timeline.prototype.add=function(a){if(this.isUndef(a.time))throw new Error("Tone.Timeline: events must have a time attribute");if(this._timeline.length){var b=this._search(a.time);this._timeline.splice(b+1,0,a)}else this._timeline.push(a);if(this.length>this.memory){var c=this.length-this.memory;this._timeline.splice(0,c)}return this},a.Timeline.prototype.remove=function(a){if(this._iterating)this._toRemove.push(a);else{var b=this._timeline.indexOf(a);-1!==b&&this._timeline.splice(b,1)}return this},a.Timeline.prototype.get=function(a){var b=this._search(a);return-1!==b?this._timeline[b]:null},a.Timeline.prototype.peek=function(){return this._timeline[0]},a.Timeline.prototype.shift=function(){return this._timeline.shift()},a.Timeline.prototype.getAfter=function(a){var b=this._search(a);return b+1<this._timeline.length?this._timeline[b+1]:null},a.Timeline.prototype.getBefore=function(a){var b=this._timeline.length;if(b>0&&this._timeline[b-1].time<a)return this._timeline[b-1];var c=this._search(a);return c-1>=0?this._timeline[c-1]:null},a.Timeline.prototype.cancel=function(a){if(this._timeline.length>1){var b=this._search(a);if(b>=0)if(this._timeline[b].time===a){for(var c=b;c>=0&&this._timeline[c].time===a;c--)b=c;this._timeline=this._timeline.slice(0,b)}else this._timeline=this._timeline.slice(0,b+1);else this._timeline=[]}else 1===this._timeline.length&&this._timeline[0].time>=a&&(this._timeline=[]);return this},a.Timeline.prototype.cancelBefore=function(a){if(this._timeline.length){var b=this._search(a);b>=0&&(this._timeline=this._timeline.slice(b+1))}return this},a.Timeline.prototype._search=function(a){var b=0,c=this._timeline.length,d=c;if(c>0&&this._timeline[c-1].time<=a)return c-1;for(;d>b;){var e=Math.floor(b+(d-b)/2),f=this._timeline[e],g=this._timeline[e+1];if(f.time===a){for(var h=e;h<this._timeline.length;h++){var i=this._timeline[h];i.time===a&&(e=h)}return e}if(f.time<a&&g.time>a)return e;f.time>a?d=e:f.time<a&&(b=e+1)}return-1},a.Timeline.prototype._iterate=function(a,b,c){this._iterating=!0,b=this.defaultArg(b,0),c=this.defaultArg(c,this._timeline.length-1);for(var d=b;c>=d;d++)a(this._timeline[d]);if(this._iterating=!1,this._toRemove.length>0){for(var e=0;e<this._toRemove.length;e++){var f=this._timeline.indexOf(this._toRemove[e]);-1!==f&&this._timeline.splice(f,1)}this._toRemove=[]}},a.Timeline.prototype.forEach=function(a){return this._iterate(a),this},a.Timeline.prototype.forEachBefore=function(a,b){var c=this._search(a);return-1!==c&&this._iterate(b,0,c),this},a.Timeline.prototype.forEachAfter=function(a,b){var c=this._search(a);return this._iterate(b,c+1),this},a.Timeline.prototype.forEachFrom=function(a,b){for(var c=this._search(a);c>=0&&this._timeline[c].time>=a;)c--;return this._iterate(b,c+1),this},a.Timeline.prototype.forEachAtTime=function(a,b){var c=this._search(a);return-1!==c&&this._iterate(function(c){c.time===a&&b(c)},0,c),this},a.Timeline.prototype.dispose=function(){a.prototype.dispose.call(this),this._timeline=null,this._toRemove=null},a.Timeline}),b(function(a){return a.TimelineSignal=function(){var b=this.optionsObject(arguments,["value","units"],a.Signal.defaults);this._events=new a.Timeline(10),a.Signal.apply(this,b),b.param=this._param,a.Param.call(this,b),this._initial=this._fromUnits(this._param.value)},a.extend(a.TimelineSignal,a.Param),a.TimelineSignal.Type={Linear:"linear",Exponential:"exponential",Target:"target",Curve:"curve",Set:"set"},Object.defineProperty(a.TimelineSignal.prototype,"value",{get:function(){var a=this.now(),b=this.getValueAtTime(a);return this._toUnits(b)},set:function(a){var b=this._fromUnits(a);this._initial=b,this.cancelScheduledValues(),this._param.value=b}}),a.TimelineSignal.prototype.setValueAtTime=function(b,c){return b=this._fromUnits(b),c=this.toSeconds(c),this._events.add({type:a.TimelineSignal.Type.Set,value:b,time:c}),this._param.setValueAtTime(b,c),this},a.TimelineSignal.prototype.linearRampToValueAtTime=function(b,c){return b=this._fromUnits(b),c=this.toSeconds(c),this._events.add({type:a.TimelineSignal.Type.Linear,value:b,time:c}),this._param.linearRampToValueAtTime(b,c),this},a.TimelineSignal.prototype.exponentialRampToValueAtTime=function(b,c){c=this.toSeconds(c);var d=this._searchBefore(c);d&&0===d.value&&this.setValueAtTime(this._minOutput,d.time),b=this._fromUnits(b);var e=Math.max(b,this._minOutput);return this._events.add({type:a.TimelineSignal.Type.Exponential,value:e,time:c}),b<this._minOutput?(this._param.exponentialRampToValueAtTime(this._minOutput,c-this.sampleTime),this.setValueAtTime(0,c)):this._param.exponentialRampToValueAtTime(b,c),this},a.TimelineSignal.prototype.setTargetAtTime=function(b,c,d){return b=this._fromUnits(b),b=Math.max(this._minOutput,b),d=Math.max(this._minOutput,d),c=this.toSeconds(c),this._events.add({type:a.TimelineSignal.Type.Target,value:b,time:c,constant:d}),this._param.setTargetAtTime(b,c,d),this},a.TimelineSignal.prototype.setValueCurveAtTime=function(b,c,d,e){e=this.defaultArg(e,1);for(var f=new Array(b.length),g=0;g<f.length;g++)f[g]=this._fromUnits(b[g])*e;c=this.toSeconds(c),d=this.toSeconds(d),this._events.add({type:a.TimelineSignal.Type.Curve,value:f,time:c,duration:d}),this._param.setValueAtTime(f[0],c);for(var h=1;h<f.length;h++){var i=c+h/(f.length-1)*d;this._param.linearRampToValueAtTime(f[h],i)}return this},a.TimelineSignal.prototype.cancelScheduledValues=function(a){return a=this.toSeconds(a),this._events.cancel(a),this._param.cancelScheduledValues(a),this},a.TimelineSignal.prototype.setRampPoint=function(b){b=this.toSeconds(b);var c=this._toUnits(this.getValueAtTime(b)),d=this._searchBefore(b);if(d&&d.time===b)this.cancelScheduledValues(b+this.sampleTime);else if(d&&d.type===a.TimelineSignal.Type.Curve&&d.time+d.duration>b)this.cancelScheduledValues(b),this.linearRampToValueAtTime(c,b);else{var e=this._searchAfter(b);e&&(this.cancelScheduledValues(b),e.type===a.TimelineSignal.Type.Linear?this.linearRampToValueAtTime(c,b):e.type===a.TimelineSignal.Type.Exponential&&this.exponentialRampToValueAtTime(c,b)),this.setValueAtTime(c,b)}return this},a.TimelineSignal.prototype.linearRampToValueBetween=function(a,b,c){return this.setRampPoint(b),this.linearRampToValueAtTime(a,c),this},a.TimelineSignal.prototype.exponentialRampToValueBetween=function(a,b,c){return this.setRampPoint(b),this.exponentialRampToValueAtTime(a,c),this},a.TimelineSignal.prototype._searchBefore=function(a){return this._events.get(a)},a.TimelineSignal.prototype._searchAfter=function(a){return this._events.getAfter(a)},a.TimelineSignal.prototype.getValueAtTime=function(b){b=this.toSeconds(b);var c=this._searchAfter(b),d=this._searchBefore(b),e=this._initial;if(null===d)e=this._initial;else if(d.type===a.TimelineSignal.Type.Target){var f,g=this._events.getBefore(d.time);f=null===g?this._initial:g.value,e=this._exponentialApproach(d.time,f,d.value,d.constant,b)}else e=d.type===a.TimelineSignal.Type.Curve?this._curveInterpolate(d.time,d.value,d.duration,b):null===c?d.value:c.type===a.TimelineSignal.Type.Linear?this._linearInterpolate(d.time,d.value,c.time,c.value,b):c.type===a.TimelineSignal.Type.Exponential?this._exponentialInterpolate(d.time,d.value,c.time,c.value,b):d.value;return e},a.TimelineSignal.prototype.connect=a.SignalBase.prototype.connect,a.TimelineSignal.prototype._exponentialApproach=function(a,b,c,d,e){return c+(b-c)*Math.exp(-(e-a)/d)},a.TimelineSignal.prototype._linearInterpolate=function(a,b,c,d,e){return b+(d-b)*((e-a)/(c-a))},a.TimelineSignal.prototype._exponentialInterpolate=function(a,b,c,d,e){return b=Math.max(this._minOutput,b),b*Math.pow(d/b,(e-a)/(c-a))},a.TimelineSignal.prototype._curveInterpolate=function(a,b,c,d){var e=b.length;if(d>=a+c)return b[e-1];if(a>=d)return b[0];var f=(d-a)/c,g=Math.floor((e-1)*f),h=Math.ceil((e-1)*f),i=b[g],j=b[h];return h===g?i:this._linearInterpolate(g,i,h,j,f*(e-1))},a.TimelineSignal.prototype.dispose=function(){a.Signal.prototype.dispose.call(this),a.Param.prototype.dispose.call(this),this._events.dispose(),this._events=null},a.TimelineSignal}),b(function(a){return a.Pow=function(b){this._exp=this.defaultArg(b,1),this._expScaler=this.input=this.output=new a.WaveShaper(this._expFunc(this._exp),8192)},a.extend(a.Pow,a.SignalBase),Object.defineProperty(a.Pow.prototype,"value",{get:function(){return this._exp},set:function(a){this._exp=a,this._expScaler.setMap(this._expFunc(this._exp))}}),a.Pow.prototype._expFunc=function(a){return function(b){return Math.pow(Math.abs(b),a)}},a.Pow.prototype.dispose=function(){return a.prototype.dispose.call(this),this._expScaler.dispose(),this._expScaler=null,this},a.Pow}),b(function(a){return a.Envelope=function(){var b=this.optionsObject(arguments,["attack","decay","sustain","release"],a.Envelope.defaults);this.attack=b.attack,this.decay=b.decay,this.sustain=b.sustain,this.release=b.release,this._attackCurve="linear",this._releaseCurve="exponential",this._sig=this.output=new a.TimelineSignal,this._sig.setValueAtTime(0,0),this.attackCurve=b.attackCurve,this.releaseCurve=b.releaseCurve},a.extend(a.Envelope),a.Envelope.defaults={attack:.01,decay:.1,sustain:.5,release:1,attackCurve:"linear",releaseCurve:"exponential"},Object.defineProperty(a.Envelope.prototype,"value",{get:function(){return this.getValueAtTime(this.now())}}),Object.defineProperty(a.Envelope.prototype,"attackCurve",{get:function(){if(this.isString(this._attackCurve))return this._attackCurve;if(this.isArray(this._attackCurve)){for(var b in a.Envelope.Type)if(a.Envelope.Type[b].In===this._attackCurve)return b;return this._attackCurve}},set:function(b){if(a.Envelope.Type.hasOwnProperty(b)){var c=a.Envelope.Type[b];this.isObject(c)?this._attackCurve=c.In:this._attackCurve=c}else{if(!this.isArray(b))throw new Error("Tone.Envelope: invalid curve: "+b);this._attackCurve=b}}}),Object.defineProperty(a.Envelope.prototype,"releaseCurve",{get:function(){if(this.isString(this._releaseCurve))return this._releaseCurve;if(this.isArray(this._releaseCurve)){for(var b in a.Envelope.Type)if(a.Envelope.Type[b].Out===this._releaseCurve)return b;return this._releaseCurve}},set:function(b){if(a.Envelope.Type.hasOwnProperty(b)){var c=a.Envelope.Type[b];this.isObject(c)?this._releaseCurve=c.Out:this._releaseCurve=c}else{if(!this.isArray(b))throw new Error("Tone.Envelope: invalid curve: "+b);this._releaseCurve=b}}}),a.Envelope.prototype.triggerAttack=function(a,b){a=this.toSeconds(a);var c=this.toSeconds(this.attack),d=c,e=this.toSeconds(this.decay);b=this.defaultArg(b,1);var f=this.getValueAtTime(a);if(f>0){var g=1/d,h=1-f;d=h/g}if("linear"===this._attackCurve)this._sig.linearRampToValue(b,d,a);else if("exponential"===this._attackCurve)this._sig.exponentialRampToValue(b,d,a);else if(d>0){this._sig.setRampPoint(a);var i=this._attackCurve;if(c>d){var j=1-d/c,k=Math.floor(j*this._attackCurve.length);i=this._attackCurve.slice(k),i[0]=f}this._sig.setValueCurveAtTime(i,a,d,b)}return this._sig.exponentialRampToValue(b*this.sustain,e,d+a),this},a.Envelope.prototype.triggerRelease=function(a){a=this.toSeconds(a);var b=this.getValueAtTime(a);if(b>0){var c=this.toSeconds(this.release);if("linear"===this._releaseCurve)this._sig.linearRampToValue(0,c,a);else if("exponential"===this._releaseCurve)this._sig.exponentialRampToValue(0,c,a);else{var d=this._releaseCurve;this.isArray(d)&&(this._sig.setRampPoint(a),this._sig.setValueCurveAtTime(d,a,c,b))}}return this},a.Envelope.prototype.getValueAtTime=function(a){return this._sig.getValueAtTime(a)},a.Envelope.prototype.triggerAttackRelease=function(a,b,c){return b=this.toSeconds(b),this.triggerAttack(b,c),this.triggerRelease(b+this.toSeconds(a)),this},a.Envelope.prototype.cancel=function(a){return this._sig.cancelScheduledValues(a),this},a.Envelope.prototype.connect=a.Signal.prototype.connect,function(){function b(a){for(var b=new Array(a.length),c=0;c<a.length;c++)b[c]=1-a[c];return b}function c(a){return a.slice(0).reverse()}var d,e,f=128,g=[];for(d=0;f>d;d++)g[d]=Math.sin(d/(f-1)*(Math.PI/2));var h=[],i=6.4;for(d=0;f-1>d;d++){e=d/(f-1);var j=Math.sin(e*(2*Math.PI)*i-Math.PI/2)+1;h[d]=j/10+.83*e}h[f-1]=1;var k=[],l=5;for(d=0;f>d;d++)k[d]=Math.ceil(d/(f-1)*l)/l;var m=[];for(d=0;f>d;d++)e=d/(f-1),m[d]=.5*(1-Math.cos(Math.PI*e));var n=[];for(d=0;f>d;d++){e=d/(f-1);var o=4*Math.pow(e,3)+.2,p=Math.cos(o*Math.PI*2*e);n[d]=Math.abs(p*(1-e))}a.Envelope.Type={linear:"linear",exponential:"exponential",bounce:{In:b(n),Out:n},cosine:{In:g,Out:c(g)},step:{In:k,Out:b(k)},ripple:{In:h,Out:b(h)},sine:{In:m,Out:b(m)}}}(),a.Envelope.prototype.dispose=function(){return a.prototype.dispose.call(this),this._sig.dispose(),this._sig=null,this._attackCurve=null,this._releaseCurve=null,this},a.Envelope}),b(function(a){return a.AmplitudeEnvelope=function(){a.Envelope.apply(this,arguments),this.input=this.output=new a.Gain,this._sig.connect(this.output.gain)},a.extend(a.AmplitudeEnvelope,a.Envelope),a.AmplitudeEnvelope.prototype.dispose=function(){return this.input.dispose(),this.input=null,a.Envelope.prototype.dispose.call(this),this},a.AmplitudeEnvelope}),b(function(a){return window.AnalyserNode&&!AnalyserNode.prototype.getFloatTimeDomainData&&(AnalyserNode.prototype.getFloatTimeDomainData=function(a){var b=new Uint8Array(a.length);this.getByteTimeDomainData(b);for(var c=0;c<b.length;c++)a[c]=(b[c]-128)/128}),a.Analyser=function(){var b=this.optionsObject(arguments,["type","size"],a.Analyser.defaults);this._analyser=this.input=this.output=this.context.createAnalyser(),this._type=b.type,this._returnType=b.returnType,this._buffer=null,this.size=b.size,this.type=b.type,this.returnType=b.returnType,this.minDecibels=b.minDecibels,this.maxDecibels=b.maxDecibels},a.extend(a.Analyser),a.Analyser.defaults={size:1024,returnType:"byte",type:"fft",smoothing:.8,maxDecibels:-30,minDecibels:-100},a.Analyser.Type={Waveform:"waveform",FFT:"fft"},a.Analyser.ReturnType={Byte:"byte",Float:"float"},a.Analyser.prototype.analyse=function(){return this._type===a.Analyser.Type.FFT?this._returnType===a.Analyser.ReturnType.Byte?this._analyser.getByteFrequencyData(this._buffer):this._analyser.getFloatFrequencyData(this._buffer):this._type===a.Analyser.Type.Waveform&&(this._returnType===a.Analyser.ReturnType.Byte?this._analyser.getByteTimeDomainData(this._buffer):this._analyser.getFloatTimeDomainData(this._buffer)),this._buffer},Object.defineProperty(a.Analyser.prototype,"size",{get:function(){return this._analyser.frequencyBinCount},set:function(a){this._analyser.fftSize=2*a,this.type=this._type}}),Object.defineProperty(a.Analyser.prototype,"returnType",{get:function(){return this._returnType},set:function(b){if(b===a.Analyser.ReturnType.Byte)this._buffer=new Uint8Array(this._analyser.frequencyBinCount);else{if(b!==a.Analyser.ReturnType.Float)throw new TypeError("Tone.Analayser: invalid return type: "+b);this._buffer=new Float32Array(this._analyser.frequencyBinCount)}this._returnType=b}}),Object.defineProperty(a.Analyser.prototype,"type",{get:function(){return this._type},set:function(b){if(b!==a.Analyser.Type.Waveform&&b!==a.Analyser.Type.FFT)throw new TypeError("Tone.Analyser: invalid type: "+b);this._type=b}}),Object.defineProperty(a.Analyser.prototype,"smoothing",{get:function(){return this._analyser.smoothingTimeConstant},set:function(a){this._analyser.smoothingTimeConstant=a}}),Object.defineProperty(a.Analyser.prototype,"minDecibels",{get:function(){return this._analyser.minDecibels},set:function(a){this._analyser.minDecibels=a}}),Object.defineProperty(a.Analyser.prototype,"maxDecibels",{get:function(){return this._analyser.maxDecibels},set:function(a){this._analyser.maxDecibels=a}}),a.Analyser.prototype.dispose=function(){a.prototype.dispose.call(this),this._analyser.disconnect(),this._analyser=null,this._buffer=null},a.Analyser}),b(function(a){return a.Compressor=function(){var b=this.optionsObject(arguments,["threshold","ratio"],a.Compressor.defaults);this._compressor=this.input=this.output=this.context.createDynamicsCompressor(),this.threshold=new a.Param({param:this._compressor.threshold,units:a.Type.Decibels,convert:!1}),this.attack=new a.Param(this._compressor.attack,a.Type.Time),this.release=new a.Param(this._compressor.release,a.Type.Time),this.knee=new a.Param({param:this._compressor.knee,units:a.Type.Decibels,convert:!1}),this.ratio=new a.Param({param:this._compressor.ratio,convert:!1}),this._readOnly(["knee","release","attack","ratio","threshold"]),this.set(b)},a.extend(a.Compressor),a.Compressor.defaults={ratio:12,threshold:-24,release:.25,attack:.003,knee:30},a.Compressor.prototype.dispose=function(){return a.prototype.dispose.call(this),this._writable(["knee","release","attack","ratio","threshold"]),this._compressor.disconnect(),this._compressor=null,this.attack.dispose(),this.attack=null,this.release.dispose(),this.release=null,this.threshold.dispose(),this.threshold=null,this.ratio.dispose(),this.ratio=null,this.knee.dispose(),this.knee=null,this},a.Compressor}),b(function(a){return a.Add=function(b){this.createInsOuts(2,0),this._sum=this.input[0]=this.input[1]=this.output=new a.Gain,this._param=this.input[1]=new a.Signal(b),this._param.connect(this._sum)},a.extend(a.Add,a.Signal),a.Add.prototype.dispose=function(){return a.prototype.dispose.call(this),this._sum.dispose(),this._sum=null,this._param.dispose(),this._param=null,this},a.Add}),b(function(a){return a.Multiply=function(b){this.createInsOuts(2,0),this._mult=this.input[0]=this.output=new a.Gain,this._param=this.input[1]=this.output.gain,this._param.value=this.defaultArg(b,0)},a.extend(a.Multiply,a.Signal),a.Multiply.prototype.dispose=function(){return a.prototype.dispose.call(this),this._mult.dispose(),this._mult=null,this._param=null,this},a.Multiply}),b(function(a){return a.Negate=function(){this._multiply=this.input=this.output=new a.Multiply(-1)},a.extend(a.Negate,a.SignalBase),a.Negate.prototype.dispose=function(){return a.prototype.dispose.call(this),this._multiply.dispose(),this._multiply=null,this},a.Negate}),b(function(a){return a.Subtract=function(b){this.createInsOuts(2,0),this._sum=this.input[0]=this.output=new a.Gain,this._neg=new a.Negate,this._param=this.input[1]=new a.Signal(b),this._param.chain(this._neg,this._sum)},a.extend(a.Subtract,a.Signal),a.Subtract.prototype.dispose=function(){return a.prototype.dispose.call(this),this._neg.dispose(),this._neg=null,this._sum.disconnect(),this._sum=null,this._param.dispose(),this._param=null,this},a.Subtract}),b(function(a){return a.GreaterThanZero=function(){this._thresh=this.output=new a.WaveShaper(function(a){return 0>=a?0:1},127),this._scale=this.input=new a.Multiply(1e4),this._scale.connect(this._thresh)},a.extend(a.GreaterThanZero,a.SignalBase),a.GreaterThanZero.prototype.dispose=function(){return a.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._thresh.dispose(),this._thresh=null,this},a.GreaterThanZero}),b(function(a){return a.GreaterThan=function(b){this.createInsOuts(2,0),this._param=this.input[0]=new a.Subtract(b),this.input[1]=this._param.input[1],this._gtz=this.output=new a.GreaterThanZero,this._param.connect(this._gtz)},a.extend(a.GreaterThan,a.Signal),a.GreaterThan.prototype.dispose=function(){return a.prototype.dispose.call(this),this._param.dispose(),this._param=null,this._gtz.dispose(),this._gtz=null,this},a.GreaterThan}),b(function(a){return a.Abs=function(){this._abs=this.input=this.output=new a.WaveShaper(function(a){return 0===a?0:Math.abs(a)},127)},a.extend(a.Abs,a.SignalBase),a.Abs.prototype.dispose=function(){return a.prototype.dispose.call(this),this._abs.dispose(),this._abs=null,this},a.Abs}),b(function(a){return a.Modulo=function(b){this.createInsOuts(1,0),this._shaper=new a.WaveShaper(Math.pow(2,16)),this._multiply=new a.Multiply,this._subtract=this.output=new a.Subtract,this._modSignal=new a.Signal(b),this.input.fan(this._shaper,this._subtract),this._modSignal.connect(this._multiply,0,0),this._shaper.connect(this._multiply,0,1),this._multiply.connect(this._subtract,0,1),this._setWaveShaper(b)},a.extend(a.Modulo,a.SignalBase),a.Modulo.prototype._setWaveShaper=function(a){this._shaper.setMap(function(b){var c=Math.floor((b+1e-4)/a);return c})},Object.defineProperty(a.Modulo.prototype,"value",{get:function(){return this._modSignal.value},set:function(a){this._modSignal.value=a,this._setWaveShaper(a)}}),a.Modulo.prototype.dispose=function(){return a.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this._multiply.dispose(),this._multiply=null,this._subtract.dispose(),this._subtract=null,this._modSignal.dispose(),this._modSignal=null,this},a.Modulo}),b(function(a){return a.AudioToGain=function(){this._norm=this.input=this.output=new a.WaveShaper(function(a){return(a+1)/2})},a.extend(a.AudioToGain,a.SignalBase),a.AudioToGain.prototype.dispose=function(){return a.prototype.dispose.call(this),this._norm.dispose(),this._norm=null,this},a.AudioToGain}),b(function(a){function b(a,b,c){var d=new a;return c._eval(b[0]).connect(d,0,0),c._eval(b[1]).connect(d,0,1),d}function c(a,b,c){var d=new a;return c._eval(b[0]).connect(d,0,0),d}function d(a){return a?parseFloat(a):void 0}function e(a){return a&&a.args?parseFloat(a.args):void 0}return a.Expr=function(){var a=this._replacements(Array.prototype.slice.call(arguments)),b=this._parseInputs(a);this._nodes=[],this.input=new Array(b);for(var c=0;b>c;c++)this.input[c]=this.context.createGain();var d,e=this._parseTree(a);try{d=this._eval(e)}catch(f){throw this._disposeNodes(),new Error("Tone.Expr: Could evaluate expression: "+a)}this.output=d},a.extend(a.Expr,a.SignalBase),a.Expr._Expressions={value:{signal:{regexp:/^\d+\.\d+|^\d+/,method:function(b){var c=new a.Signal(d(b));return c}},input:{regexp:/^\$\d/,method:function(a,b){return b.input[d(a.substr(1))]}}},glue:{"(":{regexp:/^\(/},")":{regexp:/^\)/},",":{regexp:/^,/}},func:{abs:{regexp:/^abs/,method:c.bind(this,a.Abs)},mod:{regexp:/^mod/,method:function(b,c){var d=e(b[1]),f=new a.Modulo(d);return c._eval(b[0]).connect(f),f}},pow:{regexp:/^pow/,method:function(b,c){var d=e(b[1]),f=new a.Pow(d);return c._eval(b[0]).connect(f),f}},a2g:{regexp:/^a2g/,method:function(b,c){var d=new a.AudioToGain;return c._eval(b[0]).connect(d),d}}},binary:{"+":{regexp:/^\+/,precedence:1,method:b.bind(this,a.Add)},"-":{regexp:/^\-/,precedence:1,method:function(d,e){return 1===d.length?c(a.Negate,d,e):b(a.Subtract,d,e)}},"*":{regexp:/^\*/,precedence:0,method:b.bind(this,a.Multiply)}},unary:{"-":{regexp:/^\-/,method:c.bind(this,a.Negate)},"!":{regexp:/^\!/,method:c.bind(this,a.NOT)}}},a.Expr.prototype._parseInputs=function(a){var b=a.match(/\$\d/g),c=0;if(null!==b)for(var d=0;d<b.length;d++){var e=parseInt(b[d].substr(1))+1;c=Math.max(c,e)}return c},a.Expr.prototype._replacements=function(a){for(var b=a.shift(),c=0;c<a.length;c++)b=b.replace(/\%/i,a[c]);return b},a.Expr.prototype._tokenize=function(b){function c(b){for(var c in a.Expr._Expressions){var d=a.Expr._Expressions[c];for(var e in d){var f=d[e],g=f.regexp,h=b.match(g);if(null!==h)return{type:c,value:h[0],method:f.method}}}throw new SyntaxError("Tone.Expr: Unexpected token "+b)}for(var d=-1,e=[];b.length>0;){b=b.trim();var f=c(b);e.push(f),b=b.substr(f.value.length)}return{next:function(){return e[++d]},peek:function(){return e[d+1]}}},a.Expr.prototype._parseTree=function(b){function c(a,b){return!k(a)&&"glue"===a.type&&a.value===b}function d(b,c,d){var e=!1,f=a.Expr._Expressions[c];if(!k(b))for(var g in f){var h=f[g];if(h.regexp.test(b.value)){if(k(d))return!0;if(h.precedence===d)return!0}}return e}function e(a){k(a)&&(a=5);var b;b=0>a?f():e(a-1);for(var c=j.peek();d(c,"binary",a);)c=j.next(),b={operator:c.value,method:c.method,args:[b,e(a-1)]},c=j.peek();return b}function f(){var a,b;return a=j.peek(),d(a,"unary")?(a=j.next(),b=f(),{operator:a.value,method:a.method,args:[b]}):g()}function g(){var a,b;if(a=j.peek(),k(a))throw new SyntaxError("Tone.Expr: Unexpected termination of expression");if("func"===a.type)return a=j.next(),h(a);if("value"===a.type)return a=j.next(),{method:a.method,args:a.value};if(c(a,"(")){if(j.next(),b=e(),a=j.next(),!c(a,")"))throw new SyntaxError("Expected )");return b}throw new SyntaxError("Tone.Expr: Parse error, cannot process token "+a.value)}function h(a){var b,d=[];if(b=j.next(),!c(b,"("))throw new SyntaxError('Tone.Expr: Expected ( in a function call "'+a.value+'"');if(b=j.peek(),c(b,")")||(d=i()),b=j.next(),!c(b,")"))throw new SyntaxError('Tone.Expr: Expected ) in a function call "'+a.value+'"');return{method:a.method,args:d,name:name}}function i(){for(var a,b,d=[];;){if(b=e(),k(b))break;if(d.push(b),a=j.peek(),!c(a,","))break;j.next()}return d}var j=this._tokenize(b),k=this.isUndef.bind(this);return e()},a.Expr.prototype._eval=function(a){if(!this.isUndef(a)){var b=a.method(a.args,this);return this._nodes.push(b),b}},a.Expr.prototype._disposeNodes=function(){for(var a=0;a<this._nodes.length;a++){var b=this._nodes[a];this.isFunction(b.dispose)?b.dispose():this.isFunction(b.disconnect)&&b.disconnect(),b=null,this._nodes[a]=null}this._nodes=null},a.Expr.prototype.dispose=function(){a.prototype.dispose.call(this),this._disposeNodes()},a.Expr}),b(function(a){return a.EqualPowerGain=function(){this._eqPower=this.input=this.output=new a.WaveShaper(function(a){return Math.abs(a)<.001?0:this.equalPowerScale(a)}.bind(this),4096)},a.extend(a.EqualPowerGain,a.SignalBase),a.EqualPowerGain.prototype.dispose=function(){return a.prototype.dispose.call(this),this._eqPower.dispose(),this._eqPower=null,this},a.EqualPowerGain}),b(function(a){return a.CrossFade=function(b){this.createInsOuts(2,1),this.a=this.input[0]=new a.Gain,this.b=this.input[1]=new a.Gain,this.fade=new a.Signal(this.defaultArg(b,.5),a.Type.NormalRange),this._equalPowerA=new a.EqualPowerGain,this._equalPowerB=new a.EqualPowerGain,this._invert=new a.Expr("1 - $0"),this.a.connect(this.output),this.b.connect(this.output),this.fade.chain(this._equalPowerB,this.b.gain),this.fade.chain(this._invert,this._equalPowerA,this.a.gain),this._readOnly("fade")},a.extend(a.CrossFade),a.CrossFade.prototype.dispose=function(){return a.prototype.dispose.call(this),this._writable("fade"),this._equalPowerA.dispose(),this._equalPowerA=null,this._equalPowerB.dispose(),this._equalPowerB=null,this.fade.dispose(),this.fade=null,this._invert.dispose(),this._invert=null,this.a.dispose(),this.a=null,this.b.dispose(),this.b=null,this},a.CrossFade}),b(function(a){return a.Filter=function(){this.createInsOuts(1,1);var b=this.optionsObject(arguments,["frequency","type","rolloff"],a.Filter.defaults);this._filters=[],this.frequency=new a.Signal(b.frequency,a.Type.Frequency),this.detune=new a.Signal(0,a.Type.Cents),this.gain=new a.Signal({value:b.gain,convert:!1}),this.Q=new a.Signal(b.Q),this._type=b.type,this._rolloff=b.rolloff,this.rolloff=b.rolloff,this._readOnly(["detune","frequency","gain","Q"])},a.extend(a.Filter),a.Filter.defaults={type:"lowpass",frequency:350,rolloff:-12,Q:1,gain:0},Object.defineProperty(a.Filter.prototype,"type",{get:function(){return this._type},set:function(a){var b=["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"];if(-1===b.indexOf(a))throw new TypeError("Tone.Filter: invalid type "+a);this._type=a;for(var c=0;c<this._filters.length;c++)this._filters[c].type=a}}),Object.defineProperty(a.Filter.prototype,"rolloff",{get:function(){return this._rolloff},set:function(a){a=parseInt(a,10);var b=[-12,-24,-48,-96],c=b.indexOf(a);if(-1===c)throw new RangeError("Tone.Filter: rolloff can only be -12, -24, -48 or -96");c+=1,this._rolloff=a,this.input.disconnect();for(var d=0;d<this._filters.length;d++)this._filters[d].disconnect(),this._filters[d]=null;this._filters=new Array(c);for(var e=0;c>e;e++){var f=this.context.createBiquadFilter();f.type=this._type,this.frequency.connect(f.frequency),this.detune.connect(f.detune),this.Q.connect(f.Q),this.gain.connect(f.gain),this._filters[e]=f}var g=[this.input].concat(this._filters).concat([this.output]);this.connectSeries.apply(this,g)}}),a.Filter.prototype.dispose=function(){a.prototype.dispose.call(this);for(var b=0;b<this._filters.length;b++)this._filters[b].disconnect(),this._filters[b]=null;return this._filters=null,this._writable(["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.frequency=null,this.Q=null,this.detune.dispose(),this.detune=null,this.gain.dispose(),this.gain=null,this},a.Filter}),b(function(a){return a.MultibandSplit=function(){var b=this.optionsObject(arguments,["lowFrequency","highFrequency"],a.MultibandSplit.defaults);this.input=new a.Gain,this.output=new Array(3),this.low=this.output[0]=new a.Filter(0,"lowpass"),this._lowMidFilter=new a.Filter(0,"highpass"),this.mid=this.output[1]=new a.Filter(0,"lowpass"),this.high=this.output[2]=new a.Filter(0,"highpass"),this.lowFrequency=new a.Signal(b.lowFrequency,a.Type.Frequency),this.highFrequency=new a.Signal(b.highFrequency,a.Type.Frequency),this.Q=new a.Signal(b.Q),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.connect(this.low.frequency),this.lowFrequency.connect(this._lowMidFilter.frequency),this.highFrequency.connect(this.mid.frequency),this.highFrequency.connect(this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),this._readOnly(["high","mid","low","highFrequency","lowFrequency"])},a.extend(a.MultibandSplit),a.MultibandSplit.defaults={lowFrequency:400,highFrequency:2500,Q:1},a.MultibandSplit.prototype.dispose=function(){return a.prototype.dispose.call(this),this._writable(["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this.low=null,this._lowMidFilter.dispose(),this._lowMidFilter=null,this.mid.dispose(),this.mid=null,this.high.dispose(),this.high=null,this.lowFrequency.dispose(),this.lowFrequency=null,this.highFrequency.dispose(),this.highFrequency=null,this.Q.dispose(),this.Q=null,this},a.MultibandSplit}),b(function(a){return a.EQ3=function(){var b=this.optionsObject(arguments,["low","mid","high"],a.EQ3.defaults);this.output=new a.Gain,this._multibandSplit=this.input=new a.MultibandSplit({
lowFrequency:b.lowFrequency,highFrequency:b.highFrequency}),this._lowGain=new a.Gain(b.low,a.Type.Decibels),this._midGain=new a.Gain(b.mid,a.Type.Decibels),this._highGain=new a.Gain(b.high,a.Type.Decibels),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),this._readOnly(["low","mid","high","lowFrequency","highFrequency"])},a.extend(a.EQ3),a.EQ3.defaults={low:0,mid:0,high:0,lowFrequency:400,highFrequency:2500},a.EQ3.prototype.dispose=function(){return a.prototype.dispose.call(this),this._writable(["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this._multibandSplit=null,this.lowFrequency=null,this.highFrequency=null,this._lowGain.dispose(),this._lowGain=null,this._midGain.dispose(),this._midGain=null,this._highGain.dispose(),this._highGain=null,this.low=null,this.mid=null,this.high=null,this.Q=null,this},a.EQ3}),b(function(a){return a.Scale=function(b,c){this._outputMin=this.defaultArg(b,0),this._outputMax=this.defaultArg(c,1),this._scale=this.input=new a.Multiply(1),this._add=this.output=new a.Add(0),this._scale.connect(this._add),this._setRange()},a.extend(a.Scale,a.SignalBase),Object.defineProperty(a.Scale.prototype,"min",{get:function(){return this._outputMin},set:function(a){this._outputMin=a,this._setRange()}}),Object.defineProperty(a.Scale.prototype,"max",{get:function(){return this._outputMax},set:function(a){this._outputMax=a,this._setRange()}}),a.Scale.prototype._setRange=function(){this._add.value=this._outputMin,this._scale.value=this._outputMax-this._outputMin},a.Scale.prototype.dispose=function(){return a.prototype.dispose.call(this),this._add.dispose(),this._add=null,this._scale.dispose(),this._scale=null,this},a.Scale}),b(function(a){return a.ScaleExp=function(b,c,d){this._scale=this.output=new a.Scale(b,c),this._exp=this.input=new a.Pow(this.defaultArg(d,2)),this._exp.connect(this._scale)},a.extend(a.ScaleExp,a.SignalBase),Object.defineProperty(a.ScaleExp.prototype,"exponent",{get:function(){return this._exp.value},set:function(a){this._exp.value=a}}),Object.defineProperty(a.ScaleExp.prototype,"min",{get:function(){return this._scale.min},set:function(a){this._scale.min=a}}),Object.defineProperty(a.ScaleExp.prototype,"max",{get:function(){return this._scale.max},set:function(a){this._scale.max=a}}),a.ScaleExp.prototype.dispose=function(){return a.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._exp.dispose(),this._exp=null,this},a.ScaleExp}),b(function(a){return window.DelayNode&&!AudioContext.prototype.createDelay&&(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),a.Delay=function(){var b=this.optionsObject(arguments,["delayTime","maxDelay"],a.Delay.defaults);this._delayNode=this.input=this.output=this.context.createDelay(this.toSeconds(b.maxDelay)),this.delayTime=new a.Param({param:this._delayNode.delayTime,units:a.Type.Time,value:b.delayTime}),this._readOnly("delayTime")},a.extend(a.Delay),a.Delay.defaults={maxDelay:1,delayTime:0},a.Delay.prototype.dispose=function(){return a.Param.prototype.dispose.call(this),this._delayNode.disconnect(),this._delayNode=null,this._writable("delayTime"),this.delayTime=null,this},a.Delay}),b(function(a){return a.FeedbackCombFilter=function(){var b=this.optionsObject(arguments,["delayTime","resonance"],a.FeedbackCombFilter.defaults);this._delay=this.input=this.output=new a.Delay(b.delayTime),this.delayTime=this._delay.delayTime,this._feedback=new a.Gain(b.resonance,a.Type.NormalRange),this.resonance=this._feedback.gain,this._delay.chain(this._feedback,this._delay),this._readOnly(["resonance","delayTime"])},a.extend(a.FeedbackCombFilter),a.FeedbackCombFilter.defaults={delayTime:.1,resonance:.5},a.FeedbackCombFilter.prototype.dispose=function(){return a.prototype.dispose.call(this),this._writable(["resonance","delayTime"]),this._delay.dispose(),this._delay=null,this.delayTime=null,this._feedback.dispose(),this._feedback=null,this.resonance=null,this},a.FeedbackCombFilter}),b(function(a){return a.Follower=function(){this.createInsOuts(1,1);var b=this.optionsObject(arguments,["attack","release"],a.Follower.defaults);this._abs=new a.Abs,this._filter=this.context.createBiquadFilter(),this._filter.type="lowpass",this._filter.frequency.value=0,this._filter.Q.value=-100,this._frequencyValues=new a.WaveShaper,this._sub=new a.Subtract,this._delay=new a.Delay(this.blockTime),this._mult=new a.Multiply(1e4),this._attack=b.attack,this._release=b.release,this.input.chain(this._abs,this._filter,this.output),this._abs.connect(this._sub,0,1),this._filter.chain(this._delay,this._sub),this._sub.chain(this._mult,this._frequencyValues,this._filter.frequency),this._setAttackRelease(this._attack,this._release)},a.extend(a.Follower),a.Follower.defaults={attack:.05,release:.5},a.Follower.prototype._setAttackRelease=function(b,c){var d=this.blockTime;b=a.Time(b).toFrequency(),c=a.Time(c).toFrequency(),b=Math.max(b,d),c=Math.max(c,d),this._frequencyValues.setMap(function(a){return 0>=a?b:c})},Object.defineProperty(a.Follower.prototype,"attack",{get:function(){return this._attack},set:function(a){this._attack=a,this._setAttackRelease(this._attack,this._release)}}),Object.defineProperty(a.Follower.prototype,"release",{get:function(){return this._release},set:function(a){this._release=a,this._setAttackRelease(this._attack,this._release)}}),a.Follower.prototype.connect=a.Signal.prototype.connect,a.Follower.prototype.dispose=function(){return a.prototype.dispose.call(this),this._filter.disconnect(),this._filter=null,this._frequencyValues.disconnect(),this._frequencyValues=null,this._delay.dispose(),this._delay=null,this._sub.disconnect(),this._sub=null,this._abs.dispose(),this._abs=null,this._mult.dispose(),this._mult=null,this._curve=null,this},a.Follower}),b(function(a){return a.ScaledEnvelope=function(){var b=this.optionsObject(arguments,["attack","decay","sustain","release"],a.Envelope.defaults);a.Envelope.call(this,b),b=this.defaultArg(b,a.ScaledEnvelope.defaults),this._exp=this.output=new a.Pow(b.exponent),this._scale=this.output=new a.Scale(b.min,b.max),this._sig.chain(this._exp,this._scale)},a.extend(a.ScaledEnvelope,a.Envelope),a.ScaledEnvelope.defaults={min:0,max:1,exponent:1},Object.defineProperty(a.ScaledEnvelope.prototype,"min",{get:function(){return this._scale.min},set:function(a){this._scale.min=a}}),Object.defineProperty(a.ScaledEnvelope.prototype,"max",{get:function(){return this._scale.max},set:function(a){this._scale.max=a}}),Object.defineProperty(a.ScaledEnvelope.prototype,"exponent",{get:function(){return this._exp.value},set:function(a){this._exp.value=a}}),a.ScaledEnvelope.prototype.dispose=function(){return a.Envelope.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._exp.dispose(),this._exp=null,this},a.ScaledEnvelope}),b(function(a){return a.FrequencyEnvelope=function(){var b=this.optionsObject(arguments,["attack","decay","sustain","release"],a.Envelope.defaults);a.ScaledEnvelope.call(this,b),b=this.defaultArg(b,a.FrequencyEnvelope.defaults),this._octaves=b.octaves,this.baseFrequency=b.baseFrequency,this.octaves=b.octaves},a.extend(a.FrequencyEnvelope,a.Envelope),a.FrequencyEnvelope.defaults={baseFrequency:200,octaves:4,exponent:2},Object.defineProperty(a.FrequencyEnvelope.prototype,"baseFrequency",{get:function(){return this._scale.min},set:function(a){this._scale.min=this.toFrequency(a),this.octaves=this._octaves}}),Object.defineProperty(a.FrequencyEnvelope.prototype,"octaves",{get:function(){return this._octaves},set:function(a){this._octaves=a,this._scale.max=this.baseFrequency*Math.pow(2,a)}}),Object.defineProperty(a.FrequencyEnvelope.prototype,"exponent",{get:function(){return this._exp.value},set:function(a){this._exp.value=a}}),a.FrequencyEnvelope.prototype.dispose=function(){return a.ScaledEnvelope.prototype.dispose.call(this),this},a.FrequencyEnvelope}),b(function(a){return a.Gate=function(){this.createInsOuts(1,1);var b=this.optionsObject(arguments,["threshold","attack","release"],a.Gate.defaults);this._follower=new a.Follower(b.attack,b.release),this._gt=new a.GreaterThan(this.dbToGain(b.threshold)),this.input.connect(this.output),this.input.chain(this._gt,this._follower,this.output.gain)},a.extend(a.Gate),a.Gate.defaults={attack:.1,release:.1,threshold:-40},Object.defineProperty(a.Gate.prototype,"threshold",{get:function(){return this.gainToDb(this._gt.value)},set:function(a){this._gt.value=this.dbToGain(a)}}),Object.defineProperty(a.Gate.prototype,"attack",{get:function(){return this._follower.attack},set:function(a){this._follower.attack=a}}),Object.defineProperty(a.Gate.prototype,"release",{get:function(){return this._follower.release},set:function(a){this._follower.release=a}}),a.Gate.prototype.dispose=function(){return a.prototype.dispose.call(this),this._follower.dispose(),this._gt.dispose(),this._follower=null,this._gt=null,this},a.Gate}),b(function(a){return a.TimelineState=function(b){a.Timeline.call(this),this._initial=b},a.extend(a.TimelineState,a.Timeline),a.TimelineState.prototype.getValueAtTime=function(a){var b=this.get(a);return null!==b?b.state:this._initial},a.TimelineState.prototype.setStateAtTime=function(a,b){this.add({state:a,time:b})},a.TimelineState}),b(function(a){return a.Clock=function(){a.Emitter.call(this);var b=this.optionsObject(arguments,["callback","frequency"],a.Clock.defaults);this.callback=b.callback,this._nextTick=0,this._lastState=a.State.Stopped,this.frequency=new a.TimelineSignal(b.frequency,a.Type.Frequency),this._readOnly("frequency"),this.ticks=0,this._state=new a.TimelineState(a.State.Stopped),this._boundLoop=this._loop.bind(this),this.context.on("tick",this._boundLoop)},a.extend(a.Clock,a.Emitter),a.Clock.defaults={callback:a.noOp,frequency:1,lookAhead:"auto"},Object.defineProperty(a.Clock.prototype,"state",{get:function(){return this._state.getValueAtTime(this.now())}}),a.Clock.prototype.start=function(b,c){return b=this.toSeconds(b),this._state.getValueAtTime(b)!==a.State.Started&&this._state.add({state:a.State.Started,time:b,offset:c}),this},a.Clock.prototype.stop=function(b){return b=this.toSeconds(b),this._state.cancel(b),this._state.setStateAtTime(a.State.Stopped,b),this},a.Clock.prototype.pause=function(b){return b=this.toSeconds(b),this._state.getValueAtTime(b)===a.State.Started&&this._state.setStateAtTime(a.State.Paused,b),this},a.Clock.prototype._loop=function(){for(var b=this.now(),c=this.context.lookAhead,d=this.context.updateInterval,e=2*this.context.lag,f=b+c+d+e;f>this._nextTick&&this._state;){var g=this._state.getValueAtTime(this._nextTick);if(g!==this._lastState){this._lastState=g;var h=this._state.get(this._nextTick);g===a.State.Started?(this._nextTick=h.time,this.isUndef(h.offset)||(this.ticks=h.offset),this.emit("start",h.time,this.ticks)):g===a.State.Stopped?(this.ticks=0,this.emit("stop",h.time)):g===a.State.Paused&&this.emit("pause",h.time)}var i=this._nextTick;this.frequency&&(this._nextTick+=1/this.frequency.getValueAtTime(this._nextTick),g===a.State.Started&&(this.callback(i),this.ticks++))}},a.Clock.prototype.getStateAtTime=function(a){return a=this.toSeconds(a),this._state.getValueAtTime(a)},a.Clock.prototype.dispose=function(){a.Emitter.prototype.dispose.call(this),this.context.off("tick",this._boundLoop),this._writable("frequency"),this.frequency.dispose(),this.frequency=null,this._boundLoop=null,this._nextTick=1/0,this.callback=null,this._state.dispose(),this._state=null},a.Clock}),b(function(a){a.IntervalTimeline=function(){this._root=null,this._length=0},a.extend(a.IntervalTimeline),a.IntervalTimeline.prototype.add=function(a){if(this.isUndef(a.time)||this.isUndef(a.duration))throw new Error("Tone.IntervalTimeline: events must have time and duration parameters");var c=new b(a.time,a.time+a.duration,a);for(null===this._root?this._root=c:this._root.insert(c),this._length++;null!==c;)c.updateHeight(),c.updateMax(),this._rebalance(c),c=c.parent;return this},a.IntervalTimeline.prototype.remove=function(a){if(null!==this._root){var b=[];this._root.search(a.time,b);for(var c=0;c<b.length;c++){var d=b[c];if(d.event===a){this._removeNode(d),this._length--;break}}}return this},Object.defineProperty(a.IntervalTimeline.prototype,"length",{get:function(){return this._length}}),a.IntervalTimeline.prototype.cancel=function(a){return this.forEachAfter(a,function(a){this.remove(a)}.bind(this)),this},a.IntervalTimeline.prototype._setRoot=function(a){this._root=a,null!==this._root&&(this._root.parent=null)},a.IntervalTimeline.prototype._replaceNodeInParent=function(a,b){null!==a.parent?(a.isLeftChild()?a.parent.left=b:a.parent.right=b,this._rebalance(a.parent)):this._setRoot(b)},a.IntervalTimeline.prototype._removeNode=function(a){if(null===a.left&&null===a.right)this._replaceNodeInParent(a,null);else if(null===a.right)this._replaceNodeInParent(a,a.left);else if(null===a.left)this._replaceNodeInParent(a,a.right);else{var b,c,d=a.getBalance();if(d>0)if(null===a.left.right)b=a.left,b.right=a.right,c=b;else{for(b=a.left.right;null!==b.right;)b=b.right;b.parent.right=b.left,c=b.parent,b.left=a.left,b.right=a.right}else if(null===a.right.left)b=a.right,b.left=a.left,c=b;else{for(b=a.right.left;null!==b.left;)b=b.left;b.parent=b.parent,b.parent.left=b.right,c=b.parent,b.left=a.left,b.right=a.right}null!==a.parent?a.isLeftChild()?a.parent.left=b:a.parent.right=b:this._setRoot(b),this._rebalance(c)}a.dispose()},a.IntervalTimeline.prototype._rotateLeft=function(a){var b=a.parent,c=a.isLeftChild(),d=a.right;a.right=d.left,d.left=a,null!==b?c?b.left=d:b.right=d:this._setRoot(d)},a.IntervalTimeline.prototype._rotateRight=function(a){var b=a.parent,c=a.isLeftChild(),d=a.left;a.left=d.right,d.right=a,null!==b?c?b.left=d:b.right=d:this._setRoot(d)},a.IntervalTimeline.prototype._rebalance=function(a){var b=a.getBalance();b>1?a.left.getBalance()<0?this._rotateLeft(a.left):this._rotateRight(a):-1>b&&(a.right.getBalance()>0?this._rotateRight(a.right):this._rotateLeft(a))},a.IntervalTimeline.prototype.get=function(a){if(null!==this._root){var b=[];if(this._root.search(a,b),b.length>0){for(var c=b[0],d=1;d<b.length;d++)b[d].low>c.low&&(c=b[d]);return c.event}}return null},a.IntervalTimeline.prototype.forEach=function(a){if(null!==this._root){var b=[];null!==this._root&&this._root.traverse(function(a){b.push(a)});for(var c=0;c<b.length;c++){var d=b[c].event;d&&a(d)}}return this},a.IntervalTimeline.prototype.forEachAtTime=function(a,b){if(null!==this._root){var c=[];this._root.search(a,c);for(var d=c.length-1;d>=0;d--){var e=c[d].event;e&&b(e)}}return this},a.IntervalTimeline.prototype.forEachAfter=function(a,b){if(null!==this._root){var c=[];this._root.searchAfter(a,c);for(var d=c.length-1;d>=0;d--){var e=c[d].event;e&&b(e)}}return this},a.IntervalTimeline.prototype.dispose=function(){var a=[];null!==this._root&&this._root.traverse(function(b){a.push(b)});for(var b=0;b<a.length;b++)a[b].dispose();return a=null,this._root=null,this};var b=function(a,b,c){this.event=c,this.low=a,this.high=b,this.max=this.high,this._left=null,this._right=null,this.parent=null,this.height=0};return b.prototype.insert=function(a){a.low<=this.low?null===this.left?this.left=a:this.left.insert(a):null===this.right?this.right=a:this.right.insert(a)},b.prototype.search=function(a,b){a>this.max||(null!==this.left&&this.left.search(a,b),this.low<=a&&this.high>a&&b.push(this),this.low>a||null!==this.right&&this.right.search(a,b))},b.prototype.searchAfter=function(a,b){this.low>=a&&(b.push(this),null!==this.left&&this.left.searchAfter(a,b)),null!==this.right&&this.right.searchAfter(a,b)},b.prototype.traverse=function(a){a(this),null!==this.left&&this.left.traverse(a),null!==this.right&&this.right.traverse(a)},b.prototype.updateHeight=function(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0},b.prototype.updateMax=function(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))},b.prototype.getBalance=function(){var a=0;return null!==this.left&&null!==this.right?a=this.left.height-this.right.height:null!==this.left?a=this.left.height+1:null!==this.right&&(a=-(this.right.height+1)),a},b.prototype.isLeftChild=function(){return null!==this.parent&&this.parent.left===this},Object.defineProperty(b.prototype,"left",{get:function(){return this._left},set:function(a){this._left=a,null!==a&&(a.parent=this),this.updateHeight(),this.updateMax()}}),Object.defineProperty(b.prototype,"right",{get:function(){return this._right},set:function(a){this._right=a,null!==a&&(a.parent=this),this.updateHeight(),this.updateMax()}}),b.prototype.dispose=function(){this.parent=null,this._left=null,this._right=null,this.event=null},a.IntervalTimeline}),b(function(a){a.Transport=function(){a.Emitter.call(this),this.loop=!1,this._loopStart=0,this._loopEnd=0,this._ppq=b.defaults.PPQ,this._clock=new a.Clock({callback:this._processTick.bind(this),frequency:0}),this._bindClockEvents(),this.bpm=this._clock.frequency,this.bpm._toUnits=this._toUnits.bind(this),this.bpm._fromUnits=this._fromUnits.bind(this),this.bpm.units=a.Type.BPM,this.bpm.value=b.defaults.bpm,this._readOnly("bpm"),this._timeSignature=b.defaults.timeSignature,this._scheduledEvents={},this._eventID=0,this._timeline=new a.Timeline,this._repeatedEvents=new a.IntervalTimeline,this._onceEvents=new a.Timeline,this._syncedSignals=[],this._swingTicks=b.defaults.PPQ/2,this._swingAmount=0},a.extend(a.Transport,a.Emitter),a.Transport.defaults={bpm:120,swing:0,swingSubdivision:"8n",timeSignature:4,loopStart:0,loopEnd:"4m",PPQ:192},a.Transport.prototype._processTick=function(b){var c=this._clock.ticks;if(this._swingAmount>0&&c%this._ppq!==0&&c%(2*this._swingTicks)!==0){var d=c%(2*this._swingTicks)/(2*this._swingTicks),e=Math.sin(d*Math.PI)*this._swingAmount;b+=a.Time(2*this._swingTicks/3,"i")*e}this.loop&&c===this._loopEnd&&(this.emit("loopEnd",b),this._clock.ticks=this._loopStart,c=this._loopStart,this.emit("loopStart",b,this.seconds),this.emit("loop",b)),this._onceEvents.forEachBefore(c,function(a){a.callback(b),delete this._scheduledEvents[a.id.toString()]}.bind(this)),this._onceEvents.cancelBefore(c),this._timeline.forEachAtTime(c,function(a){a.callback(b)}),this._repeatedEvents.forEachAtTime(c,function(a){(c-a.time)%a.interval===0&&a.callback(b)})},a.Transport.prototype.schedule=function(a,b){var c={time:this.toTicks(b),callback:a},d=this._eventID++;return this._scheduledEvents[d.toString()]={event:c,timeline:this._timeline},this._timeline.add(c),d},a.Transport.prototype.scheduleRepeat=function(a,b,c,d){if(0>=b)throw new Error("Tone.Transport: repeat events must have an interval larger than 0");var e={time:this.toTicks(c),duration:this.toTicks(this.defaultArg(d,1/0)),interval:this.toTicks(b),callback:a},f=this._eventID++;return this._scheduledEvents[f.toString()]={event:e,timeline:this._repeatedEvents},this._repeatedEvents.add(e),f},a.Transport.prototype.scheduleOnce=function(a,b){var c=this._eventID++,d={time:this.toTicks(b),callback:a,id:c};return this._scheduledEvents[c.toString()]={event:d,timeline:this._onceEvents},this._onceEvents.add(d),c},a.Transport.prototype.clear=function(a){if(this._scheduledEvents.hasOwnProperty(a)){var b=this._scheduledEvents[a.toString()];b.timeline.remove(b.event),delete this._scheduledEvents[a.toString()]}return this},a.Transport.prototype.cancel=function(a){return a=this.defaultArg(a,0),a=this.toTicks(a),this._timeline.cancel(a),this._onceEvents.cancel(a),this._repeatedEvents.cancel(a),this},a.Transport.prototype._bindClockEvents=function(){this._clock.on("start",function(b,c){c=a.Time(this._clock.ticks,"i").toSeconds(),this.emit("start",b,c)}.bind(this)),this._clock.on("stop",function(a){this.emit("stop",a)}.bind(this)),this._clock.on("pause",function(a){this.emit("pause",a)}.bind(this))},Object.defineProperty(a.Transport.prototype,"state",{get:function(){return this._clock.getStateAtTime(this.now())}}),a.Transport.prototype.start=function(a,b){return this.isUndef(b)||(b=this.toTicks(b)),this._clock.start(a,b),this},a.Transport.prototype.stop=function(a){return this._clock.stop(a),this},a.Transport.prototype.pause=function(a){return this._clock.pause(a),this},Object.defineProperty(a.Transport.prototype,"timeSignature",{get:function(){return this._timeSignature},set:function(a){this.isArray(a)&&(a=a[0]/a[1]*4),this._timeSignature=a}}),Object.defineProperty(a.Transport.prototype,"loopStart",{get:function(){return a.TransportTime(this._loopStart,"i").toSeconds()},set:function(a){this._loopStart=this.toTicks(a)}}),Object.defineProperty(a.Transport.prototype,"loopEnd",{get:function(){return a.TransportTime(this._loopEnd,"i").toSeconds()},set:function(a){this._loopEnd=this.toTicks(a)}}),a.Transport.prototype.setLoopPoints=function(a,b){return this.loopStart=a,this.loopEnd=b,this},Object.defineProperty(a.Transport.prototype,"swing",{get:function(){return this._swingAmount},set:function(a){this._swingAmount=a}}),Object.defineProperty(a.Transport.prototype,"swingSubdivision",{get:function(){return a.Time(this._swingTicks,"i").toNotation()},set:function(a){this._swingTicks=this.toTicks(a)}}),Object.defineProperty(a.Transport.prototype,"position",{get:function(){return a.TransportTime(this.ticks,"i").toBarsBeatsSixteenths()},set:function(a){var b=this.toTicks(a);this.ticks=b}}),Object.defineProperty(a.Transport.prototype,"seconds",{get:function(){return a.TransportTime(this.ticks,"i").toSeconds()},set:function(a){var b=this.toTicks(a);this.ticks=b}}),Object.defineProperty(a.Transport.prototype,"progress",{get:function(){return this.loop?(this.ticks-this._loopStart)/(this._loopEnd-this._loopStart):0}}),Object.defineProperty(a.Transport.prototype,"ticks",{get:function(){return this._clock.ticks},set:function(b){if(this._clock.ticks!==b){var c=this.now();this.state===a.State.Started?(this.emit("stop",c),this._clock.ticks=b,this.emit("start",c,this.seconds)):this._clock.ticks=b}}}),Object.defineProperty(a.Transport.prototype,"PPQ",{get:function(){return this._ppq},set:function(a){var b=this.bpm.value;this._ppq=a,this.bpm.value=b}}),Object.defineProperty(a.Transport.prototype,"latencyHint",{get:function(){return a.Clock.latencyHint},set:function(b){a.Clock.latencyHint=b}}),a.Transport.prototype._fromUnits=function(a){return 1/(60/a/this.PPQ)},a.Transport.prototype._toUnits=function(a){return a/this.PPQ*60},a.Transport.prototype.nextSubdivision=function(b){b=this.toSeconds(b);var c;if(this.state!==a.State.Started)return 0;c=this._clock._nextTick;var d=a.Time(this.ticks,"i"),e=b-d%b;return 0===e&&(e=b),c+e},a.Transport.prototype.syncSignal=function(b,c){c||(c=0!==b._param.value?b._param.value/this.bpm._param.value:0);var d=new a.Gain(c);return this.bpm.chain(d,b._param),this._syncedSignals.push({ratio:d,signal:b,initial:b._param.value}),b._param.value=0,this},a.Transport.prototype.unsyncSignal=function(a){for(var b=this._syncedSignals.length-1;b>=0;b--){var c=this._syncedSignals[b];c.signal===a&&(c.ratio.dispose(),c.signal._param.value=c.initial,this._syncedSignals.splice(b,1))}return this},a.Transport.prototype.dispose=function(){return a.Emitter.prototype.dispose.call(this),this._clock.dispose(),this._clock=null,this._writable("bpm"),this.bpm=null,this._timeline.dispose(),this._timeline=null,this._onceEvents.dispose(),this._onceEvents=null,this._repeatedEvents.dispose(),this._repeatedEvents=null,this};var b=a.Transport;return a.Transport=new b,a.Context.on("init",function(c){c.Transport instanceof b?a.Transport=c.Transport:(a.Transport=new b,c.Transport=a.Transport)}),a.Transport}),b(function(a){return a.Volume=function(){var b=this.optionsObject(arguments,["volume"],a.Volume.defaults);this.output=this.input=new a.Gain(b.volume,a.Type.Decibels),this._unmutedVolume=b.volume,this.volume=this.output.gain,this._readOnly("volume"),this.mute=b.mute},a.extend(a.Volume),a.Volume.defaults={volume:0,mute:!1},Object.defineProperty(a.Volume.prototype,"mute",{get:function(){return this.volume.value===-(1/0)},set:function(a){!this.mute&&a?(this._unmutedVolume=this.volume.value,this.volume.value=-(1/0)):this.mute&&!a&&(this.volume.value=this._unmutedVolume)}}),a.Volume.prototype.dispose=function(){return this.input.dispose(),a.prototype.dispose.call(this),this._writable("volume"),this.volume.dispose(),this.volume=null,this},a.Volume}),b(function(a){a.Master=function(){this.createInsOuts(1,1),this._volume=this.output=new a.Volume,this.volume=this._volume.volume,this._readOnly("volume"),this.input.chain(this.output,this.context.destination)},a.extend(a.Master),a.Master.defaults={volume:0,mute:!1},Object.defineProperty(a.Master.prototype,"mute",{get:function(){return this._volume.mute},set:function(a){this._volume.mute=a}}),a.Master.prototype.chain=function(){this.input.disconnect(),this.input.chain.apply(this.input,arguments),arguments[arguments.length-1].connect(this.output)},a.Master.prototype.dispose=function(){a.prototype.dispose.call(this),this._writable("volume"),this._volume.dispose(),this._volume=null,this.volume=null},a.prototype.toMaster=function(){return this.connect(a.Master),this},AudioNode.prototype.toMaster=function(){return this.connect(a.Master),this};var b=a.Master;return a.Master=new b,a.Context.on("init",function(c){c.Master instanceof b?a.Master=c.Master:a.Master=new b,c.Master=a.Master}),a.Master}),b(function(a){return a.Source=function(b){b=this.defaultArg(b,a.Source.defaults),this._volume=this.output=new a.Volume(b.volume),this.volume=this._volume.volume,this._readOnly("volume"),this._state=new a.TimelineState(a.State.Stopped),this._state.memory=10,this._synced=!1,this._scheduled=[],this._volume.output.output.channelCount=2,this._volume.output.output.channelCountMode="explicit",this.mute=b.mute},a.extend(a.Source),a.Source.defaults={volume:0,mute:!1},Object.defineProperty(a.Source.prototype,"state",{get:function(){return this._synced?a.Transport.state===a.State.Started?this._state.getValueAtTime(a.Transport.seconds):a.State.Stopped:this._state.getValueAtTime(this.now())}}),Object.defineProperty(a.Source.prototype,"mute",{get:function(){return this._volume.mute},set:function(a){this._volume.mute=a}}),a.Source.prototype._start=a.noOp,a.Source.prototype._stop=a.noOp,a.Source.prototype.start=function(b,c,d){if(b=this.isUndef(b)&&this._synced?a.Transport.seconds:this.toSeconds(b),this.retrigger||this._state.getValueAtTime(b)!==a.State.Started||this.stop(b),this._state.setStateAtTime(a.State.Started,b),this._synced){var e=this._state.get(b);e.offset=this.defaultArg(c,0),e.duration=d;var f=a.Transport.schedule(function(a){this._start(a,c,d)}.bind(this),b);this._scheduled.push(f)}else this._start.apply(this,arguments);return this},a.Source.prototype.stop=function(b){if(b=this.isUndef(b)&&this._synced?a.Transport.seconds:this.toSeconds(b),this._state.cancel(b),this._state.setStateAtTime(a.State.Stopped,b),this._synced){var c=a.Transport.schedule(this._stop.bind(this),b);this._scheduled.push(c)}else this._stop.apply(this,arguments);return this},a.Source.prototype.sync=function(){return this._synced=!0,a.Transport.on("start loopStart",function(b,c){if(c>0){var d=this._state.get(c);if(d&&d.state===a.State.Started&&d.time!==c){var e,f=c-this.toSeconds(d.time);d.duration&&(e=this.toSeconds(d.duration)-f),this._start(b,this.toSeconds(d.offset)+f,e)}}}.bind(this)),a.Transport.on("stop pause loopEnd",function(b){this._state.getValueAtTime(a.Transport.seconds)===a.State.Started&&this._stop(b)}.bind(this)),this},a.Source.prototype.unsync=function(){this._synced=!1,a.Transport.off("start stop pause loopEnd loopStart");for(var b=0;b<this._scheduled.length;b++){var c=this._scheduled[b];a.Transport.clear(c)}return this._scheduled=[],this._state.cancel(0),this},a.Source.prototype.dispose=function(){a.prototype.dispose.call(this),this.unsync(),this._scheduled=null,this._writable("volume"),this._volume.dispose(),this._volume=null,this.volume=null,this._state.dispose(),this._state=null},a.Source}),b(function(a){return window.OscillatorNode&&!OscillatorNode.prototype.start&&(OscillatorNode.prototype.start=OscillatorNode.prototype.noteOn,OscillatorNode.prototype.stop=OscillatorNode.prototype.noteOff,OscillatorNode.prototype.setPeriodicWave||(OscillatorNode.prototype.setPeriodicWave=OscillatorNode.prototype.setWaveTable),AudioContext.prototype.createPeriodicWave||(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable)),a.Oscillator=function(){var b=this.optionsObject(arguments,["frequency","type"],a.Oscillator.defaults);a.Source.call(this,b),this._oscillator=null,this.frequency=new a.Signal(b.frequency,a.Type.Frequency),this.detune=new a.Signal(b.detune,a.Type.Cents),this._wave=null,this._partials=this.defaultArg(b.partials,[1]),this._phase=b.phase,this._type=null,this.type=b.type,this.phase=this._phase,this._readOnly(["frequency","detune"])},a.extend(a.Oscillator,a.Source),a.Oscillator.defaults={type:"sine",frequency:440,detune:0,phase:0,partials:[]},a.Oscillator.Type={Sine:"sine",Triangle:"triangle",Sawtooth:"sawtooth",Square:"square",Custom:"custom"},a.Oscillator.prototype._start=function(a){this._oscillator=this.context.createOscillator(),this._oscillator.setPeriodicWave(this._wave),this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(this.toSeconds(a))},a.Oscillator.prototype._stop=function(a){return this._oscillator&&(this._oscillator.stop(this.toSeconds(a)),this._oscillator=null),this},a.Oscillator.prototype.syncFrequency=function(){return a.Transport.syncSignal(this.frequency),this},a.Oscillator.prototype.unsyncFrequency=function(){return a.Transport.unsyncSignal(this.frequency),this},Object.defineProperty(a.Oscillator.prototype,"type",{get:function(){return this._type},set:function(a){var b=this._getRealImaginary(a,this._phase),c=this.context.createPeriodicWave(b[0],b[1]);this._wave=c,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),this._type=a}}),a.Oscillator.prototype._getRealImaginary=function(b,c){var d=4096,e=d/2,f=new Float32Array(e),g=new Float32Array(e),h=1;if(b===a.Oscillator.Type.Custom)h=this._partials.length+1,e=h;else{var i=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(b);i&&(h=parseInt(i[2])+1,b=i[1],h=Math.max(h,2),e=h)}for(var j=1;e>j;++j){var k,l=2/(j*Math.PI);switch(b){case a.Oscillator.Type.Sine:k=h>=j?1:0;break;case a.Oscillator.Type.Square:k=1&j?2*l:0;break;case a.Oscillator.Type.Sawtooth:k=l*(1&j?1:-1);break;case a.Oscillator.Type.Triangle:k=1&j?2*(l*l)*(j-1>>1&1?-1:1):0;break;case a.Oscillator.Type.Custom:k=this._partials[j-1];break;default:throw new TypeError("Tone.Oscillator: invalid type: "+b)}0!==k?(f[j]=-k*Math.sin(c*j),g[j]=k*Math.cos(c*j)):(f[j]=0,g[j]=0)}return[f,g]},a.Oscillator.prototype._inverseFFT=function(a,b,c){for(var d=0,e=a.length,f=0;e>f;f++)d+=a[f]*Math.cos(f*c)+b[f]*Math.sin(f*c);return d},a.Oscillator.prototype._getInitialValue=function(){for(var a=this._getRealImaginary(this._type,0),b=a[0],c=a[1],d=0,e=2*Math.PI,f=0;8>f;f++)d=Math.max(this._inverseFFT(b,c,f/8*e),d);return-this._inverseFFT(b,c,this._phase)/d},Object.defineProperty(a.Oscillator.prototype,"partials",{get:function(){return this._type!==a.Oscillator.Type.Custom?[]:this._partials},set:function(b){this._partials=b,this.type=a.Oscillator.Type.Custom}}),Object.defineProperty(a.Oscillator.prototype,"phase",{get:function(){return this._phase*(180/Math.PI)},set:function(a){this._phase=a*Math.PI/180,this.type=this._type}}),a.Oscillator.prototype.dispose=function(){
return a.Source.prototype.dispose.call(this),null!==this._oscillator&&(this._oscillator.disconnect(),this._oscillator=null),this._wave=null,this._writable(["frequency","detune"]),this.frequency.dispose(),this.frequency=null,this.detune.dispose(),this.detune=null,this._partials=null,this},a.Oscillator}),b(function(a){return a.Zero=function(){this._gain=this.input=this.output=new a.Gain,this.context.getConstant(0).connect(this._gain)},a.extend(a.Zero),a.Zero.prototype.dispose=function(){return a.prototype.dispose.call(this),this._gain.dispose(),this._gain=null,this},a.Zero}),b(function(a){return a.LFO=function(){var b=this.optionsObject(arguments,["frequency","min","max"],a.LFO.defaults);this._oscillator=new a.Oscillator({frequency:b.frequency,type:b.type}),this.frequency=this._oscillator.frequency,this.amplitude=this._oscillator.volume,this.amplitude.units=a.Type.NormalRange,this.amplitude.value=b.amplitude,this._stoppedSignal=new a.Signal(0,a.Type.AudioRange),this._zeros=new a.Zero,this._stoppedValue=0,this._a2g=new a.AudioToGain,this._scaler=this.output=new a.Scale(b.min,b.max),this._units=a.Type.Default,this.units=b.units,this._oscillator.chain(this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),this._readOnly(["amplitude","frequency"]),this.phase=b.phase},a.extend(a.LFO,a.Oscillator),a.LFO.defaults={type:"sine",min:0,max:1,phase:0,frequency:"4n",amplitude:1,units:a.Type.Default},a.LFO.prototype.start=function(a){return a=this.toSeconds(a),this._stoppedSignal.setValueAtTime(0,a),this._oscillator.start(a),this},a.LFO.prototype.stop=function(a){return a=this.toSeconds(a),this._stoppedSignal.setValueAtTime(this._stoppedValue,a),this._oscillator.stop(a),this},a.LFO.prototype.sync=function(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this},a.LFO.prototype.unsync=function(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this},Object.defineProperty(a.LFO.prototype,"min",{get:function(){return this._toUnits(this._scaler.min)},set:function(a){a=this._fromUnits(a),this._scaler.min=a}}),Object.defineProperty(a.LFO.prototype,"max",{get:function(){return this._toUnits(this._scaler.max)},set:function(a){a=this._fromUnits(a),this._scaler.max=a}}),Object.defineProperty(a.LFO.prototype,"type",{get:function(){return this._oscillator.type},set:function(a){this._oscillator.type=a,this._stoppedValue=this._oscillator._getInitialValue(),this._stoppedSignal.value=this._stoppedValue}}),Object.defineProperty(a.LFO.prototype,"phase",{get:function(){return this._oscillator.phase},set:function(a){this._oscillator.phase=a,this._stoppedValue=this._oscillator._getInitialValue(),this._stoppedSignal.value=this._stoppedValue}}),Object.defineProperty(a.LFO.prototype,"units",{get:function(){return this._units},set:function(a){var b=this.min,c=this.max;this._units=a,this.min=b,this.max=c}}),Object.defineProperty(a.LFO.prototype,"mute",{get:function(){return this._oscillator.mute},set:function(a){this._oscillator.mute=a}}),Object.defineProperty(a.LFO.prototype,"state",{get:function(){return this._oscillator.state}}),a.LFO.prototype.connect=function(b){return(b.constructor===a.Signal||b.constructor===a.Param||b.constructor===a.TimelineSignal)&&(this.convert=b.convert,this.units=b.units),a.Signal.prototype.connect.apply(this,arguments),this},a.LFO.prototype._fromUnits=a.Param.prototype._fromUnits,a.LFO.prototype._toUnits=a.Param.prototype._toUnits,a.LFO.prototype.dispose=function(){return a.prototype.dispose.call(this),this._writable(["amplitude","frequency"]),this._oscillator.dispose(),this._oscillator=null,this._stoppedSignal.dispose(),this._stoppedSignal=null,this._zeros.dispose(),this._zeros=null,this._scaler.dispose(),this._scaler=null,this._a2g.dispose(),this._a2g=null,this.frequency=null,this.amplitude=null,this},a.LFO}),b(function(a){return a.Limiter=function(){var b=this.optionsObject(arguments,["threshold"],a.Limiter.defaults);this._compressor=this.input=this.output=new a.Compressor({attack:.001,decay:.001,threshold:b.threshold}),this.threshold=this._compressor.threshold,this._readOnly("threshold")},a.extend(a.Limiter),a.Limiter.defaults={threshold:-12},a.Limiter.prototype.dispose=function(){return a.prototype.dispose.call(this),this._compressor.dispose(),this._compressor=null,this._writable("threshold"),this.threshold=null,this},a.Limiter}),b(function(a){return a.LowpassCombFilter=function(){this.createInsOuts(1,1);var b=this.optionsObject(arguments,["delayTime","resonance","dampening"],a.LowpassCombFilter.defaults);this._delay=this.input=new a.Delay(b.delayTime),this.delayTime=this._delay.delayTime,this._lowpass=this.output=this.context.createBiquadFilter(),this._lowpass.Q.value=-3.0102999566398125,this._lowpass.type="lowpass",this.dampening=new a.Param({param:this._lowpass.frequency,units:a.Type.Frequency,value:b.dampening}),this._feedback=new a.Gain(b.resonance,a.Type.NormalRange),this.resonance=this._feedback.gain,this._delay.chain(this._lowpass,this._feedback,this._delay),this._readOnly(["dampening","resonance","delayTime"])},a.extend(a.LowpassCombFilter),a.LowpassCombFilter.defaults={delayTime:.1,resonance:.5,dampening:3e3},a.LowpassCombFilter.prototype.dispose=function(){return a.prototype.dispose.call(this),this._writable(["dampening","resonance","delayTime"]),this.dampening.dispose(),this.dampening=null,this.resonance.dispose(),this.resonance=null,this._delay.dispose(),this._delay=null,this.delayTime=null,this._lowpass.disconnect(),this._lowpass=null,this._feedback.disconnect(),this._feedback=null,this},a.LowpassCombFilter}),b(function(a){return a.Merge=function(){this.createInsOuts(2,0),this.left=this.input[0]=new a.Gain,this.right=this.input[1]=new a.Gain,this._merger=this.output=this.context.createChannelMerger(2),this.left.connect(this._merger,0,0),this.right.connect(this._merger,0,1),this.left.channelCount=1,this.right.channelCount=1,this.left.channelCountMode="explicit",this.right.channelCountMode="explicit"},a.extend(a.Merge),a.Merge.prototype.dispose=function(){return a.prototype.dispose.call(this),this.left.dispose(),this.left=null,this.right.dispose(),this.right=null,this._merger.disconnect(),this._merger=null,this},a.Merge}),b(function(a){return a.Meter=function(){var b=this.optionsObject(arguments,["type","smoothing"],a.Meter.defaults);this.type=b.type,this.input=this.output=this._analyser=new a.Analyser("waveform",512),this._analyser.returnType="float",this.smoothing=b.smoothing,this._lastValue=0},a.extend(a.Meter),a.Meter.Type={Level:"level",Signal:"signal"},a.Meter.defaults={smoothing:.8,type:a.Meter.Type.Level},Object.defineProperty(a.Meter.prototype,"value",{get:function(){var b=this._analyser.analyse();if(this.type===a.Meter.Type.Level){for(var c=0,d=0;d<b.length;d++)c+=Math.pow(b[d],2);var e=Math.sqrt(c/b.length);e=Math.max(e,this._lastValue*this.smoothing),this._lastValue=e;var f=.35,g=e/f;return Math.sqrt(g)}return b[0]}}),a.Meter.prototype.dispose=function(){return a.prototype.dispose.call(this),this._analyser.dispose(),this._analyser=null,this},a.Meter}),b(function(a){return a.Split=function(){this.createInsOuts(0,2),this._splitter=this.input=this.context.createChannelSplitter(2),this.left=this.output[0]=new a.Gain,this.right=this.output[1]=new a.Gain,this._splitter.connect(this.left,0,0),this._splitter.connect(this.right,1,0)},a.extend(a.Split),a.Split.prototype.dispose=function(){return a.prototype.dispose.call(this),this._splitter.disconnect(),this.left.dispose(),this.left=null,this.right.dispose(),this.right=null,this._splitter=null,this},a.Split}),b(function(a){return a.MidSideSplit=function(){this.createInsOuts(0,2),this._split=this.input=new a.Split,this.mid=this.output[0]=new a.Expr("($0 + $1) * $2"),this.side=this.output[1]=new a.Expr("($0 - $1) * $2"),this._split.connect(this.mid,0,0),this._split.connect(this.mid,1,1),this._split.connect(this.side,0,0),this._split.connect(this.side,1,1),this.context.getConstant(Math.SQRT1_2).connect(this.mid,0,2),this.context.getConstant(Math.SQRT1_2).connect(this.side,0,2)},a.extend(a.MidSideSplit),a.MidSideSplit.prototype.dispose=function(){return a.prototype.dispose.call(this),this.mid.dispose(),this.mid=null,this.side.dispose(),this.side=null,this._split.dispose(),this._split=null,this},a.MidSideSplit}),b(function(a){return a.MidSideMerge=function(){this.createInsOuts(2,0),this.mid=this.input[0]=new a.Gain,this._left=new a.Expr("($0 + $1) * $2"),this.side=this.input[1]=new a.Gain,this._right=new a.Expr("($0 - $1) * $2"),this._merge=this.output=new a.Merge,this.mid.connect(this._left,0,0),this.side.connect(this._left,0,1),this.mid.connect(this._right,0,0),this.side.connect(this._right,0,1),this._left.connect(this._merge,0,0),this._right.connect(this._merge,0,1),this.context.getConstant(Math.SQRT1_2).connect(this._left,0,2),this.context.getConstant(Math.SQRT1_2).connect(this._right,0,2)},a.extend(a.MidSideMerge),a.MidSideMerge.prototype.dispose=function(){return a.prototype.dispose.call(this),this.mid.dispose(),this.mid=null,this.side.dispose(),this.side=null,this._left.dispose(),this._left=null,this._right.dispose(),this._right=null,this._merge.dispose(),this._merge=null,this},a.MidSideMerge}),b(function(a){return a.MidSideCompressor=function(b){b=this.defaultArg(b,a.MidSideCompressor.defaults),this._midSideSplit=this.input=new a.MidSideSplit,this._midSideMerge=this.output=new a.MidSideMerge,this.mid=new a.Compressor(b.mid),this.side=new a.Compressor(b.side),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),this._readOnly(["mid","side"])},a.extend(a.MidSideCompressor),a.MidSideCompressor.defaults={mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}},a.MidSideCompressor.prototype.dispose=function(){return a.prototype.dispose.call(this),this._writable(["mid","side"]),this.mid.dispose(),this.mid=null,this.side.dispose(),this.side=null,this._midSideSplit.dispose(),this._midSideSplit=null,this._midSideMerge.dispose(),this._midSideMerge=null,this},a.MidSideCompressor}),b(function(a){return a.Mono=function(){this.createInsOuts(1,0),this._merge=this.output=new a.Merge,this.input.connect(this._merge,0,0),this.input.connect(this._merge,0,1),this.input.gain.value=this.dbToGain(-10)},a.extend(a.Mono),a.Mono.prototype.dispose=function(){return a.prototype.dispose.call(this),this._merge.dispose(),this._merge=null,this},a.Mono}),b(function(a){return a.MultibandCompressor=function(b){b=this.defaultArg(arguments,a.MultibandCompressor.defaults),this._splitter=this.input=new a.MultibandSplit({lowFrequency:b.lowFrequency,highFrequency:b.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=new a.Gain,this.low=new a.Compressor(b.low),this.mid=new a.Compressor(b.mid),this.high=new a.Compressor(b.high),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),this._readOnly(["high","mid","low","highFrequency","lowFrequency"])},a.extend(a.MultibandCompressor),a.MultibandCompressor.defaults={low:a.Compressor.defaults,mid:a.Compressor.defaults,high:a.Compressor.defaults,lowFrequency:250,highFrequency:2e3},a.MultibandCompressor.prototype.dispose=function(){return a.prototype.dispose.call(this),this._splitter.dispose(),this._writable(["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this._splitter=null,this.low=null,this.mid=null,this.high=null,this.lowFrequency=null,this.highFrequency=null,this},a.MultibandCompressor}),b(function(a){return a.Panner=function(b){this._hasStereoPanner?(this._panner=this.input=this.output=this.context.createStereoPanner(),this.pan=this._panner.pan):(this._crossFade=new a.CrossFade,this._merger=this.output=new a.Merge,this._splitter=this.input=new a.Split,this.pan=new a.Signal(0,a.Type.AudioRange),this._zero=new a.Zero,this._a2g=new a.AudioToGain,this._zero.connect(this._a2g),this.pan.chain(this._a2g,this._crossFade.fade),this._splitter.connect(this._crossFade,0,0),this._splitter.connect(this._crossFade,1,1),this._crossFade.a.connect(this._merger,0,0),this._crossFade.b.connect(this._merger,0,1)),this.pan.value=this.defaultArg(b,0),this._readOnly("pan")},a.extend(a.Panner),a.Panner.prototype._hasStereoPanner=a.prototype.isFunction(a.context.createStereoPanner),a.Panner.prototype.dispose=function(){return a.prototype.dispose.call(this),this._writable("pan"),this._hasStereoPanner?(this._panner.disconnect(),this._panner=null,this.pan=null):(this._zero.dispose(),this._zero=null,this._crossFade.dispose(),this._crossFade=null,this._splitter.dispose(),this._splitter=null,this._merger.dispose(),this._merger=null,this.pan.dispose(),this.pan=null,this._a2g.dispose(),this._a2g=null),this},a.Panner}),b(function(a){return a.Panner3D=function(){var b=this.optionsObject(arguments,["positionX","positionY","positionZ"],a.Panner3D.defaults);this._panner=this.input=this.output=this.context.createPanner(),this._panner.panningModel=b.panningModel,this._panner.maxDistance=b.maxDistance,this._panner.distanceModel=b.distanceModel,this._panner.coneOuterGain=b.coneOuterGain,this._panner.coneOuterAngle=b.coneOuterAngle,this._panner.coneInnerAngle=b.coneInnerAngle,this._panner.refDistance=b.refDistance,this._panner.rolloffFactor=b.rolloffFactor,this._orientation=[b.orientationX,b.orientationY,b.orientationZ],this._position=[b.positionX,b.positionY,b.positionZ],this.orientationX=b.orientationX,this.orientationY=b.orientationY,this.orientationZ=b.orientationZ,this.positionX=b.positionX,this.positionY=b.positionY,this.positionZ=b.positionZ},a.extend(a.Panner3D),a.Panner3D.defaults={positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",maxDistance:1e4,distanceModel:"inverse",coneOuterGain:0,coneOuterAngle:360,coneInnerAngle:360,refDistance:1,rolloffFactor:1},a.Panner3D.prototype._rampTimeConstant=.01,a.Panner3D.prototype.setPosition=function(a,b,c){if(this._panner.positionX){var d=this.now();this._panner.positionX.setTargetAtTime(a,d,this._rampTimeConstant),this._panner.positionY.setTargetAtTime(b,d,this._rampTimeConstant),this._panner.positionZ.setTargetAtTime(c,d,this._rampTimeConstant)}else this._panner.setPosition(a,b,c);return this._position=Array.prototype.slice.call(arguments),this},a.Panner3D.prototype.setOrientation=function(a,b,c){if(this._panner.orientationX){var d=this.now();this._panner.orientationX.setTargetAtTime(a,d,this._rampTimeConstant),this._panner.orientationY.setTargetAtTime(b,d,this._rampTimeConstant),this._panner.orientationZ.setTargetAtTime(c,d,this._rampTimeConstant)}else this._panner.setOrientation(a,b,c);return this._orientation=Array.prototype.slice.call(arguments),this},Object.defineProperty(a.Panner3D.prototype,"positionX",{set:function(a){this._position[0]=a,this.setPosition.apply(this,this._position)},get:function(){return this._position[0]}}),Object.defineProperty(a.Panner3D.prototype,"positionY",{set:function(a){this._position[1]=a,this.setPosition.apply(this,this._position)},get:function(){return this._position[1]}}),Object.defineProperty(a.Panner3D.prototype,"positionZ",{set:function(a){this._position[2]=a,this.setPosition.apply(this,this._position)},get:function(){return this._position[2]}}),Object.defineProperty(a.Panner3D.prototype,"orientationX",{set:function(a){this._orientation[0]=a,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[0]}}),Object.defineProperty(a.Panner3D.prototype,"orientationY",{set:function(a){this._orientation[1]=a,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[1]}}),Object.defineProperty(a.Panner3D.prototype,"orientationZ",{set:function(a){this._orientation[2]=a,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[2]}}),a.Panner3D._aliasProperty=function(b){Object.defineProperty(a.Panner3D.prototype,b,{set:function(a){this._panner[b]=a},get:function(){return this._panner[b]}})},a.Panner3D._aliasProperty("panningModel"),a.Panner3D._aliasProperty("refDistance"),a.Panner3D._aliasProperty("rolloffFactor"),a.Panner3D._aliasProperty("distanceModel"),a.Panner3D._aliasProperty("coneInnerAngle"),a.Panner3D._aliasProperty("coneOuterAngle"),a.Panner3D._aliasProperty("coneOuterGain"),a.Panner3D._aliasProperty("maxDistance"),a.Panner3D.prototype.dispose=function(){return this._panner.disconnect(),this._panner=null,this._orientation=null,this._position=null,this},a.Panner3D}),b(function(a){return a.PanVol=function(){var b=this.optionsObject(arguments,["pan","volume"],a.PanVol.defaults);this._panner=this.input=new a.Panner(b.pan),this.pan=this._panner.pan,this._volume=this.output=new a.Volume(b.volume),this.volume=this._volume.volume,this._panner.connect(this._volume),this._readOnly(["pan","volume"])},a.extend(a.PanVol),a.PanVol.defaults={pan:.5,volume:0},a.PanVol.prototype.dispose=function(){return a.prototype.dispose.call(this),this._writable(["pan","volume"]),this._panner.dispose(),this._panner=null,this.pan=null,this._volume.dispose(),this._volume=null,this.volume=null,this},a.PanVol}),b(function(a){return a.CtrlInterpolate=function(){var b=this.optionsObject(arguments,["values","index"],a.CtrlInterpolate.defaults);this.values=b.values,this.index=b.index},a.extend(a.CtrlInterpolate),a.CtrlInterpolate.defaults={index:0,values:[]},Object.defineProperty(a.CtrlInterpolate.prototype,"value",{get:function(){var a=this.index;a=Math.min(a,this.values.length-1);var b=Math.floor(a),c=this.values[b],d=this.values[Math.ceil(a)];return this._interpolate(a-b,c,d)}}),a.CtrlInterpolate.prototype._interpolate=function(a,b,c){if(this.isArray(b)){for(var d=[],e=0;e<b.length;e++)d[e]=this._interpolate(a,b[e],c[e]);return d}if(this.isObject(b)){var f={};for(var g in b)f[g]=this._interpolate(a,b[g],c[g]);return f}return b=this._toNumber(b),c=this._toNumber(c),(1-a)*b+a*c},a.CtrlInterpolate.prototype._toNumber=function(a){return this.isNumber(a)?a:this.toSeconds(a)},a.CtrlInterpolate.prototype.dispose=function(){this.values=null},a.CtrlInterpolate}),b(function(a){return a.CtrlMarkov=function(a,b){this.values=this.defaultArg(a,{}),this.value=this.defaultArg(b,Object.keys(this.values)[0])},a.extend(a.CtrlMarkov),a.CtrlMarkov.prototype.next=function(){if(this.values.hasOwnProperty(this.value)){var a=this.values[this.value];if(this.isArray(a))for(var b=this._getProbDistribution(a),c=Math.random(),d=0,e=0;e<b.length;e++){var f=b[e];if(c>d&&d+f>c){var g=a[e];this.isObject(g)?this.value=g.value:this.value=g}d+=f}else this.value=a}return this.value},a.CtrlMarkov.prototype._getProbDistribution=function(a){for(var b=[],c=0,d=!1,e=0;e<a.length;e++){var f=a[e];this.isObject(f)?(d=!0,b[e]=f.probability):b[e]=1/a.length,c+=b[e]}if(d)for(var g=0;g<b.length;g++)b[g]=b[g]/c;return b},a.CtrlMarkov.prototype.dispose=function(){this.values=null},a.CtrlMarkov}),b(function(a){return a.CtrlPattern=function(){var b=this.optionsObject(arguments,["values","type"],a.CtrlPattern.defaults);this.values=b.values,this.index=0,this._type=null,this._shuffled=null,this._direction=null,this.type=b.type},a.extend(a.CtrlPattern),a.CtrlPattern.Type={Up:"up",Down:"down",UpDown:"upDown",DownUp:"downUp",AlternateUp:"alternateUp",AlternateDown:"alternateDown",Random:"random",RandomWalk:"randomWalk",RandomOnce:"randomOnce"},a.CtrlPattern.defaults={type:a.CtrlPattern.Type.Up,values:[]},Object.defineProperty(a.CtrlPattern.prototype,"value",{get:function(){if(0!==this.values.length){if(1===this.values.length)return this.values[0];this.index=Math.min(this.index,this.values.length-1);var b=this.values[this.index];return this.type===a.CtrlPattern.Type.RandomOnce&&(this.values.length!==this._shuffled.length&&this._shuffleValues(),b=this.values[this._shuffled[this.index]]),b}}}),Object.defineProperty(a.CtrlPattern.prototype,"type",{get:function(){return this._type},set:function(b){this._type=b,this._shuffled=null,this._type===a.CtrlPattern.Type.Up||this._type===a.CtrlPattern.Type.UpDown||this._type===a.CtrlPattern.Type.RandomOnce||this._type===a.CtrlPattern.Type.AlternateUp?this.index=0:(this._type===a.CtrlPattern.Type.Down||this._type===a.CtrlPattern.Type.DownUp||this._type===a.CtrlPattern.Type.AlternateDown)&&(this.index=this.values.length-1),this._type===a.CtrlPattern.Type.UpDown||this._type===a.CtrlPattern.Type.AlternateUp?this._direction=a.CtrlPattern.Type.Up:(this._type===a.CtrlPattern.Type.DownUp||this._type===a.CtrlPattern.Type.AlternateDown)&&(this._direction=a.CtrlPattern.Type.Down),this._type===a.CtrlPattern.Type.RandomOnce?this._shuffleValues():this._type===a.CtrlPattern.Random&&(this.index=Math.floor(Math.random()*this.values.length))}}),a.CtrlPattern.prototype.next=function(){var b=this.type;return b===a.CtrlPattern.Type.Up?(this.index++,this.index>=this.values.length&&(this.index=0)):b===a.CtrlPattern.Type.Down?(this.index--,this.index<0&&(this.index=this.values.length-1)):b===a.CtrlPattern.Type.UpDown||b===a.CtrlPattern.Type.DownUp?(this._direction===a.CtrlPattern.Type.Up?this.index++:this.index--,this.index<0?(this.index=1,this._direction=a.CtrlPattern.Type.Up):this.index>=this.values.length&&(this.index=this.values.length-2,this._direction=a.CtrlPattern.Type.Down)):b===a.CtrlPattern.Type.Random?this.index=Math.floor(Math.random()*this.values.length):b===a.CtrlPattern.Type.RandomWalk?Math.random()<.5?(this.index--,this.index=Math.max(this.index,0)):(this.index++,this.index=Math.min(this.index,this.values.length-1)):b===a.CtrlPattern.Type.RandomOnce?(this.index++,this.index>=this.values.length&&(this.index=0,this._shuffleValues())):b===a.CtrlPattern.Type.AlternateUp?(this._direction===a.CtrlPattern.Type.Up?(this.index+=2,this._direction=a.CtrlPattern.Type.Down):(this.index-=1,this._direction=a.CtrlPattern.Type.Up),this.index>=this.values.length&&(this.index=0,this._direction=a.CtrlPattern.Type.Up)):b===a.CtrlPattern.Type.AlternateDown&&(this._direction===a.CtrlPattern.Type.Up?(this.index+=1,this._direction=a.CtrlPattern.Type.Down):(this.index-=2,this._direction=a.CtrlPattern.Type.Up),this.index<0&&(this.index=this.values.length-1,this._direction=a.CtrlPattern.Type.Down)),this.value},a.CtrlPattern.prototype._shuffleValues=function(){var a=[];this._shuffled=[];for(var b=0;b<this.values.length;b++)a[b]=b;for(;a.length>0;){var c=a.splice(Math.floor(a.length*Math.random()),1);this._shuffled.push(c[0])}},a.CtrlPattern.prototype.dispose=function(){this._shuffled=null,this.values=null},a.CtrlPattern}),b(function(a){return a.CtrlRandom=function(){var b=this.optionsObject(arguments,["min","max"],a.CtrlRandom.defaults);this.min=b.min,this.max=b.max,this.integer=b.integer},a.extend(a.CtrlRandom),a.CtrlRandom.defaults={min:0,max:1,integer:!1},Object.defineProperty(a.CtrlRandom.prototype,"value",{get:function(){var a=this.toSeconds(this.min),b=this.toSeconds(this.max),c=Math.random(),d=c*a+(1-c)*b;return this.integer&&(d=Math.floor(d)),d}}),a.CtrlRandom}),b(function(a){return window.AudioBuffer&&!AudioBuffer.prototype.copyToChannel&&(AudioBuffer.prototype.copyToChannel=function(a,b,c){var d=this.getChannelData(b);c=c||0;for(var e=0;e<d.length;e++)d[e+c]=a[e]},AudioBuffer.prototype.copyFromChannel=function(a,b,c){var d=this.getChannelData(b);c=c||0;for(var e=0;e<d.length;e++)a[e]=d[e+c]}),a.Buffer=function(){var b=this.optionsObject(arguments,["url","onload","onerror"],a.Buffer.defaults);this._buffer=null,this._reversed=b.reverse,this._xhr=null,b.url instanceof AudioBuffer||b.url instanceof a.Buffer?(this.set(b.url),b.onload&&b.onload(this)):this.isString(b.url)&&this.load(b.url,b.onload,b.onerror)},a.extend(a.Buffer),a.Buffer.defaults={url:void 0,reverse:!1},a.Buffer.prototype.set=function(b){return b instanceof a.Buffer?this._buffer=b.get():this._buffer=b,this},a.Buffer.prototype.get=function(){return this._buffer},a.Buffer.prototype.load=function(b,c,d){var e=new Promise(function(e,f){this._xhr=a.Buffer.load(b,function(a){this._xhr=null,this.set(a),e(this),c&&c(this)}.bind(this),function(a){this._xhr=null,f(a),d&&d(a)}.bind(this))}.bind(this));return e},a.Buffer.prototype.dispose=function(){return a.Emitter.prototype.dispose.call(this),this._buffer=null,this._xhr&&(a.Buffer._currentDownloads--,this._xhr.abort(),this._xhr=null),this},Object.defineProperty(a.Buffer.prototype,"loaded",{get:function(){return this.length>0}}),Object.defineProperty(a.Buffer.prototype,"duration",{get:function(){return this._buffer?this._buffer.duration:0}}),Object.defineProperty(a.Buffer.prototype,"length",{get:function(){return this._buffer?this._buffer.length:0}}),Object.defineProperty(a.Buffer.prototype,"numberOfChannels",{get:function(){return this._buffer?this._buffer.numberOfChannels:0}}),a.Buffer.prototype.fromArray=function(a){var b=a[0].length>0,c=b?a.length:1,d=b?a[0].length:a.length,e=this.context.createBuffer(c,d,this.context.sampleRate);b||1!==c||(a=[a]);for(var f=0;c>f;f++)e.copyToChannel(a[f],f);return this._buffer=e,this},a.Buffer.prototype.toMono=function(a){if(this.isNumber(a))this.fromArray(this.toArray(a));else{for(var b=new Float32Array(this.length),c=this.numberOfChannels,d=0;c>d;d++)for(var e=this.toArray(d),f=0;f<e.length;f++)b[f]+=e[f];b=b.map(function(a){return a/c}),this.fromArray(b)}return this},a.Buffer.prototype.toArray=function(a){if(this.isNumber(a))return this.getChannelData(a);if(1===this.numberOfChannels)return this.toArray(0);for(var b=[],c=0;c<this.numberOfChannels;c++)b[c]=this.getChannelData(c);return b},a.Buffer.prototype.getChannelData=function(a){return this._buffer.getChannelData(a)},a.Buffer.prototype.slice=function(b,c){c=this.defaultArg(c,this.duration);for(var d=Math.floor(this.context.sampleRate*this.toSeconds(b)),e=Math.floor(this.context.sampleRate*this.toSeconds(c)),f=[],g=0;g<this.numberOfChannels;g++)f[g]=this.toArray(g).slice(d,e);var h=(new a.Buffer).fromArray(f);return h},a.Buffer.prototype._reverse=function(){if(this.loaded)for(var a=0;a<this.numberOfChannels;a++)Array.prototype.reverse.call(this.getChannelData(a));return this},Object.defineProperty(a.Buffer.prototype,"reverse",{get:function(){return this._reversed},set:function(a){this._reversed!==a&&(this._reversed=a,this._reverse())}}),a.Emitter.mixin(a.Buffer),a.Buffer._downloadQueue=[],a.Buffer._currentDownloads=0,a.Buffer.baseUrl="",a.Buffer.load=function(b,c,d){function e(b){if(!d)throw new Error(b);d(b),a.Buffer.emit("error",b)}function f(){for(var b=0,c=0;c<a.Buffer._downloadQueue.length;c++)b+=a.Buffer._downloadQueue[c].progress;a.Buffer.emit("progress",b/a.Buffer._downloadQueue.length)}c=c||a.noOp;var g=new XMLHttpRequest;return g.open("GET",a.Buffer.baseUrl+b,!0),g.responseType="arraybuffer",g.progress=0,a.Buffer._currentDownloads++,a.Buffer._downloadQueue.push(g),g.addEventListener("load",function(){200===g.status?a.context.decodeAudioData(g.response,function(b){g.progress=1,f(),c(b),a.Buffer._currentDownloads--,0===a.Buffer._currentDownloads&&(a.Buffer._downloadQueue=[],a.Buffer.emit("load"))},function(){e("Tone.Buffer: could not decode audio data: "+b)}):e("Tone.Buffer: could not locate file: "+b)}),g.addEventListener("error",e),g.addEventListener("progress",function(a){a.lengthComputable&&(g.progress=a.loaded/a.total*.95,f())}),g.send(),g},a.Buffer.cancelDownloads=function(){return a.Buffer._downloadQueue.forEach(function(a){a.abort()}),a.Buffer._currentDownloads=0,a.Buffer},a.Buffer.supportsType=function(a){var b=a.split(".");b=b[b.length-1];var c=document.createElement("audio").canPlayType("audio/"+b);return""!==c},a.loaded=function(){function b(){a.Buffer.off("load",c),a.Buffer.off("error",d)}var c,d;return new Promise(function(b,e){c=function(){b()},d=function(){e()},a.Buffer.on("load",c),a.Buffer.on("error",d)}).then(b)["catch"](function(a){throw b(),new Error(a)})},a.Buffer}),b(function(a){return a.Buffers=function(a,b,c){this._buffers={},this.baseUrl=this.defaultArg(c,""),a=this._flattenUrls(a),this._loadingCount=0;for(var d in a)this._loadingCount++,this.add(d,a[d],this._bufferLoaded.bind(this,b))},a.extend(a.Buffers),a.Buffers.prototype.has=function(a){return this._buffers.hasOwnProperty(a)},a.Buffers.prototype.get=function(a){if(this.has(a))return this._buffers[a];throw new Error("Tone.Buffers: no buffer named "+a)},a.Buffers.prototype._bufferLoaded=function(a){this._loadingCount--,0===this._loadingCount&&a&&a(this)},Object.defineProperty(a.Buffers.prototype,"loaded",{get:function(){var a=!0;for(var b in this._buffers){var c=this.get(b);a=a&&c.loaded}return a}}),a.Buffers.prototype.add=function(b,c,d){return d=this.defaultArg(d,a.noOp),c instanceof a.Buffer?(this._buffers[b]=c,d(this)):c instanceof AudioBuffer?(this._buffers[b]=new a.Buffer(c),d(this)):this.isString(c)&&(this._buffers[b]=new a.Buffer(this.baseUrl+c,d)),this},a.Buffers.prototype._flattenUrls=function(a){var b={};for(var c in a)if(a.hasOwnProperty(c))if(this.isObject(a[c])){var d=this._flattenUrls(a[c]);for(var e in d)d.hasOwnProperty(e)&&(b[c+"."+e]=d[e])}else b[c]=a[c];return b},a.Buffers.prototype.dispose=function(){for(var a in this._buffers)this._buffers[a].dispose();return this._buffers=null,this},a.Buffers}),b(function(a){var b={};return a.prototype.send=function(c,d){b.hasOwnProperty(c)||(b[c]=this.context.createGain()),d=this.defaultArg(d,0);var e=new a.Gain(d,a.Type.Decibels);return this.output.chain(e,b[c]),e},a.prototype.receive=function(a,c){return b.hasOwnProperty(a)||(b[a]=this.context.createGain()),this.isUndef(c)&&(c=this.input),b[a].connect(c),this},a.Context.on("init",function(a){a.Buses?b=a.Buses:(b={},a.Buses=b)}),a}),b(function(a){return a.Draw=function(){this._events=new a.Timeline,this.expiration=.25,this.anticipation=.008,this._boundDrawLoop=this._drawLoop.bind(this)},a.extend(a.Draw),a.Draw.prototype.schedule=function(a,b){return this._events.add({callback:a,time:this.toSeconds(b)}),1===this._events.length&&requestAnimationFrame(this._boundDrawLoop),this},a.Draw.prototype.cancel=function(a){return this._events.cancel(this.toSeconds(a)),this},a.Draw.prototype._drawLoop=function(){for(var b=a.now();this._events.length&&this._events.peek().time-this.anticipation<=b;){var c=this._events.shift();b-c.time<=this.expiration&&c.callback()}this._events.length>0&&requestAnimationFrame(this._boundDrawLoop)},a.Draw=new a.Draw,a.Draw}),b(function(a){a.Listener=function(){var a=this.optionsObject(arguments,["positionX","positionY","positionZ"],b.defaults);this._orientation=[a.forwardX,a.forwardY,a.forwardZ,a.upX,a.upY,a.upZ],this._position=[a.positionX,a.positionY,a.positionZ],this.forwardX=a.forwardX,this.forwardY=a.forwardY,this.forwardZ=a.forwardZ,this.upX=a.upX,this.upY=a.upY,this.upZ=a.upZ,this.positionX=a.positionX,this.positionY=a.positionY,this.positionZ=a.positionZ},a.extend(a.Listener),a.Listener.defaults={positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:1,upX:0,upY:1,upZ:0},a.Listener.prototype._rampTimeConstant=.01,a.Listener.prototype.setPosition=function(a,b,c){if(this.context.listener.positionX){var d=this.now();this.context.listener.positionX.setTargetAtTime(a,d,this._rampTimeConstant),this.context.listener.positionY.setTargetAtTime(b,d,this._rampTimeConstant),this.context.listener.positionZ.setTargetAtTime(c,d,this._rampTimeConstant)}else this.context.listener.setPosition(a,b,c);return this._position=Array.prototype.slice.call(arguments),this},a.Listener.prototype.setOrientation=function(a,b,c,d,e,f){if(this.context.listener.forwardX){var g=this.now();this.context.listener.forwardX.setTargetAtTime(a,g,this._rampTimeConstant),this.context.listener.forwardY.setTargetAtTime(b,g,this._rampTimeConstant),this.context.listener.forwardZ.setTargetAtTime(c,g,this._rampTimeConstant),this.context.listener.upX.setTargetAtTime(d,g,this._rampTimeConstant),this.context.listener.upY.setTargetAtTime(e,g,this._rampTimeConstant),this.context.listener.upZ.setTargetAtTime(f,g,this._rampTimeConstant);
}else this.context.listener.setOrientation(a,b,c,d,e,f);return this._orientation=Array.prototype.slice.call(arguments),this},Object.defineProperty(a.Listener.prototype,"positionX",{set:function(a){this._position[0]=a,this.setPosition.apply(this,this._position)},get:function(){return this._position[0]}}),Object.defineProperty(a.Listener.prototype,"positionY",{set:function(a){this._position[1]=a,this.setPosition.apply(this,this._position)},get:function(){return this._position[1]}}),Object.defineProperty(a.Listener.prototype,"positionZ",{set:function(a){this._position[2]=a,this.setPosition.apply(this,this._position)},get:function(){return this._position[2]}}),Object.defineProperty(a.Listener.prototype,"forwardX",{set:function(a){this._orientation[0]=a,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[0]}}),Object.defineProperty(a.Listener.prototype,"forwardY",{set:function(a){this._orientation[1]=a,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[1]}}),Object.defineProperty(a.Listener.prototype,"forwardZ",{set:function(a){this._orientation[2]=a,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[2]}}),Object.defineProperty(a.Listener.prototype,"upX",{set:function(a){this._orientation[3]=a,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[3]}}),Object.defineProperty(a.Listener.prototype,"upY",{set:function(a){this._orientation[4]=a,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[4]}}),Object.defineProperty(a.Listener.prototype,"upZ",{set:function(a){this._orientation[5]=a,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[5]}}),a.Listener.prototype.dispose=function(){return this._orientation=null,this._position=null,this};var b=a.Listener;return a.Listener=new b,a.Context.on("init",function(c){c.Listener instanceof b?a.Listener=c.Listener:a.Listener=new b,c.Listener=a.Listener}),a.Listener}),b(function(a){return!window.hasOwnProperty("OfflineAudioContext")&&window.hasOwnProperty("webkitOfflineAudioContext")&&(window.OfflineAudioContext=window.webkitOfflineAudioContext),a.OfflineContext=function(b,c,d){var e=new OfflineAudioContext(b,c*d,d);a.Context.call(this,e),this._duration=c,this._currentTime=0,this.lookAhead=this.blockTime,this.updateInterval=this.blockTime},a.extend(a.OfflineContext,a.Context),a.OfflineContext.prototype.now=function(){return this._currentTime},a.OfflineContext.prototype._createWorker=function(){return{postMessage:function(){}}},a.OfflineContext.prototype.render=function(){for(;this._duration-this._currentTime>=0;)this.emit("tick"),this._currentTime+=a.prototype.blockTime;return new Promise(function(a){this._context.oncomplete=function(b){a(b.renderedBuffer)},this._context.startRendering()}.bind(this))},a.OfflineContext}),b(function(a){return a.Offline=function(b,c){var d=a.context.sampleRate,e=a.context,f=new a.OfflineContext(2,c,d);a.context=f,b(a.Transport);var g=f.render();return a.context=e,g.then(function(b){return new a.Buffer(b)})},a.Offline}),b(function(a){return a.Effect=function(){this.createInsOuts(1,1);var b=this.optionsObject(arguments,["wet"],a.Effect.defaults);this._dryWet=new a.CrossFade(b.wet),this.wet=this._dryWet.fade,this.effectSend=new a.Gain,this.effectReturn=new a.Gain,this.input.connect(this._dryWet.a),this.input.connect(this.effectSend),this.effectReturn.connect(this._dryWet.b),this._dryWet.connect(this.output),this._readOnly(["wet"])},a.extend(a.Effect),a.Effect.defaults={wet:1},a.Effect.prototype.connectEffect=function(a){return this.effectSend.chain(a,this.effectReturn),this},a.Effect.prototype.dispose=function(){return a.prototype.dispose.call(this),this._dryWet.dispose(),this._dryWet=null,this.effectSend.dispose(),this.effectSend=null,this.effectReturn.dispose(),this.effectReturn=null,this._writable(["wet"]),this.wet=null,this},a.Effect}),b(function(a){return a.AutoFilter=function(){var b=this.optionsObject(arguments,["frequency","baseFrequency","octaves"],a.AutoFilter.defaults);a.Effect.call(this,b),this._lfo=new a.LFO({frequency:b.frequency,amplitude:b.depth}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.filter=new a.Filter(b.filter),this._octaves=0,this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.type=b.type,this._readOnly(["frequency","depth"]),this.octaves=b.octaves,this.baseFrequency=b.baseFrequency},a.extend(a.AutoFilter,a.Effect),a.AutoFilter.defaults={frequency:1,type:"sine",depth:1,baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}},a.AutoFilter.prototype.start=function(a){return this._lfo.start(a),this},a.AutoFilter.prototype.stop=function(a){return this._lfo.stop(a),this},a.AutoFilter.prototype.sync=function(a){return this._lfo.sync(a),this},a.AutoFilter.prototype.unsync=function(){return this._lfo.unsync(),this},Object.defineProperty(a.AutoFilter.prototype,"type",{get:function(){return this._lfo.type},set:function(a){this._lfo.type=a}}),Object.defineProperty(a.AutoFilter.prototype,"baseFrequency",{get:function(){return this._lfo.min},set:function(a){this._lfo.min=this.toFrequency(a),this.octaves=this._octaves}}),Object.defineProperty(a.AutoFilter.prototype,"octaves",{get:function(){return this._octaves},set:function(a){this._octaves=a,this._lfo.max=this.baseFrequency*Math.pow(2,a)}}),a.AutoFilter.prototype.dispose=function(){return a.Effect.prototype.dispose.call(this),this._lfo.dispose(),this._lfo=null,this.filter.dispose(),this.filter=null,this._writable(["frequency","depth"]),this.frequency=null,this.depth=null,this},a.AutoFilter}),b(function(a){return a.AutoPanner=function(){var b=this.optionsObject(arguments,["frequency"],a.AutoPanner.defaults);a.Effect.call(this,b),this._lfo=new a.LFO({frequency:b.frequency,amplitude:b.depth,min:-1,max:1}),this.depth=this._lfo.amplitude,this._panner=new a.Panner,this.frequency=this._lfo.frequency,this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this.type=b.type,this._readOnly(["depth","frequency"])},a.extend(a.AutoPanner,a.Effect),a.AutoPanner.defaults={frequency:1,type:"sine",depth:1},a.AutoPanner.prototype.start=function(a){return this._lfo.start(a),this},a.AutoPanner.prototype.stop=function(a){return this._lfo.stop(a),this},a.AutoPanner.prototype.sync=function(a){return this._lfo.sync(a),this},a.AutoPanner.prototype.unsync=function(){return this._lfo.unsync(),this},Object.defineProperty(a.AutoPanner.prototype,"type",{get:function(){return this._lfo.type},set:function(a){this._lfo.type=a}}),a.AutoPanner.prototype.dispose=function(){return a.Effect.prototype.dispose.call(this),this._lfo.dispose(),this._lfo=null,this._panner.dispose(),this._panner=null,this._writable(["depth","frequency"]),this.frequency=null,this.depth=null,this},a.AutoPanner}),b(function(a){return a.AutoWah=function(){var b=this.optionsObject(arguments,["baseFrequency","octaves","sensitivity"],a.AutoWah.defaults);a.Effect.call(this,b),this.follower=new a.Follower(b.follower),this._sweepRange=new a.ScaleExp(0,1,.5),this._baseFrequency=b.baseFrequency,this._octaves=b.octaves,this._inputBoost=new a.Gain,this._bandpass=new a.Filter({rolloff:-48,frequency:0,Q:b.Q}),this._peaking=new a.Filter(0,"peaking"),this._peaking.gain.value=b.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this.follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=b.sensitivity,this._readOnly(["gain","Q"])},a.extend(a.AutoWah,a.Effect),a.AutoWah.defaults={baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:{attack:.3,release:.5}},Object.defineProperty(a.AutoWah.prototype,"octaves",{get:function(){return this._octaves},set:function(a){this._octaves=a,this._setSweepRange()}}),Object.defineProperty(a.AutoWah.prototype,"baseFrequency",{get:function(){return this._baseFrequency},set:function(a){this._baseFrequency=a,this._setSweepRange()}}),Object.defineProperty(a.AutoWah.prototype,"sensitivity",{get:function(){return this.gainToDb(1/this._inputBoost.gain.value)},set:function(a){this._inputBoost.gain.value=1/this.dbToGain(a)}}),a.AutoWah.prototype._setSweepRange=function(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)},a.AutoWah.prototype.dispose=function(){return a.Effect.prototype.dispose.call(this),this.follower.dispose(),this.follower=null,this._sweepRange.dispose(),this._sweepRange=null,this._bandpass.dispose(),this._bandpass=null,this._peaking.dispose(),this._peaking=null,this._inputBoost.dispose(),this._inputBoost=null,this._writable(["gain","Q"]),this.gain=null,this.Q=null,this},a.AutoWah}),b(function(a){return a.BitCrusher=function(){var b=this.optionsObject(arguments,["bits"],a.BitCrusher.defaults);a.Effect.call(this,b);var c=1/Math.pow(2,b.bits-1);this._subtract=new a.Subtract,this._modulo=new a.Modulo(c),this._bits=b.bits,this.effectSend.fan(this._subtract,this._modulo),this._modulo.connect(this._subtract,0,1),this._subtract.connect(this.effectReturn)},a.extend(a.BitCrusher,a.Effect),a.BitCrusher.defaults={bits:4},Object.defineProperty(a.BitCrusher.prototype,"bits",{get:function(){return this._bits},set:function(a){this._bits=a;var b=1/Math.pow(2,a-1);this._modulo.value=b}}),a.BitCrusher.prototype.dispose=function(){return a.Effect.prototype.dispose.call(this),this._subtract.dispose(),this._subtract=null,this._modulo.dispose(),this._modulo=null,this},a.BitCrusher}),b(function(a){return a.Chebyshev=function(){var b=this.optionsObject(arguments,["order"],a.Chebyshev.defaults);a.Effect.call(this,b),this._shaper=new a.WaveShaper(4096),this._order=b.order,this.connectEffect(this._shaper),this.order=b.order,this.oversample=b.oversample},a.extend(a.Chebyshev,a.Effect),a.Chebyshev.defaults={order:1,oversample:"none"},a.Chebyshev.prototype._getCoefficient=function(a,b,c){return c.hasOwnProperty(b)?c[b]:(0===b?c[b]=0:1===b?c[b]=a:c[b]=2*a*this._getCoefficient(a,b-1,c)-this._getCoefficient(a,b-2,c),c[b])},Object.defineProperty(a.Chebyshev.prototype,"order",{get:function(){return this._order},set:function(a){this._order=a;for(var b=new Array(4096),c=b.length,d=0;c>d;++d){var e=2*d/c-1;0===e?b[d]=0:b[d]=this._getCoefficient(e,a,{})}this._shaper.curve=b}}),Object.defineProperty(a.Chebyshev.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(a){this._shaper.oversample=a}}),a.Chebyshev.prototype.dispose=function(){return a.Effect.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this},a.Chebyshev}),b(function(a){return a.StereoEffect=function(){this.createInsOuts(1,1);var b=this.optionsObject(arguments,["wet"],a.Effect.defaults);this._dryWet=new a.CrossFade(b.wet),this.wet=this._dryWet.fade,this._split=new a.Split,this.effectSendL=this._split.left,this.effectSendR=this._split.right,this._merge=new a.Merge,this.effectReturnL=this._merge.left,this.effectReturnR=this._merge.right,this.input.connect(this._split),this.input.connect(this._dryWet,0,0),this._merge.connect(this._dryWet,0,1),this._dryWet.connect(this.output),this._readOnly(["wet"])},a.extend(a.StereoEffect,a.Effect),a.StereoEffect.prototype.dispose=function(){return a.prototype.dispose.call(this),this._dryWet.dispose(),this._dryWet=null,this._split.dispose(),this._split=null,this._merge.dispose(),this._merge=null,this.effectSendL=null,this.effectSendR=null,this.effectReturnL=null,this.effectReturnR=null,this._writable(["wet"]),this.wet=null,this},a.StereoEffect}),b(function(a){return a.FeedbackEffect=function(){var b=this.optionsObject(arguments,["feedback"]);b=this.defaultArg(b,a.FeedbackEffect.defaults),a.Effect.call(this,b),this._feedbackGain=new a.Gain(b.feedback,a.Type.NormalRange),this.feedback=this._feedbackGain.gain,this.effectReturn.chain(this._feedbackGain,this.effectSend),this._readOnly(["feedback"])},a.extend(a.FeedbackEffect,a.Effect),a.FeedbackEffect.defaults={feedback:.125},a.FeedbackEffect.prototype.dispose=function(){return a.Effect.prototype.dispose.call(this),this._writable(["feedback"]),this._feedbackGain.dispose(),this._feedbackGain=null,this.feedback=null,this},a.FeedbackEffect}),b(function(a){return a.StereoXFeedbackEffect=function(){var b=this.optionsObject(arguments,["feedback"],a.FeedbackEffect.defaults);a.StereoEffect.call(this,b),this.feedback=new a.Signal(b.feedback,a.Type.NormalRange),this._feedbackLR=new a.Gain,this._feedbackRL=new a.Gain,this.effectReturnL.chain(this._feedbackLR,this.effectSendR),this.effectReturnR.chain(this._feedbackRL,this.effectSendL),this.feedback.fan(this._feedbackLR.gain,this._feedbackRL.gain),this._readOnly(["feedback"])},a.extend(a.StereoXFeedbackEffect,a.FeedbackEffect),a.StereoXFeedbackEffect.prototype.dispose=function(){return a.StereoEffect.prototype.dispose.call(this),this._writable(["feedback"]),this.feedback.dispose(),this.feedback=null,this._feedbackLR.dispose(),this._feedbackLR=null,this._feedbackRL.dispose(),this._feedbackRL=null,this},a.StereoXFeedbackEffect}),b(function(a){return a.Chorus=function(){var b=this.optionsObject(arguments,["frequency","delayTime","depth"],a.Chorus.defaults);a.StereoXFeedbackEffect.call(this,b),this._depth=b.depth,this._delayTime=b.delayTime/1e3,this._lfoL=new a.LFO({frequency:b.frequency,min:0,max:1}),this._lfoR=new a.LFO({frequency:b.frequency,min:0,max:1,phase:180}),this._delayNodeL=new a.Delay,this._delayNodeR=new a.Delay,this.frequency=this._lfoL.frequency,this.effectSendL.chain(this._delayNodeL,this.effectReturnL),this.effectSendR.chain(this._delayNodeR,this.effectReturnR),this.effectSendL.connect(this.effectReturnL),this.effectSendR.connect(this.effectReturnR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this._lfoL.start(),this._lfoR.start(),this._lfoL.frequency.connect(this._lfoR.frequency),this.depth=this._depth,this.frequency.value=b.frequency,this.type=b.type,this._readOnly(["frequency"]),this.spread=b.spread},a.extend(a.Chorus,a.StereoXFeedbackEffect),a.Chorus.defaults={frequency:1.5,delayTime:3.5,depth:.7,feedback:.1,type:"sine",spread:180},Object.defineProperty(a.Chorus.prototype,"depth",{get:function(){return this._depth},set:function(a){this._depth=a;var b=this._delayTime*a;this._lfoL.min=Math.max(this._delayTime-b,0),this._lfoL.max=this._delayTime+b,this._lfoR.min=Math.max(this._delayTime-b,0),this._lfoR.max=this._delayTime+b}}),Object.defineProperty(a.Chorus.prototype,"delayTime",{get:function(){return 1e3*this._delayTime},set:function(a){this._delayTime=a/1e3,this.depth=this._depth}}),Object.defineProperty(a.Chorus.prototype,"type",{get:function(){return this._lfoL.type},set:function(a){this._lfoL.type=a,this._lfoR.type=a}}),Object.defineProperty(a.Chorus.prototype,"spread",{get:function(){return this._lfoR.phase-this._lfoL.phase},set:function(a){this._lfoL.phase=90-a/2,this._lfoR.phase=a/2+90}}),a.Chorus.prototype.dispose=function(){return a.StereoXFeedbackEffect.prototype.dispose.call(this),this._lfoL.dispose(),this._lfoL=null,this._lfoR.dispose(),this._lfoR=null,this._delayNodeL.dispose(),this._delayNodeL=null,this._delayNodeR.dispose(),this._delayNodeR=null,this._writable("frequency"),this.frequency=null,this},a.Chorus}),b(function(a){return a.Convolver=function(){var b=this.optionsObject(arguments,["url","onload"],a.Convolver.defaults);a.Effect.call(this,b),this._convolver=this.context.createConvolver(),this._buffer=new a.Buffer,this.isString(b.url)?this._buffer.load(b.url,function(a){this.buffer=a,b.onload()}.bind(this)):b.url&&(this.buffer=b.url,b.onload()),this.connectEffect(this._convolver)},a.extend(a.Convolver,a.Effect),a.Convolver.defaults={onload:a.noOp},Object.defineProperty(a.Convolver.prototype,"buffer",{get:function(){return this._buffer.get()},set:function(a){this._buffer.set(a),this._convolver.buffer=this._buffer.get()}}),a.Convolver.prototype.load=function(a,b){return this._buffer.load(a,function(a){this.buffer=a,b&&b()}.bind(this))},a.Convolver.prototype.dispose=function(){return a.Effect.prototype.dispose.call(this),this._convolver.disconnect(),this._convolver=null,this._buffer.dispose(),this._buffer=null,this},a.Convolver}),b(function(a){return a.Distortion=function(){var b=this.optionsObject(arguments,["distortion"],a.Distortion.defaults);a.Effect.call(this,b),this._shaper=new a.WaveShaper(4096),this._distortion=b.distortion,this.connectEffect(this._shaper),this.distortion=b.distortion,this.oversample=b.oversample},a.extend(a.Distortion,a.Effect),a.Distortion.defaults={distortion:.4,oversample:"none"},Object.defineProperty(a.Distortion.prototype,"distortion",{get:function(){return this._distortion},set:function(a){this._distortion=a;var b=100*a,c=Math.PI/180;this._shaper.setMap(function(a){return Math.abs(a)<.001?0:(3+b)*a*20*c/(Math.PI+b*Math.abs(a))})}}),Object.defineProperty(a.Distortion.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(a){this._shaper.oversample=a}}),a.Distortion.prototype.dispose=function(){return a.Effect.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this},a.Distortion}),b(function(a){return a.FeedbackDelay=function(){var b=this.optionsObject(arguments,["delayTime","feedback"],a.FeedbackDelay.defaults);a.FeedbackEffect.call(this,b),this._delayNode=new a.Delay(b.delayTime),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),this._readOnly(["delayTime"])},a.extend(a.FeedbackDelay,a.FeedbackEffect),a.FeedbackDelay.defaults={delayTime:.25},a.FeedbackDelay.prototype.dispose=function(){return a.FeedbackEffect.prototype.dispose.call(this),this._delayNode.dispose(),this._delayNode=null,this._writable(["delayTime"]),this.delayTime=null,this},a.FeedbackDelay}),b(function(a){var b=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],c=[225,556,441,341];return a.Freeverb=function(){var d=this.optionsObject(arguments,["roomSize","dampening"],a.Freeverb.defaults);a.StereoEffect.call(this,d),this.roomSize=new a.Signal(d.roomSize,a.Type.NormalRange),this.dampening=new a.Signal(d.dampening,a.Type.Frequency),this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[];for(var e=0;e<c.length;e++){var f=this.context.createBiquadFilter();f.type="allpass",f.frequency.value=c[e],this._allpassFiltersL.push(f)}for(var g=0;g<c.length;g++){var h=this.context.createBiquadFilter();h.type="allpass",h.frequency.value=c[g],this._allpassFiltersR.push(h)}for(var i=0;i<b.length;i++){var j=new a.LowpassCombFilter(b[i]);i<b.length/2?this.effectSendL.chain(j,this._allpassFiltersL[0]):this.effectSendR.chain(j,this._allpassFiltersR[0]),this.roomSize.connect(j.resonance),this.dampening.connect(j.dampening),this._combFilters.push(j)}this.connectSeries.apply(this,this._allpassFiltersL),this.connectSeries.apply(this,this._allpassFiltersR),this._allpassFiltersL[this._allpassFiltersL.length-1].connect(this.effectReturnL),this._allpassFiltersR[this._allpassFiltersR.length-1].connect(this.effectReturnR),this._readOnly(["roomSize","dampening"])},a.extend(a.Freeverb,a.StereoEffect),a.Freeverb.defaults={roomSize:.7,dampening:3e3},a.Freeverb.prototype.dispose=function(){a.StereoEffect.prototype.dispose.call(this);for(var b=0;b<this._allpassFiltersL.length;b++)this._allpassFiltersL[b].disconnect(),this._allpassFiltersL[b]=null;this._allpassFiltersL=null;for(var c=0;c<this._allpassFiltersR.length;c++)this._allpassFiltersR[c].disconnect(),this._allpassFiltersR[c]=null;this._allpassFiltersR=null;for(var d=0;d<this._combFilters.length;d++)this._combFilters[d].dispose(),this._combFilters[d]=null;return this._combFilters=null,this._writable(["roomSize","dampening"]),this.roomSize.dispose(),this.roomSize=null,this.dampening.dispose(),this.dampening=null,this},a.Freeverb}),b(function(a){var b=[.06748,.06404,.08212,.09004],c=[.773,.802,.753,.733],d=[347,113,37];return a.JCReverb=function(){var e=this.optionsObject(arguments,["roomSize"],a.JCReverb.defaults);a.StereoEffect.call(this,e),this.roomSize=new a.Signal(e.roomSize,a.Type.NormalRange),this._scaleRoomSize=new a.Scale(-.733,.197),this._allpassFilters=[],this._feedbackCombFilters=[];for(var f=0;f<d.length;f++){var g=this.context.createBiquadFilter();g.type="allpass",g.frequency.value=d[f],this._allpassFilters.push(g)}for(var h=0;h<b.length;h++){var i=new a.FeedbackCombFilter(b[h],.1);this._scaleRoomSize.connect(i.resonance),i.resonance.value=c[h],this._allpassFilters[this._allpassFilters.length-1].connect(i),h<b.length/2?i.connect(this.effectReturnL):i.connect(this.effectReturnR),this._feedbackCombFilters.push(i)}this.roomSize.connect(this._scaleRoomSize),this.connectSeries.apply(this,this._allpassFilters),this.effectSendL.connect(this._allpassFilters[0]),this.effectSendR.connect(this._allpassFilters[0]),this._readOnly(["roomSize"])},a.extend(a.JCReverb,a.StereoEffect),a.JCReverb.defaults={roomSize:.5},a.JCReverb.prototype.dispose=function(){a.StereoEffect.prototype.dispose.call(this);for(var b=0;b<this._allpassFilters.length;b++)this._allpassFilters[b].disconnect(),this._allpassFilters[b]=null;this._allpassFilters=null;for(var c=0;c<this._feedbackCombFilters.length;c++)this._feedbackCombFilters[c].dispose(),this._feedbackCombFilters[c]=null;return this._feedbackCombFilters=null,this._writable(["roomSize"]),this.roomSize.dispose(),this.roomSize=null,this._scaleRoomSize.dispose(),this._scaleRoomSize=null,this},a.JCReverb}),b(function(a){return a.MidSideEffect=function(){a.Effect.apply(this,arguments),this._midSideSplit=new a.MidSideSplit,this._midSideMerge=new a.MidSideMerge,this.midSend=this._midSideSplit.mid,this.sideSend=this._midSideSplit.side,this.midReturn=this._midSideMerge.mid,this.sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)},a.extend(a.MidSideEffect,a.Effect),a.MidSideEffect.prototype.dispose=function(){return a.Effect.prototype.dispose.call(this),this._midSideSplit.dispose(),this._midSideSplit=null,this._midSideMerge.dispose(),this._midSideMerge=null,this.midSend=null,this.sideSend=null,this.midReturn=null,this.sideReturn=null,this},a.MidSideEffect}),b(function(a){return a.Phaser=function(){var b=this.optionsObject(arguments,["frequency","octaves","baseFrequency"],a.Phaser.defaults);a.StereoEffect.call(this,b),this._lfoL=new a.LFO(b.frequency,0,1),this._lfoR=new a.LFO(b.frequency,0,1),this._lfoR.phase=180,this._baseFrequency=b.baseFrequency,this._octaves=b.octaves,this.Q=new a.Signal(b.Q,a.Type.Positive),this._filtersL=this._makeFilters(b.stages,this._lfoL,this.Q),this._filtersR=this._makeFilters(b.stages,this._lfoR,this.Q),this.frequency=this._lfoL.frequency,this.frequency.value=b.frequency,this.effectSendL.connect(this._filtersL[0]),this.effectSendR.connect(this._filtersR[0]),this._filtersL[b.stages-1].connect(this.effectReturnL),this._filtersR[b.stages-1].connect(this.effectReturnR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=b.baseFrequency,this.octaves=b.octaves,this._lfoL.start(),this._lfoR.start(),this._readOnly(["frequency","Q"])},a.extend(a.Phaser,a.StereoEffect),a.Phaser.defaults={frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350},a.Phaser.prototype._makeFilters=function(a,b,c){for(var d=new Array(a),e=0;a>e;e++){var f=this.context.createBiquadFilter();f.type="allpass",c.connect(f.Q),b.connect(f.frequency),d[e]=f}return this.connectSeries.apply(this,d),d},Object.defineProperty(a.Phaser.prototype,"octaves",{get:function(){return this._octaves},set:function(a){this._octaves=a;var b=this._baseFrequency*Math.pow(2,a);this._lfoL.max=b,this._lfoR.max=b}}),Object.defineProperty(a.Phaser.prototype,"baseFrequency",{get:function(){return this._baseFrequency},set:function(a){this._baseFrequency=a,this._lfoL.min=a,this._lfoR.min=a,this.octaves=this._octaves}}),a.Phaser.prototype.dispose=function(){a.StereoEffect.prototype.dispose.call(this),this._writable(["frequency","Q"]),this.Q.dispose(),this.Q=null,this._lfoL.dispose(),this._lfoL=null,this._lfoR.dispose(),this._lfoR=null;for(var b=0;b<this._filtersL.length;b++)this._filtersL[b].disconnect(),this._filtersL[b]=null;this._filtersL=null;for(var c=0;c<this._filtersR.length;c++)this._filtersR[c].disconnect(),this._filtersR[c]=null;return this._filtersR=null,this.frequency=null,this},a.Phaser}),b(function(a){return a.PingPongDelay=function(){var b=this.optionsObject(arguments,["delayTime","feedback"],a.PingPongDelay.defaults);a.StereoXFeedbackEffect.call(this,b),this._leftDelay=new a.Delay(0,b.maxDelayTime),this._rightDelay=new a.Delay(0,b.maxDelayTime),this._rightPreDelay=new a.Delay(0,b.maxDelayTime),this.delayTime=new a.Signal(b.delayTime,a.Type.Time),this.effectSendL.chain(this._leftDelay,this.effectReturnL),this.effectSendR.chain(this._rightPreDelay,this._rightDelay,this.effectReturnR),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackLR.disconnect(),this._feedbackLR.connect(this._rightDelay),this._readOnly(["delayTime"])},a.extend(a.PingPongDelay,a.StereoXFeedbackEffect),a.PingPongDelay.defaults={delayTime:.25,maxDelayTime:1},a.PingPongDelay.prototype.dispose=function(){return a.StereoXFeedbackEffect.prototype.dispose.call(this),this._leftDelay.dispose(),this._leftDelay=null,this._rightDelay.dispose(),this._rightDelay=null,this._rightPreDelay.dispose(),this._rightPreDelay=null,this._writable(["delayTime"]),this.delayTime.dispose(),this.delayTime=null,this},a.PingPongDelay}),b(function(a){return a.PitchShift=function(){var b=this.optionsObject(arguments,["pitch"],a.PitchShift.defaults);a.FeedbackEffect.call(this,b),this._frequency=new a.Signal(0),this._delayA=new a.Delay(0,1),this._lfoA=new a.LFO({min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new a.Delay(0,1),this._lfoB=new a.LFO({min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new a.CrossFade,this._crossFadeLFO=new a.LFO({min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new a.Delay(b.delayTime),this.delayTime=this._feedbackDelay.delayTime,this._readOnly("delayTime"),this._pitch=b.pitch,this._windowSize=b.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);var c=this.now();this._lfoA.start(c),this._lfoB.start(c),this._crossFadeLFO.start(c),this.windowSize=this._windowSize},a.extend(a.PitchShift,a.FeedbackEffect),a.PitchShift.defaults={pitch:0,windowSize:.1,delayTime:0,feedback:0},Object.defineProperty(a.PitchShift.prototype,"pitch",{get:function(){return this._pitch},set:function(a){this._pitch=a;var b=0;0>a?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,b=this.intervalToFrequencyRatio(a-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,b=this.intervalToFrequencyRatio(a)-1),this._frequency.value=b*(1.2/this._windowSize)}}),Object.defineProperty(a.PitchShift.prototype,"windowSize",{get:function(){return this._windowSize},set:function(a){this._windowSize=this.toSeconds(a),this.pitch=this._pitch}}),a.PitchShift.prototype.dispose=function(){return a.FeedbackEffect.prototype.dispose.call(this),this._frequency.dispose(),this._frequency=null,this._delayA.disconnect(),this._delayA=null,this._delayB.disconnect(),this._delayB=null,this._lfoA.dispose(),this._lfoA=null,this._lfoB.dispose(),this._lfoB=null,this._crossFade.dispose(),this._crossFade=null,this._crossFadeLFO.dispose(),this._crossFadeLFO=null,this._writable("delayTime"),this._feedbackDelay.dispose(),this._feedbackDelay=null,this.delayTime=null,this},a.PitchShift}),b(function(a){return a.StereoFeedbackEffect=function(){var b=this.optionsObject(arguments,["feedback"],a.FeedbackEffect.defaults);a.StereoEffect.call(this,b),this.feedback=new a.Signal(b.feedback,a.Type.NormalRange),this._feedbackL=new a.Gain,this._feedbackR=new a.Gain,this.effectReturnL.chain(this._feedbackL,this.effectSendL),this.effectReturnR.chain(this._feedbackR,this.effectSendR),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),this._readOnly(["feedback"])},a.extend(a.StereoFeedbackEffect,a.FeedbackEffect),a.StereoFeedbackEffect.prototype.dispose=function(){return a.StereoEffect.prototype.dispose.call(this),this._writable(["feedback"]),this.feedback.dispose(),this.feedback=null,this._feedbackL.dispose(),this._feedbackL=null,this._feedbackR.dispose(),this._feedbackR=null,this},a.StereoFeedbackEffect}),b(function(a){return a.StereoWidener=function(){var b=this.optionsObject(arguments,["width"],a.StereoWidener.defaults);a.MidSideEffect.call(this,b),this.width=new a.Signal(b.width,a.Type.NormalRange),this._midMult=new a.Expr("$0 * ($1 * (1 - $2))"),this._sideMult=new a.Expr("$0 * ($1 * $2)"),this._two=new a.Signal(2),this._two.connect(this._midMult,0,1),this.width.connect(this._midMult,0,2),this._two.connect(this._sideMult,0,1),this.width.connect(this._sideMult,0,2),this.midSend.chain(this._midMult,this.midReturn),this.sideSend.chain(this._sideMult,this.sideReturn),this._readOnly(["width"])},a.extend(a.StereoWidener,a.MidSideEffect),a.StereoWidener.defaults={width:.5},a.StereoWidener.prototype.dispose=function(){return a.MidSideEffect.prototype.dispose.call(this),this._writable(["width"]),this.width.dispose(),this.width=null,this._midMult.dispose(),this._midMult=null,this._sideMult.dispose(),this._sideMult=null,this._two.dispose(),this._two=null,this},a.StereoWidener}),b(function(a){return a.Tremolo=function(){var b=this.optionsObject(arguments,["frequency","depth"],a.Tremolo.defaults);a.StereoEffect.call(this,b),this._lfoL=new a.LFO({phase:b.spread,min:1,max:0}),this._lfoR=new a.LFO({phase:b.spread,min:1,max:0}),this._amplitudeL=new a.Gain,this._amplitudeR=new a.Gain,this.frequency=new a.Signal(b.frequency,a.Type.Frequency),this.depth=new a.Signal(b.depth,a.Type.NormalRange),this._readOnly(["frequency","depth"]),this.effectSendL.chain(this._amplitudeL,this.effectReturnL),this.effectSendR.chain(this._amplitudeR,this.effectReturnR),this._lfoL.connect(this._amplitudeL.gain),this._lfoR.connect(this._amplitudeR.gain),this.frequency.fan(this._lfoL.frequency,this._lfoR.frequency),this.depth.fan(this._lfoR.amplitude,this._lfoL.amplitude),this.type=b.type,this.spread=b.spread},a.extend(a.Tremolo,a.StereoEffect),a.Tremolo.defaults={frequency:10,type:"sine",depth:.5,spread:180},a.Tremolo.prototype.start=function(a){return this._lfoL.start(a),this._lfoR.start(a),this},a.Tremolo.prototype.stop=function(a){return this._lfoL.stop(a),this._lfoR.stop(a),this},a.Tremolo.prototype.sync=function(a){return this._lfoL.sync(a),this._lfoR.sync(a),this},a.Tremolo.prototype.unsync=function(){return this._lfoL.unsync(),this._lfoR.unsync(),this},Object.defineProperty(a.Tremolo.prototype,"type",{get:function(){return this._lfoL.type},set:function(a){this._lfoL.type=a,this._lfoR.type=a}}),Object.defineProperty(a.Tremolo.prototype,"spread",{get:function(){return this._lfoR.phase-this._lfoL.phase},set:function(a){this._lfoL.phase=90-a/2,this._lfoR.phase=a/2+90}}),a.Tremolo.prototype.dispose=function(){return a.StereoEffect.prototype.dispose.call(this),this._writable(["frequency","depth"]),this._lfoL.dispose(),this._lfoL=null,this._lfoR.dispose(),this._lfoR=null,this._amplitudeL.dispose(),this._amplitudeL=null,this._amplitudeR.dispose(),this._amplitudeR=null,this.frequency=null,this.depth=null,this},a.Tremolo}),b(function(a){return a.Vibrato=function(){var b=this.optionsObject(arguments,["frequency","depth"],a.Vibrato.defaults);
a.Effect.call(this,b),this._delayNode=new a.Delay(0,b.maxDelay),this._lfo=new a.LFO({type:b.type,min:0,max:b.maxDelay,frequency:b.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=b.depth,this._readOnly(["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)},a.extend(a.Vibrato,a.Effect),a.Vibrato.defaults={maxDelay:.005,frequency:5,depth:.1,type:"sine"},Object.defineProperty(a.Vibrato.prototype,"type",{get:function(){return this._lfo.type},set:function(a){this._lfo.type=a}}),a.Vibrato.prototype.dispose=function(){a.Effect.prototype.dispose.call(this),this._delayNode.dispose(),this._delayNode=null,this._lfo.dispose(),this._lfo=null,this._writable(["frequency","depth"]),this.frequency=null,this.depth=null},a.Vibrato}),b(function(a){return a.Event=function(){var b=this.optionsObject(arguments,["callback","value"],a.Event.defaults);this._loop=b.loop,this.callback=b.callback,this.value=b.value,this._loopStart=this.toTicks(b.loopStart),this._loopEnd=this.toTicks(b.loopEnd),this._state=new a.TimelineState(a.State.Stopped),this._playbackRate=1,this._startOffset=0,this.probability=b.probability,this.humanize=b.humanize,this.mute=b.mute,this.playbackRate=b.playbackRate},a.extend(a.Event),a.Event.defaults={callback:a.noOp,loop:!1,loopEnd:"1m",loopStart:0,playbackRate:1,value:null,probability:1,mute:!1,humanize:!1},a.Event.prototype._rescheduleEvents=function(b){return b=this.defaultArg(b,-1),this._state.forEachFrom(b,function(b){var c;if(b.state===a.State.Started){this.isUndef(b.id)||a.Transport.clear(b.id);var d=b.time+Math.round(this.startOffset/this._playbackRate);if(this._loop){c=1/0,this.isNumber(this._loop)&&(c=this._loop*this._getLoopDuration());var e=this._state.getAfter(d);null!==e&&(c=Math.min(c,e.time-d)),c!==1/0&&(this._state.setStateAtTime(a.State.Stopped,d+c+1),c=a.Time(c,"i"));var f=a.Time(this._getLoopDuration(),"i");b.id=a.Transport.scheduleRepeat(this._tick.bind(this),f,a.TransportTime(d,"i"),c)}else b.id=a.Transport.schedule(this._tick.bind(this),d+"i")}}.bind(this)),this},Object.defineProperty(a.Event.prototype,"state",{get:function(){return this._state.getValueAtTime(a.Transport.ticks)}}),Object.defineProperty(a.Event.prototype,"startOffset",{get:function(){return this._startOffset},set:function(a){this._startOffset=a}}),a.Event.prototype.start=function(b){return b=this.toTicks(b),this._state.getValueAtTime(b)===a.State.Stopped&&(this._state.add({state:a.State.Started,time:b,id:void 0}),this._rescheduleEvents(b)),this},a.Event.prototype.stop=function(b){if(this.cancel(b),b=this.toTicks(b),this._state.getValueAtTime(b)===a.State.Started){this._state.setStateAtTime(a.State.Stopped,b);var c=this._state.getBefore(b),d=b;null!==c&&(d=c.time),this._rescheduleEvents(d)}return this},a.Event.prototype.cancel=function(b){return b=this.defaultArg(b,-(1/0)),b=this.toTicks(b),this._state.forEachFrom(b,function(b){a.Transport.clear(b.id)}),this._state.cancel(b),this},a.Event.prototype._tick=function(b){if(!this.mute&&this._state.getValueAtTime(a.Transport.ticks)===a.State.Started){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){var c=.02;this.isBoolean(this.humanize)||(c=this.toSeconds(this.humanize)),b+=(2*Math.random()-1)*c}this.callback(b,this.value)}},a.Event.prototype._getLoopDuration=function(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)},Object.defineProperty(a.Event.prototype,"loop",{get:function(){return this._loop},set:function(a){this._loop=a,this._rescheduleEvents()}}),Object.defineProperty(a.Event.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(a){this._playbackRate=a,this._rescheduleEvents()}}),Object.defineProperty(a.Event.prototype,"loopEnd",{get:function(){return a.TransportTime(this._loopEnd,"i").toNotation()},set:function(a){this._loopEnd=this.toTicks(a),this._loop&&this._rescheduleEvents()}}),Object.defineProperty(a.Event.prototype,"loopStart",{get:function(){return a.TransportTime(this._loopStart,"i").toNotation()},set:function(a){this._loopStart=this.toTicks(a),this._loop&&this._rescheduleEvents()}}),Object.defineProperty(a.Event.prototype,"progress",{get:function(){if(this._loop){var b=a.Transport.ticks,c=this._state.get(b);if(null!==c&&c.state===a.State.Started){var d=this._getLoopDuration(),e=(b-c.time)%d;return e/d}return 0}return 0}}),a.Event.prototype.dispose=function(){this.cancel(),this._state.dispose(),this._state=null,this.callback=null,this.value=null},a.Event}),b(function(a){return a.Loop=function(){var b=this.optionsObject(arguments,["callback","interval"],a.Loop.defaults);this._event=new a.Event({callback:this._tick.bind(this),loop:!0,loopEnd:b.interval,playbackRate:b.playbackRate,probability:b.probability}),this.callback=b.callback,this.iterations=b.iterations},a.extend(a.Loop),a.Loop.defaults={interval:"4n",callback:a.noOp,playbackRate:1,iterations:1/0,probability:!0,mute:!1},a.Loop.prototype.start=function(a){return this._event.start(a),this},a.Loop.prototype.stop=function(a){return this._event.stop(a),this},a.Loop.prototype.cancel=function(a){return this._event.cancel(a),this},a.Loop.prototype._tick=function(a){this.callback(a)},Object.defineProperty(a.Loop.prototype,"state",{get:function(){return this._event.state}}),Object.defineProperty(a.Loop.prototype,"progress",{get:function(){return this._event.progress}}),Object.defineProperty(a.Loop.prototype,"interval",{get:function(){return this._event.loopEnd},set:function(a){this._event.loopEnd=a}}),Object.defineProperty(a.Loop.prototype,"playbackRate",{get:function(){return this._event.playbackRate},set:function(a){this._event.playbackRate=a}}),Object.defineProperty(a.Loop.prototype,"humanize",{get:function(){return this._event.humanize},set:function(a){this._event.humanize=a}}),Object.defineProperty(a.Loop.prototype,"probability",{get:function(){return this._event.probability},set:function(a){this._event.probability=a}}),Object.defineProperty(a.Loop.prototype,"mute",{get:function(){return this._event.mute},set:function(a){this._event.mute=a}}),Object.defineProperty(a.Loop.prototype,"iterations",{get:function(){return this._event.loop===!0?1/0:this._event.loop},set:function(a){a===1/0?this._event.loop=!0:this._event.loop=a}}),a.Loop.prototype.dispose=function(){this._event.dispose(),this._event=null,this.callback=null},a.Loop}),b(function(a){return a.Part=function(){var b=this.optionsObject(arguments,["callback","events"],a.Part.defaults);this._loop=b.loop,this._loopStart=this.toTicks(b.loopStart),this._loopEnd=this.toTicks(b.loopEnd),this._playbackRate=b.playbackRate,this._probability=b.probability,this._humanize=b.humanize,this._startOffset=0,this._state=new a.TimelineState(a.State.Stopped),this._events=[],this.callback=b.callback,this.mute=b.mute;var c=this.defaultArg(b.events,[]);if(!this.isUndef(b.events))for(var d=0;d<c.length;d++)Array.isArray(c[d])?this.add(c[d][0],c[d][1]):this.add(c[d])},a.extend(a.Part,a.Event),a.Part.defaults={callback:a.noOp,loop:!1,loopEnd:"1m",loopStart:0,playbackRate:1,probability:1,humanize:!1,mute:!1},a.Part.prototype.start=function(b,c){var d=this.toTicks(b);return this._state.getValueAtTime(d)!==a.State.Started&&(c=this._loop?this.defaultArg(c,this._loopStart):this.defaultArg(c,0),c=this.toTicks(c),this._state.add({state:a.State.Started,time:d,offset:c}),this._forEach(function(a){this._startNote(a,d,c)})),this},a.Part.prototype._startNote=function(b,c,d){c-=d,this._loop?b.startOffset>=this._loopStart&&b.startOffset<this._loopEnd?(b.startOffset<d&&(c+=this._getLoopDuration()),b.start(a.TransportTime(c,"i"))):b.startOffset<this._loopStart&&b.startOffset>=d&&(b.loop=!1,b.start(a.TransportTime(c,"i"))):b.startOffset>=d&&b.start(a.TransportTime(c,"i"))},Object.defineProperty(a.Part.prototype,"startOffset",{get:function(){return this._startOffset},set:function(a){this._startOffset=a,this._forEach(function(a){a.startOffset+=this._startOffset})}}),a.Part.prototype.stop=function(b){var c=this.toTicks(b);return this._state.cancel(c),this._state.setStateAtTime(a.State.Stopped,c),this._forEach(function(a){a.stop(b)}),this},a.Part.prototype.at=function(b,c){b=a.TransportTime(b);for(var d=a.Time(1,"i").toSeconds(),e=0;e<this._events.length;e++){var f=this._events[e];if(Math.abs(b.toTicks()-f.startOffset)<d)return this.isUndef(c)||(f.value=c),f}return this.isUndef(c)?null:(this.add(b,c),this._events[this._events.length-1])},a.Part.prototype.add=function(b,c){b.hasOwnProperty("time")&&(c=b,b=c.time),b=this.toTicks(b);var d;return c instanceof a.Event?(d=c,d.callback=this._tick.bind(this)):d=new a.Event({callback:this._tick.bind(this),value:c}),d.startOffset=b,d.set({loopEnd:this.loopEnd,loopStart:this.loopStart,loop:this.loop,humanize:this.humanize,playbackRate:this.playbackRate,probability:this.probability}),this._events.push(d),this._restartEvent(d),this},a.Part.prototype._restartEvent=function(b){this._state.forEach(function(c){c.state===a.State.Started?this._startNote(b,c.time,c.offset):b.stop(a.TransportTime(c.time,"i"))}.bind(this))},a.Part.prototype.remove=function(b,c){b.hasOwnProperty("time")&&(c=b,b=c.time),b=this.toTicks(b);for(var d=this._events.length-1;d>=0;d--){var e=this._events[d];e instanceof a.Part?e.remove(b,c):e.startOffset===b&&(this.isUndef(c)||!this.isUndef(c)&&e.value===c)&&(this._events.splice(d,1),e.dispose())}return this},a.Part.prototype.removeAll=function(){return this._forEach(function(a){a.dispose()}),this._events=[],this},a.Part.prototype.cancel=function(a){return a=this.toTicks(a),this._forEach(function(b){b.cancel(a)}),this._state.cancel(a),this},a.Part.prototype._forEach=function(b,c){c=this.defaultArg(c,this);for(var d=this._events.length-1;d>=0;d--){var e=this._events[d];e instanceof a.Part?e._forEach(b,c):b.call(c,e)}return this},a.Part.prototype._setAll=function(a,b){this._forEach(function(c){c[a]=b})},a.Part.prototype._tick=function(a,b){this.mute||this.callback(a,b)},a.Part.prototype._testLoopBoundries=function(b){b.startOffset<this._loopStart||b.startOffset>=this._loopEnd?b.cancel(0):b.state===a.State.Stopped&&this._restartEvent(b)},Object.defineProperty(a.Part.prototype,"probability",{get:function(){return this._probability},set:function(a){this._probability=a,this._setAll("probability",a)}}),Object.defineProperty(a.Part.prototype,"humanize",{get:function(){return this._humanize},set:function(a){this._humanize=a,this._setAll("humanize",a)}}),Object.defineProperty(a.Part.prototype,"loop",{get:function(){return this._loop},set:function(a){this._loop=a,this._forEach(function(b){b._loopStart=this._loopStart,b._loopEnd=this._loopEnd,b.loop=a,this._testLoopBoundries(b)})}}),Object.defineProperty(a.Part.prototype,"loopEnd",{get:function(){return a.TransportTime(this._loopEnd,"i").toNotation()},set:function(a){this._loopEnd=this.toTicks(a),this._loop&&this._forEach(function(b){b.loopEnd=a,this._testLoopBoundries(b)})}}),Object.defineProperty(a.Part.prototype,"loopStart",{get:function(){return a.TransportTime(this._loopStart,"i").toNotation()},set:function(a){this._loopStart=this.toTicks(a),this._loop&&this._forEach(function(a){a.loopStart=this.loopStart,this._testLoopBoundries(a)})}}),Object.defineProperty(a.Part.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(a){this._playbackRate=a,this._setAll("playbackRate",a)}}),Object.defineProperty(a.Part.prototype,"length",{get:function(){return this._events.length}}),a.Part.prototype.dispose=function(){return this.removeAll(),this._state.dispose(),this._state=null,this.callback=null,this._events=null,this},a.Part}),b(function(a){return a.Pattern=function(){var b=this.optionsObject(arguments,["callback","values","pattern"],a.Pattern.defaults);a.Loop.call(this,b),this._pattern=new a.CtrlPattern({values:b.values,type:b.pattern,index:b.index})},a.extend(a.Pattern,a.Loop),a.Pattern.defaults={pattern:a.CtrlPattern.Type.Up,values:[]},a.Pattern.prototype._tick=function(a){this.callback(a,this._pattern.value),this._pattern.next()},Object.defineProperty(a.Pattern.prototype,"index",{get:function(){return this._pattern.index},set:function(a){this._pattern.index=a}}),Object.defineProperty(a.Pattern.prototype,"values",{get:function(){return this._pattern.values},set:function(a){this._pattern.values=a}}),Object.defineProperty(a.Pattern.prototype,"value",{get:function(){return this._pattern.value}}),Object.defineProperty(a.Pattern.prototype,"pattern",{get:function(){return this._pattern.type},set:function(a){this._pattern.type=a}}),a.Pattern.prototype.dispose=function(){a.Loop.prototype.dispose.call(this),this._pattern.dispose(),this._pattern=null},a.Pattern}),b(function(a){return a.Sequence=function(){var b=this.optionsObject(arguments,["callback","events","subdivision"],a.Sequence.defaults),c=b.events;if(delete b.events,a.Part.call(this,b),this._subdivision=this.toTicks(b.subdivision),this.isUndef(b.loopEnd)&&!this.isUndef(c)&&(this._loopEnd=c.length*this._subdivision),this._loop=!0,!this.isUndef(c))for(var d=0;d<c.length;d++)this.add(d,c[d])},a.extend(a.Sequence,a.Part),a.Sequence.defaults={subdivision:"4n"},Object.defineProperty(a.Sequence.prototype,"subdivision",{get:function(){return a.Time(this._subdivision,"i").toNotation()}}),a.Sequence.prototype.at=function(b,c){return this.isArray(c)&&this.remove(b),a.Part.prototype.at.call(this,this._indexTime(b),c)},a.Sequence.prototype.add=function(b,c){if(null===c)return this;if(this.isArray(c)){var d=Math.round(this._subdivision/c.length);c=new a.Sequence(this._tick.bind(this),c,a.Time(d,"i"))}return a.Part.prototype.add.call(this,this._indexTime(b),c),this},a.Sequence.prototype.remove=function(b,c){return a.Part.prototype.remove.call(this,this._indexTime(b),c),this},a.Sequence.prototype._indexTime=function(b){return b instanceof a.TransportTime?b:a.TransportTime(b*this._subdivision+this.startOffset,"i")},a.Sequence.prototype.dispose=function(){return a.Part.prototype.dispose.call(this),this},a.Sequence}),b(function(a){return a.PulseOscillator=function(){var b=this.optionsObject(arguments,["frequency","width"],a.Oscillator.defaults);a.Source.call(this,b),this.width=new a.Signal(b.width,a.Type.NormalRange),this._widthGate=new a.Gain,this._sawtooth=new a.Oscillator({frequency:b.frequency,detune:b.detune,type:"sawtooth",phase:b.phase}),this.frequency=this._sawtooth.frequency,this.detune=this._sawtooth.detune,this._thresh=new a.WaveShaper(function(a){return 0>a?-1:1}),this._sawtooth.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),this._readOnly(["width","frequency","detune"])},a.extend(a.PulseOscillator,a.Oscillator),a.PulseOscillator.defaults={frequency:440,detune:0,phase:0,width:.2},a.PulseOscillator.prototype._start=function(a){a=this.toSeconds(a),this._sawtooth.start(a),this._widthGate.gain.setValueAtTime(1,a)},a.PulseOscillator.prototype._stop=function(a){a=this.toSeconds(a),this._sawtooth.stop(a),this._widthGate.gain.setValueAtTime(0,a)},Object.defineProperty(a.PulseOscillator.prototype,"phase",{get:function(){return this._sawtooth.phase},set:function(a){this._sawtooth.phase=a}}),Object.defineProperty(a.PulseOscillator.prototype,"type",{get:function(){return"pulse"}}),Object.defineProperty(a.PulseOscillator.prototype,"partials",{get:function(){return[]}}),a.PulseOscillator.prototype.dispose=function(){return a.Source.prototype.dispose.call(this),this._sawtooth.dispose(),this._sawtooth=null,this._writable(["width","frequency","detune"]),this.width.dispose(),this.width=null,this._widthGate.dispose(),this._widthGate=null,this._thresh.dispose(),this._thresh=null,this.frequency=null,this.detune=null,this},a.PulseOscillator}),b(function(a){return a.PWMOscillator=function(){var b=this.optionsObject(arguments,["frequency","modulationFrequency"],a.PWMOscillator.defaults);a.Source.call(this,b),this._pulse=new a.PulseOscillator(b.modulationFrequency),this._pulse._sawtooth.type="sine",this._modulator=new a.Oscillator({frequency:b.frequency,detune:b.detune,phase:b.phase}),this._scale=new a.Multiply(2),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this.modulationFrequency=this._pulse.frequency,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),this._readOnly(["modulationFrequency","frequency","detune"])},a.extend(a.PWMOscillator,a.Oscillator),a.PWMOscillator.defaults={frequency:440,detune:0,phase:0,modulationFrequency:.4},a.PWMOscillator.prototype._start=function(a){a=this.toSeconds(a),this._modulator.start(a),this._pulse.start(a)},a.PWMOscillator.prototype._stop=function(a){a=this.toSeconds(a),this._modulator.stop(a),this._pulse.stop(a)},Object.defineProperty(a.PWMOscillator.prototype,"type",{get:function(){return"pwm"}}),Object.defineProperty(a.PWMOscillator.prototype,"partials",{get:function(){return[]}}),Object.defineProperty(a.PWMOscillator.prototype,"phase",{get:function(){return this._modulator.phase},set:function(a){this._modulator.phase=a}}),a.PWMOscillator.prototype.dispose=function(){return a.Source.prototype.dispose.call(this),this._pulse.dispose(),this._pulse=null,this._scale.dispose(),this._scale=null,this._modulator.dispose(),this._modulator=null,this._writable(["modulationFrequency","frequency","detune"]),this.frequency=null,this.detune=null,this.modulationFrequency=null,this},a.PWMOscillator}),b(function(a){return a.FMOscillator=function(){var b=this.optionsObject(arguments,["frequency","type","modulationType"],a.FMOscillator.defaults);a.Source.call(this,b),this._carrier=new a.Oscillator(b.frequency,b.type),this.frequency=new a.Signal(b.frequency,a.Type.Frequency),this.detune=this._carrier.detune,this.detune.value=b.detune,this.modulationIndex=new a.Multiply(b.modulationIndex),this.modulationIndex.units=a.Type.Positive,this._modulator=new a.Oscillator(b.frequency,b.modulationType),this.harmonicity=new a.Multiply(b.harmonicity),this.harmonicity.units=a.Type.Positive,this._modulationNode=new a.Gain(0),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),this.phase=b.phase,this._readOnly(["modulationIndex","frequency","detune","harmonicity"])},a.extend(a.FMOscillator,a.Oscillator),a.FMOscillator.defaults={frequency:440,detune:0,phase:0,modulationIndex:2,modulationType:"square",harmonicity:1},a.FMOscillator.prototype._start=function(a){a=this.toSeconds(a),this._modulator.start(a),this._carrier.start(a)},a.FMOscillator.prototype._stop=function(a){a=this.toSeconds(a),this._modulator.stop(a),this._carrier.stop(a)},Object.defineProperty(a.FMOscillator.prototype,"type",{get:function(){return this._carrier.type},set:function(a){this._carrier.type=a}}),Object.defineProperty(a.FMOscillator.prototype,"modulationType",{get:function(){return this._modulator.type},set:function(a){this._modulator.type=a}}),Object.defineProperty(a.FMOscillator.prototype,"phase",{get:function(){return this._carrier.phase},set:function(a){this._carrier.phase=a,this._modulator.phase=a}}),Object.defineProperty(a.FMOscillator.prototype,"partials",{get:function(){return this._carrier.partials},set:function(a){this._carrier.partials=a}}),a.FMOscillator.prototype.dispose=function(){return a.Source.prototype.dispose.call(this),this._writable(["modulationIndex","frequency","detune","harmonicity"]),this.frequency.dispose(),this.frequency=null,this.detune=null,this.harmonicity.dispose(),this.harmonicity=null,this._carrier.dispose(),this._carrier=null,this._modulator.dispose(),this._modulator=null,this._modulationNode.dispose(),this._modulationNode=null,this.modulationIndex.dispose(),this.modulationIndex=null,this},a.FMOscillator}),b(function(a){return a.AMOscillator=function(){var b=this.optionsObject(arguments,["frequency","type","modulationType"],a.AMOscillator.defaults);a.Source.call(this,b),this._carrier=new a.Oscillator(b.frequency,b.type),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this.detune.value=b.detune,this._modulator=new a.Oscillator(b.frequency,b.modulationType),this._modulationScale=new a.AudioToGain,this.harmonicity=new a.Multiply(b.harmonicity),this.harmonicity.units=a.Type.Positive,this._modulationNode=new a.Gain(0),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.connect(this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),this.phase=b.phase,this._readOnly(["frequency","detune","harmonicity"])},a.extend(a.AMOscillator,a.Oscillator),a.AMOscillator.defaults={frequency:440,detune:0,phase:0,modulationType:"square",harmonicity:1},a.AMOscillator.prototype._start=function(a){a=this.toSeconds(a),this._modulator.start(a),this._carrier.start(a)},a.AMOscillator.prototype._stop=function(a){a=this.toSeconds(a),this._modulator.stop(a),this._carrier.stop(a)},Object.defineProperty(a.AMOscillator.prototype,"type",{get:function(){return this._carrier.type},set:function(a){this._carrier.type=a}}),Object.defineProperty(a.AMOscillator.prototype,"modulationType",{get:function(){return this._modulator.type},set:function(a){this._modulator.type=a}}),Object.defineProperty(a.AMOscillator.prototype,"phase",{get:function(){return this._carrier.phase},set:function(a){this._carrier.phase=a,this._modulator.phase=a}}),Object.defineProperty(a.AMOscillator.prototype,"partials",{get:function(){return this._carrier.partials},set:function(a){this._carrier.partials=a}}),a.AMOscillator.prototype.dispose=function(){return a.Source.prototype.dispose.call(this),this._writable(["frequency","detune","harmonicity"]),this.frequency=null,this.detune=null,this.harmonicity.dispose(),this.harmonicity=null,this._carrier.dispose(),this._carrier=null,this._modulator.dispose(),this._modulator=null,this._modulationNode.dispose(),this._modulationNode=null,this._modulationScale.dispose(),this._modulationScale=null,this},a.AMOscillator}),b(function(a){return a.FatOscillator=function(){var b=this.optionsObject(arguments,["frequency","type","spread"],a.FatOscillator.defaults);a.Source.call(this,b),this.frequency=new a.Signal(b.frequency,a.Type.Frequency),this.detune=new a.Signal(b.detune,a.Type.Cents),this._oscillators=[],this._spread=b.spread,this._type=b.type,this._phase=b.phase,this._partials=this.defaultArg(b.partials,[]),this.count=b.count,this._readOnly(["frequency","detune"])},a.extend(a.FatOscillator,a.Oscillator),a.FatOscillator.defaults={frequency:440,detune:0,phase:0,spread:20,count:3,type:"sawtooth"},a.FatOscillator.prototype._start=function(a){a=this.toSeconds(a),this._forEach(function(b){b.start(a)})},a.FatOscillator.prototype._stop=function(a){a=this.toSeconds(a),this._forEach(function(b){b.stop(a)})},a.FatOscillator.prototype._forEach=function(a){for(var b=0;b<this._oscillators.length;b++)a.call(this,this._oscillators[b],b)},Object.defineProperty(a.FatOscillator.prototype,"type",{get:function(){return this._type},set:function(a){this._type=a,this._forEach(function(b){b.type=a})}}),Object.defineProperty(a.FatOscillator.prototype,"spread",{get:function(){return this._spread},set:function(a){if(this._spread=a,this._oscillators.length>1){var b=-a/2,c=a/(this._oscillators.length-1);this._forEach(function(a,d){a.detune.value=b+c*d})}}}),Object.defineProperty(a.FatOscillator.prototype,"count",{get:function(){return this._oscillators.length},set:function(b){if(b=Math.max(b,1),this._oscillators.length!==b){this._forEach(function(a){a.dispose()}),this._oscillators=[];for(var c=0;b>c;c++){var d=new a.Oscillator;this.type===a.Oscillator.Type.Custom?d.partials=this._partials:d.type=this._type,d.phase=this._phase,d.volume.value=-6-b,this.frequency.connect(d.frequency),this.detune.connect(d.detune),d.connect(this.output),this._oscillators[c]=d}this.spread=this._spread,this.state===a.State.Started&&this._forEach(function(a){a.start()})}}}),Object.defineProperty(a.FatOscillator.prototype,"phase",{get:function(){return this._phase},set:function(a){this._phase=a,this._forEach(function(b){b.phase=a})}}),Object.defineProperty(a.FatOscillator.prototype,"partials",{get:function(){return this._partials},set:function(b){this._partials=b,this._type=a.Oscillator.Type.Custom,this._forEach(function(a){a.partials=b})}}),a.FatOscillator.prototype.dispose=function(){return a.Source.prototype.dispose.call(this),this._writable(["frequency","detune"]),this.frequency.dispose(),this.frequency=null,this.detune.dispose(),this.detune=null,this._forEach(function(a){a.dispose()}),this._oscillators=null,this._partials=null,this},a.FatOscillator}),b(function(a){a.OmniOscillator=function(){var b=this.optionsObject(arguments,["frequency","type"],a.OmniOscillator.defaults);a.Source.call(this,b),this.frequency=new a.Signal(b.frequency,a.Type.Frequency),this.detune=new a.Signal(b.detune,a.Type.Cents),this._sourceType=void 0,this._oscillator=null,this.type=b.type,this._readOnly(["frequency","detune"]),this.set(b)},a.extend(a.OmniOscillator,a.Oscillator),a.OmniOscillator.defaults={frequency:440,detune:0,type:"sine",phase:0};var b={Pulse:"PulseOscillator",PWM:"PWMOscillator",Osc:"Oscillator",FM:"FMOscillator",AM:"AMOscillator",Fat:"FatOscillator"};return a.OmniOscillator.prototype._start=function(a){this._oscillator.start(a)},a.OmniOscillator.prototype._stop=function(a){this._oscillator.stop(a)},Object.defineProperty(a.OmniOscillator.prototype,"type",{get:function(){var a="";return this._sourceType===b.FM?a="fm":this._sourceType===b.AM?a="am":this._sourceType===b.Fat&&(a="fat"),a+this._oscillator.type},set:function(a){"fm"===a.substr(0,2)?(this._createNewOscillator(b.FM),this._oscillator.type=a.substr(2)):"am"===a.substr(0,2)?(this._createNewOscillator(b.AM),this._oscillator.type=a.substr(2)):"fat"===a.substr(0,3)?(this._createNewOscillator(b.Fat),this._oscillator.type=a.substr(3)):"pwm"===a?this._createNewOscillator(b.PWM):"pulse"===a?this._createNewOscillator(b.Pulse):(this._createNewOscillator(b.Osc),this._oscillator.type=a)}}),Object.defineProperty(a.OmniOscillator.prototype,"partials",{get:function(){return this._oscillator.partials},set:function(a){this._oscillator.partials=a}}),a.OmniOscillator.prototype.set=function(b,c){return"type"===b?this.type=c:this.isObject(b)&&b.hasOwnProperty("type")&&(this.type=b.type),a.prototype.set.apply(this,arguments),this},a.OmniOscillator.prototype._createNewOscillator=function(b){if(b!==this._sourceType){this._sourceType=b;var c=a[b],d=this.now()+this.blockTime;if(null!==this._oscillator){var e=this._oscillator;e.stop(d),setTimeout(function(){e.dispose(),e=null},1e3*this.blockTime)}this._oscillator=new c,this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this.state===a.State.Started&&this._oscillator.start(d)}},Object.defineProperty(a.OmniOscillator.prototype,"phase",{get:function(){return this._oscillator.phase},set:function(a){this._oscillator.phase=a}}),Object.defineProperty(a.OmniOscillator.prototype,"width",{get:function(){return this._sourceType===b.Pulse?this._oscillator.width:void 0}}),Object.defineProperty(a.OmniOscillator.prototype,"count",{get:function(){return this._sourceType===b.Fat?this._oscillator.count:void 0},set:function(a){this._sourceType===b.Fat&&(this._oscillator.count=a)}}),Object.defineProperty(a.OmniOscillator.prototype,"spread",{get:function(){return this._sourceType===b.Fat?this._oscillator.spread:void 0},set:function(a){this._sourceType===b.Fat&&(this._oscillator.spread=a)}}),Object.defineProperty(a.OmniOscillator.prototype,"modulationType",{get:function(){return this._sourceType===b.FM||this._sourceType===b.AM?this._oscillator.modulationType:void 0},set:function(a){(this._sourceType===b.FM||this._sourceType===b.AM)&&(this._oscillator.modulationType=a)}}),Object.defineProperty(a.OmniOscillator.prototype,"modulationIndex",{get:function(){return this._sourceType===b.FM?this._oscillator.modulationIndex:void 0}}),Object.defineProperty(a.OmniOscillator.prototype,"harmonicity",{get:function(){return this._sourceType===b.FM||this._sourceType===b.AM?this._oscillator.harmonicity:void 0}}),Object.defineProperty(a.OmniOscillator.prototype,"modulationFrequency",{get:function(){return this._sourceType===b.PWM?this._oscillator.modulationFrequency:void 0}}),a.OmniOscillator.prototype.dispose=function(){return a.Source.prototype.dispose.call(this),this._writable(["frequency","detune"]),this.detune.dispose(),this.detune=null,this.frequency.dispose(),this.frequency=null,this._oscillator.dispose(),this._oscillator=null,this._sourceType=null,this},a.OmniOscillator}),b(function(a){return a.Instrument=function(b){b=this.defaultArg(b,a.Instrument.defaults),this._volume=this.output=new a.Volume(b.volume),this.volume=this._volume.volume,this._readOnly("volume")},a.extend(a.Instrument),a.Instrument.defaults={volume:0},a.Instrument.prototype.triggerAttack=a.noOp,a.Instrument.prototype.triggerRelease=a.noOp,a.Instrument.prototype.triggerAttackRelease=function(a,b,c,d){return c=this.isUndef(c)?this.now()+this.blockTime:this.toSeconds(c),b=this.toSeconds(b),this.triggerAttack(a,c,d),this.triggerRelease(c+b),this},a.Instrument.prototype.dispose=function(){return a.prototype.dispose.call(this),this._volume.dispose(),this._volume=null,this._writable(["volume"]),this.volume=null,this},a.Instrument}),b(function(a){return a.Monophonic=function(b){b=this.defaultArg(b,a.Monophonic.defaults),a.Instrument.call(this,b),this.portamento=b.portamento},a.extend(a.Monophonic,a.Instrument),a.Monophonic.defaults={portamento:0},a.Monophonic.prototype.triggerAttack=function(a,b,c){return b=this.isUndef(b)?this.now()+this.blockTime:this.toSeconds(b),this._triggerEnvelopeAttack(b,c),this.setNote(a,b),this},a.Monophonic.prototype.triggerRelease=function(a){return a=this.isUndef(a)?this.now()+this.blockTime:this.toSeconds(a),this._triggerEnvelopeRelease(a),this},a.Monophonic.prototype._triggerEnvelopeAttack=function(){},a.Monophonic.prototype._triggerEnvelopeRelease=function(){},a.Monophonic.prototype.setNote=function(a,b){if(b=this.toSeconds(b),this.portamento>0){var c=this.frequency.value;this.frequency.setValueAtTime(c,b);var d=this.toSeconds(this.portamento);this.frequency.exponentialRampToValueAtTime(a,b+d)}else this.frequency.setValueAtTime(a,b);return this},a.Monophonic}),b(function(a){return a.Synth=function(b){b=this.defaultArg(b,a.Synth.defaults),a.Monophonic.call(this,b),this.oscillator=new a.OmniOscillator(b.oscillator),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new a.AmplitudeEnvelope(b.envelope),this.oscillator.chain(this.envelope,this.output),this.oscillator.start(),this._readOnly(["oscillator","frequency","detune","envelope"])},a.extend(a.Synth,a.Monophonic),a.Synth.defaults={oscillator:{type:"triangle"},envelope:{attack:.005,decay:.1,sustain:.3,release:1}},a.Synth.prototype._triggerEnvelopeAttack=function(a,b){return this.envelope.triggerAttack(a,b),this},a.Synth.prototype._triggerEnvelopeRelease=function(a){return this.envelope.triggerRelease(a),this},a.Synth.prototype.dispose=function(){return a.Monophonic.prototype.dispose.call(this),this._writable(["oscillator","frequency","detune","envelope"]),this.oscillator.dispose(),this.oscillator=null,this.envelope.dispose(),this.envelope=null,this.frequency=null,this.detune=null,this},a.Synth}),b(function(a){return a.AMSynth=function(b){b=this.defaultArg(b,a.AMSynth.defaults),a.Monophonic.call(this,b),this._carrier=new a.Synth,this._carrier.volume.value=-10,this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope.set(b.envelope),this._modulator=new a.Synth,this._modulator.volume.value=-10,this.modulation=this._modulator.oscillator.set(b.modulation),this.modulationEnvelope=this._modulator.envelope.set(b.modulationEnvelope),
this.frequency=new a.Signal(440,a.Type.Frequency),this.detune=new a.Signal(b.detune,a.Type.Cents),this.harmonicity=new a.Multiply(b.harmonicity),this.harmonicity.units=a.Type.Positive,this._modulationScale=new a.AudioToGain,this._modulationNode=new a.Gain,this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),this._readOnly(["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])},a.extend(a.AMSynth,a.Monophonic),a.AMSynth.defaults={harmonicity:3,detune:0,oscillator:{type:"sine"},envelope:{attack:.01,decay:.01,sustain:1,release:.5},modulation:{type:"square"},modulationEnvelope:{attack:.5,decay:0,sustain:1,release:.5}},a.AMSynth.prototype._triggerEnvelopeAttack=function(a,b){return a=this.toSeconds(a),this.envelope.triggerAttack(a,b),this.modulationEnvelope.triggerAttack(a,b),this},a.AMSynth.prototype._triggerEnvelopeRelease=function(a){return this.envelope.triggerRelease(a),this.modulationEnvelope.triggerRelease(a),this},a.AMSynth.prototype.dispose=function(){return a.Monophonic.prototype.dispose.call(this),this._writable(["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"]),this._carrier.dispose(),this._carrier=null,this._modulator.dispose(),this._modulator=null,this.frequency.dispose(),this.frequency=null,this.detune.dispose(),this.detune=null,this.harmonicity.dispose(),this.harmonicity=null,this._modulationScale.dispose(),this._modulationScale=null,this._modulationNode.dispose(),this._modulationNode=null,this.oscillator=null,this.envelope=null,this.modulationEnvelope=null,this.modulation=null,this},a.AMSynth}),b(function(a){return a.MonoSynth=function(b){b=this.defaultArg(b,a.MonoSynth.defaults),a.Monophonic.call(this,b),this.oscillator=new a.OmniOscillator(b.oscillator),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new a.Filter(b.filter),this.filterEnvelope=new a.FrequencyEnvelope(b.filterEnvelope),this.envelope=new a.AmplitudeEnvelope(b.envelope),this.oscillator.chain(this.filter,this.envelope,this.output),this.oscillator.start(),this.filterEnvelope.connect(this.filter.frequency),this._readOnly(["oscillator","frequency","detune","filter","filterEnvelope","envelope"])},a.extend(a.MonoSynth,a.Monophonic),a.MonoSynth.defaults={frequency:"C4",detune:0,oscillator:{type:"square"},filter:{Q:6,type:"lowpass",rolloff:-24},envelope:{attack:.005,decay:.1,sustain:.9,release:1},filterEnvelope:{attack:.06,decay:.2,sustain:.5,release:2,baseFrequency:200,octaves:7,exponent:2}},a.MonoSynth.prototype._triggerEnvelopeAttack=function(a,b){return this.envelope.triggerAttack(a,b),this.filterEnvelope.triggerAttack(a),this},a.MonoSynth.prototype._triggerEnvelopeRelease=function(a){return this.envelope.triggerRelease(a),this.filterEnvelope.triggerRelease(a),this},a.MonoSynth.prototype.dispose=function(){return a.Monophonic.prototype.dispose.call(this),this._writable(["oscillator","frequency","detune","filter","filterEnvelope","envelope"]),this.oscillator.dispose(),this.oscillator=null,this.envelope.dispose(),this.envelope=null,this.filterEnvelope.dispose(),this.filterEnvelope=null,this.filter.dispose(),this.filter=null,this.frequency=null,this.detune=null,this},a.MonoSynth}),b(function(a){return a.DuoSynth=function(b){b=this.defaultArg(b,a.DuoSynth.defaults),a.Monophonic.call(this,b),this.voice0=new a.MonoSynth(b.voice0),this.voice0.volume.value=-10,this.voice1=new a.MonoSynth(b.voice1),this.voice1.volume.value=-10,this._vibrato=new a.LFO(b.vibratoRate,-50,50),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=new a.Gain(b.vibratoAmount,a.Type.Positive),this.vibratoAmount=this._vibratoGain.gain,this.frequency=new a.Signal(440,a.Type.Frequency),this.harmonicity=new a.Multiply(b.harmonicity),this.harmonicity.units=a.Type.Positive,this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),this._readOnly(["voice0","voice1","frequency","vibratoAmount","vibratoRate"])},a.extend(a.DuoSynth,a.Monophonic),a.DuoSynth.defaults={vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:{volume:-10,portamento:0,oscillator:{type:"sine"},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}},voice1:{volume:-10,portamento:0,oscillator:{type:"sine"},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}},a.DuoSynth.prototype._triggerEnvelopeAttack=function(a,b){return a=this.toSeconds(a),this.voice0.envelope.triggerAttack(a,b),this.voice1.envelope.triggerAttack(a,b),this.voice0.filterEnvelope.triggerAttack(a),this.voice1.filterEnvelope.triggerAttack(a),this},a.DuoSynth.prototype._triggerEnvelopeRelease=function(a){return this.voice0.triggerRelease(a),this.voice1.triggerRelease(a),this},a.DuoSynth.prototype.dispose=function(){return a.Monophonic.prototype.dispose.call(this),this._writable(["voice0","voice1","frequency","vibratoAmount","vibratoRate"]),this.voice0.dispose(),this.voice0=null,this.voice1.dispose(),this.voice1=null,this.frequency.dispose(),this.frequency=null,this._vibratoGain.dispose(),this._vibratoGain=null,this._vibrato=null,this.harmonicity.dispose(),this.harmonicity=null,this.vibratoAmount.dispose(),this.vibratoAmount=null,this.vibratoRate=null,this},a.DuoSynth}),b(function(a){return a.FMSynth=function(b){b=this.defaultArg(b,a.FMSynth.defaults),a.Monophonic.call(this,b),this._carrier=new a.Synth(b.carrier),this._carrier.volume.value=-10,this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope.set(b.envelope),this._modulator=new a.Synth(b.modulator),this._modulator.volume.value=-10,this.modulation=this._modulator.oscillator.set(b.modulation),this.modulationEnvelope=this._modulator.envelope.set(b.modulationEnvelope),this.frequency=new a.Signal(440,a.Type.Frequency),this.detune=new a.Signal(b.detune,a.Type.Cents),this.harmonicity=new a.Multiply(b.harmonicity),this.harmonicity.units=a.Type.Positive,this.modulationIndex=new a.Multiply(b.modulationIndex),this.modulationIndex.units=a.Type.Positive,this._modulationNode=new a.Gain(0),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this._readOnly(["frequency","harmonicity","modulationIndex","oscillator","envelope","modulation","modulationEnvelope","detune"])},a.extend(a.FMSynth,a.Monophonic),a.FMSynth.defaults={harmonicity:3,modulationIndex:10,detune:0,oscillator:{type:"sine"},envelope:{attack:.01,decay:.01,sustain:1,release:.5},modulation:{type:"square"},modulationEnvelope:{attack:.5,decay:0,sustain:1,release:.5}},a.FMSynth.prototype._triggerEnvelopeAttack=function(a,b){return a=this.toSeconds(a),this.envelope.triggerAttack(a,b),this.modulationEnvelope.triggerAttack(a),this},a.FMSynth.prototype._triggerEnvelopeRelease=function(a){return a=this.toSeconds(a),this.envelope.triggerRelease(a),this.modulationEnvelope.triggerRelease(a),this},a.FMSynth.prototype.dispose=function(){return a.Monophonic.prototype.dispose.call(this),this._writable(["frequency","harmonicity","modulationIndex","oscillator","envelope","modulation","modulationEnvelope","detune"]),this._carrier.dispose(),this._carrier=null,this._modulator.dispose(),this._modulator=null,this.frequency.dispose(),this.frequency=null,this.detune.dispose(),this.detune=null,this.modulationIndex.dispose(),this.modulationIndex=null,this.harmonicity.dispose(),this.harmonicity=null,this._modulationNode.dispose(),this._modulationNode=null,this.oscillator=null,this.envelope=null,this.modulationEnvelope=null,this.modulation=null,this},a.FMSynth}),b(function(a){return a.MembraneSynth=function(b){b=this.defaultArg(b,a.MembraneSynth.defaults),a.Instrument.call(this,b),this.oscillator=new a.OmniOscillator(b.oscillator).start(),this.envelope=new a.AmplitudeEnvelope(b.envelope),this.octaves=b.octaves,this.pitchDecay=b.pitchDecay,this.oscillator.chain(this.envelope,this.output),this._readOnly(["oscillator","envelope"])},a.extend(a.MembraneSynth,a.Instrument),a.MembraneSynth.defaults={pitchDecay:.05,octaves:10,oscillator:{type:"sine"},envelope:{attack:.001,decay:.4,sustain:.01,release:1.4,attackCurve:"exponential"}},a.MembraneSynth.prototype.triggerAttack=function(a,b,c){b=this.toSeconds(b),a=this.toFrequency(a);var d=a*this.octaves;return this.oscillator.frequency.setValueAtTime(d,b),this.oscillator.frequency.exponentialRampToValueAtTime(a,b+this.toSeconds(this.pitchDecay)),this.envelope.triggerAttack(b,c),this},a.MembraneSynth.prototype.triggerRelease=function(a){return this.envelope.triggerRelease(a),this},a.MembraneSynth.prototype.dispose=function(){return a.Instrument.prototype.dispose.call(this),this._writable(["oscillator","envelope"]),this.oscillator.dispose(),this.oscillator=null,this.envelope.dispose(),this.envelope=null,this},a.MembraneSynth}),b(function(a){var b=[1,1.483,1.932,2.546,2.63,3.897];return a.MetalSynth=function(c){c=this.defaultArg(c,a.MetalSynth.defaults),a.Instrument.call(this,c),this.frequency=new a.Signal(c.frequency,a.Type.Frequency),this._oscillators=[],this._freqMultipliers=[],this._amplitue=new a.Gain(0).connect(this.output),this._highpass=new a.Filter({type:"highpass",Q:-3.0102999566398125}).connect(this._amplitue),this._octaves=c.octaves,this._filterFreqScaler=new a.Scale(c.resonance,7e3),this.envelope=new a.Envelope({attack:c.envelope.attack,attackCurve:"linear",decay:c.envelope.decay,sustain:0,release:c.envelope.release}).chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitue.gain);for(var d=0;d<b.length;d++){var e=new a.FMOscillator({type:"square",modulationType:"square",harmonicity:c.harmonicity,modulationIndex:c.modulationIndex});e.connect(this._highpass).start(0),this._oscillators[d]=e;var f=new a.Multiply(b[d]);this._freqMultipliers[d]=f,this.frequency.chain(f,e.frequency)}this.octaves=c.octaves},a.extend(a.MetalSynth,a.Instrument),a.MetalSynth.defaults={frequency:200,envelope:{attack:.001,decay:1.4,release:.2},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1.5},a.MetalSynth.prototype.triggerAttack=function(a,b){return a=this.toSeconds(a),b=this.defaultArg(b,1),this.envelope.triggerAttack(a,b),this},a.MetalSynth.prototype.triggerRelease=function(a){return a=this.toSeconds(a),this.envelope.triggerRelease(a),this},a.MetalSynth.prototype.triggerAttackRelease=function(a,b,c){return b=this.toSeconds(b),a=this.toSeconds(a),this.triggerAttack(b,c),this.triggerRelease(b+a),this},Object.defineProperty(a.MetalSynth.prototype,"modulationIndex",{get:function(){return this._oscillators[0].modulationIndex.value},set:function(a){for(var b=0;b<this._oscillators.length;b++)this._oscillators[b].modulationIndex.value=a}}),Object.defineProperty(a.MetalSynth.prototype,"harmonicity",{get:function(){return this._oscillators[0].harmonicity.value},set:function(a){for(var b=0;b<this._oscillators.length;b++)this._oscillators[b].harmonicity.value=a}}),Object.defineProperty(a.MetalSynth.prototype,"resonance",{get:function(){return this._filterFreqScaler.min},set:function(a){this._filterFreqScaler.min=a,this.octaves=this._octaves}}),Object.defineProperty(a.MetalSynth.prototype,"octaves",{get:function(){return this._octaves},set:function(a){this._octaves=a,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,a)}}),a.MetalSynth.prototype.dispose=function(){a.Instrument.prototype.dispose.call(this);for(var b=0;b<this._oscillators.length;b++)this._oscillators[b].dispose(),this._freqMultipliers[b].dispose();this._oscillators=null,this._freqMultipliers=null,this.frequency.dispose(),this.frequency=null,this._filterFreqScaler.dispose(),this._filterFreqScaler=null,this._amplitue.dispose(),this._amplitue=null,this.envelope.dispose(),this.envelope=null,this._highpass.dispose(),this._highpass=null},a.MetalSynth}),b(function(a){return window.AudioBufferSourceNode&&!AudioBufferSourceNode.prototype.start&&(AudioBufferSourceNode.prototype.start=AudioBufferSourceNode.prototype.noteGrainOn,AudioBufferSourceNode.prototype.stop=AudioBufferSourceNode.prototype.noteOff),a.BufferSource=function(){var b=this.optionsObject(arguments,["buffer","onended"],a.BufferSource.defaults);this.onended=b.onended,this._startTime=-1,this._stopTime=-1,this._gainNode=this.output=new a.Gain,this._source=this.context.createBufferSource(),this._source.connect(this._gainNode),this.playbackRate=new a.Param(this._source.playbackRate,a.Type.Positive),this.fadeIn=b.fadeIn,this.fadeOut=b.fadeOut,this._gain=1,this._onendedTimeout=-1,this.isUndef(b.buffer)||(this.buffer=b.buffer),this.loop=b.loop},a.extend(a.BufferSource),a.BufferSource.defaults={onended:a.noOp,fadeIn:0,fadeOut:0},Object.defineProperty(a.BufferSource.prototype,"state",{get:function(){var b=this.now();return-1!==this._startTime&&b>=this._startTime&&b<this._stopTime?a.State.Started:a.State.Stopped}}),a.BufferSource.prototype.start=function(a,b,c,d,e){if(-1!==this._startTime)throw new Error("Tone.BufferSource: can only be started once.");return this.buffer&&(a=this.toSeconds(a),b=this.loop?this.defaultArg(b,this.loopStart):this.defaultArg(b,0),b=this.toSeconds(b),a=this.toSeconds(a),this._source.start(a,b),d=this.defaultArg(d,1),this._gain=d,e=this.isUndef(e)?this.toSeconds(this.fadeIn):this.toSeconds(e),e>0?(this._gainNode.gain.setValueAtTime(0,a),this._gainNode.gain.linearRampToValueAtTime(this._gain,a+e)):this._gainNode.gain.setValueAtTime(d,a),this._startTime=a+e,this.isUndef(c)||(c=this.defaultArg(c,this.buffer.duration-b),c=this.toSeconds(c),this.stop(a+c+e,e))),this},a.BufferSource.prototype.stop=function(a,b){return this.buffer&&(a=this.toSeconds(a),b=this.isUndef(b)?this.toSeconds(this.fadeOut):this.toSeconds(b),this._stopTime=a+b,this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),b>0?(this._gainNode.gain.setValueAtTime(this._gain,a),this._gainNode.gain.linearRampToValueAtTime(0,a+b),a+=b):this._gainNode.gain.setValueAtTime(0,a),this.isNumber(this._source.playbackState)&&2!==this._source.playbackState||this._source.stop(a),clearTimeout(this._onendedTimeout),this._onendedTimeout=setTimeout(this._onended.bind(this),1e3*(this._stopTime-this.now()))),this},a.BufferSource.prototype._onended=function(){this.onended(this),this.dispose()},Object.defineProperty(a.BufferSource.prototype,"loopStart",{get:function(){return this._source.loopStart},set:function(a){this._source.loopStart=this.toSeconds(a)}}),Object.defineProperty(a.BufferSource.prototype,"loopEnd",{get:function(){return this._source.loopEnd},set:function(a){this._source.loopEnd=this.toSeconds(a)}}),Object.defineProperty(a.BufferSource.prototype,"buffer",{get:function(){return this._source?this._source.buffer:null},set:function(b){b instanceof a.Buffer?this._source.buffer=b.get():this._source.buffer=b}}),Object.defineProperty(a.BufferSource.prototype,"loop",{get:function(){return this._source.loop},set:function(a){this._source.loop=a}}),a.BufferSource.prototype.dispose=function(){return this.onended=null,this._source&&(this._source.disconnect(),this._source=null),this._gainNode&&(this._gainNode.dispose(),this._gainNode=null),this._startTime=-1,this.playbackRate=null,this.output=null,clearTimeout(this._onendedTimeout),this},a.BufferSource}),b(function(a){function b(){for(var b in e)f[b]=(new a.Buffer).fromArray(e[b])}a.Noise=function(){var b=this.optionsObject(arguments,["type"],a.Noise.defaults);a.Source.call(this,b),this._source=null,this._type=b.type,this._playbackRate=b.playbackRate},a.extend(a.Noise,a.Source),a.Noise.defaults={type:"white",playbackRate:1},Object.defineProperty(a.Noise.prototype,"type",{get:function(){return this._type},set:function(b){if(this._type!==b){if(!(b in f))throw new TypeError("Tone.Noise: invalid type: "+b);if(this._type=b,this.state===a.State.Started){var c=this.now()+this.blockTime;this._stop(c),this._start(c)}}}}),Object.defineProperty(a.Noise.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(a){this._playbackRate=a,this._source&&(this._source.playbackRate.value=a)}}),a.Noise.prototype._start=function(b){var c=f[this._type];this._source=new a.BufferSource(c).connect(this.output),this._source.loop=!0,this._source.playbackRate.value=this._playbackRate,this._source.start(this.toSeconds(b),Math.random()*(c.duration-.001))},a.Noise.prototype._stop=function(a){this._source&&(this._source.stop(this.toSeconds(a)),this._source=null)},a.Noise.prototype.dispose=function(){return a.Source.prototype.dispose.call(this),null!==this._source&&(this._source.disconnect(),this._source=null),this._buffer=null,this};var c=220500,d=2,e={pink:function(){for(var a=[],b=0;d>b;b++){var e=new Float32Array(c);a[b]=e;var f,g,h,i,j,k,l;f=g=h=i=j=k=l=0;for(var m=0;c>m;m++){var n=2*Math.random()-1;f=.99886*f+.0555179*n,g=.99332*g+.0750759*n,h=.969*h+.153852*n,i=.8665*i+.3104856*n,j=.55*j+.5329522*n,k=-.7616*k-.016898*n,e[m]=f+g+h+i+j+k+l+.5362*n,e[m]*=.11,l=.115926*n}}return a}(),brown:function(){for(var a=[],b=0;d>b;b++){var e=new Float32Array(c);a[b]=e;for(var f=0,g=0;c>g;g++){var h=2*Math.random()-1;e[g]=(f+.02*h)/1.02,f=e[g],e[g]*=3.5}}return a}(),white:function(){for(var a=[],b=0;d>b;b++){var e=new Float32Array(c);a[b]=e;for(var f=0;c>f;f++)e[f]=2*Math.random()-1}return a}()},f={};return b(),a.Context.on("init",b),a.Noise}),b(function(a){return a.NoiseSynth=function(b){b=this.defaultArg(b,a.NoiseSynth.defaults),a.Instrument.call(this,b),this.noise=new a.Noise,this.envelope=new a.AmplitudeEnvelope(b.envelope),this.noise.chain(this.envelope,this.output),this.noise.start(),this._readOnly(["noise","envelope"])},a.extend(a.NoiseSynth,a.Instrument),a.NoiseSynth.defaults={noise:{type:"white"},envelope:{attack:.005,decay:.1,sustain:0}},a.NoiseSynth.prototype.triggerAttack=function(a,b){return this.envelope.triggerAttack(a,b),this},a.NoiseSynth.prototype.triggerRelease=function(a){return this.envelope.triggerRelease(a),this},a.NoiseSynth.prototype.triggerAttackRelease=function(a,b,c){return b=this.toSeconds(b),a=this.toSeconds(a),this.triggerAttack(b,c),this.triggerRelease(b+a),this},a.NoiseSynth.prototype.dispose=function(){return a.Instrument.prototype.dispose.call(this),this._writable(["noise","envelope"]),this.noise.dispose(),this.noise=null,this.envelope.dispose(),this.envelope=null,this},a.NoiseSynth}),b(function(a){return a.PluckSynth=function(b){b=this.defaultArg(b,a.PluckSynth.defaults),a.Instrument.call(this,b),this._noise=new a.Noise("pink"),this.attackNoise=b.attackNoise,this._lfcf=new a.LowpassCombFilter({resonance:b.resonance,dampening:b.dampening}),this.resonance=this._lfcf.resonance,this.dampening=this._lfcf.dampening,this._noise.connect(this._lfcf),this._lfcf.connect(this.output),this._readOnly(["resonance","dampening"])},a.extend(a.PluckSynth,a.Instrument),a.PluckSynth.defaults={attackNoise:1,dampening:4e3,resonance:.9},a.PluckSynth.prototype.triggerAttack=function(a,b){a=this.toFrequency(a),b=this.toSeconds(b);var c=1/a;return this._lfcf.delayTime.setValueAtTime(c,b),this._noise.start(b),this._noise.stop(b+c*this.attackNoise),this},a.PluckSynth.prototype.dispose=function(){return a.Instrument.prototype.dispose.call(this),this._noise.dispose(),this._lfcf.dispose(),this._noise=null,this._lfcf=null,this._writable(["resonance","dampening"]),this.dampening=null,this.resonance=null,this},a.PluckSynth}),b(function(a){return a.PolySynth=function(){a.Instrument.call(this);var b=this.optionsObject(arguments,["polyphony","voice"],a.PolySynth.defaults);b=this.defaultArg(b,a.Instrument.defaults),b.polyphony=Math.min(a.PolySynth.MAX_POLYPHONY,b.polyphony),this.voices=new Array(b.polyphony),this._triggers=new Array(b.polyphony),this.detune=new a.Signal(b.detune,a.Type.Cents),this._readOnly("detune");for(var c=0;c<b.polyphony;c++){var d=new b.voice(arguments[2],arguments[3]);this.voices[c]=d,d.connect(this.output),d.hasOwnProperty("detune")&&this.detune.connect(d.detune),this._triggers[c]={release:-1,note:null,voice:d}}this.volume.value=b.volume},a.extend(a.PolySynth,a.Instrument),a.PolySynth.defaults={polyphony:4,volume:0,detune:0,voice:a.Synth},a.PolySynth.prototype.triggerAttack=function(a,b,c){Array.isArray(a)||(a=[a]),b=this.toSeconds(b);for(var d=0;d<a.length;d++){for(var e=a[d],f=this._triggers[0],g=0,h=1;h<this._triggers.length;h++)this._triggers[h].release<f.release&&(f=this._triggers[h],g=h);f.release=1/0,f.note=JSON.stringify(e),f.voice.triggerAttack(e,b,c)}return this},a.PolySynth.prototype.triggerAttackRelease=function(a,b,c,d){if(c=this.toSeconds(c),this.triggerAttack(a,c,d),this.isArray(b)&&this.isArray(a))for(var e=0;e<a.length;e++){var f=b[Math.min(e,b.length-1)];this.triggerRelease(a[e],c+this.toSeconds(f))}else this.triggerRelease(a,c+this.toSeconds(b));return this},a.PolySynth.prototype.triggerRelease=function(a,b){Array.isArray(a)||(a=[a]),b=this.toSeconds(b);for(var c=0;c<a.length;c++)for(var d=JSON.stringify(a[c]),e=0;e<this._triggers.length;e++){var f=this._triggers[e];f.note===d&&f.release>b&&(f.voice.triggerRelease(b),f.release=b)}return this},a.PolySynth.prototype.set=function(a,b,c){for(var d=0;d<this.voices.length;d++)this.voices[d].set(a,b,c);return this},a.PolySynth.prototype.get=function(a){return this.voices[0].get(a)},a.PolySynth.prototype.releaseAll=function(a){a=this.toSeconds(a);for(var b=0;b<this._triggers.length;b++){var c=this._triggers[b];c.release>a&&(c.release=a,c.voice.triggerRelease(a))}return this},a.PolySynth.prototype.dispose=function(){a.Instrument.prototype.dispose.call(this);for(var b=0;b<this.voices.length;b++)this.voices[b].dispose(),this.voices[b]=null;return this._writable("detune"),this.detune.dispose(),this.detune=null,this.voices=null,this._triggers=null,this},a.PolySynth.MAX_POLYPHONY=20,a.PolySynth}),b(function(a){return a.Player=function(b){var c;b instanceof a.Buffer?(b=b.get(),c=a.Player.defaults):c=this.optionsObject(arguments,["url","onload"],a.Player.defaults),a.Source.call(this,c),this._source=null,this.autostart=c.autostart,this._buffer=new a.Buffer({url:c.url,onload:this._onload.bind(this,c.onload),reverse:c.reverse}),b instanceof AudioBuffer&&this._buffer.set(b),this._loop=c.loop,this._loopStart=c.loopStart,this._loopEnd=c.loopEnd,this._playbackRate=c.playbackRate,this.retrigger=c.retrigger},a.extend(a.Player,a.Source),a.Player.defaults={onload:a.noOp,playbackRate:1,loop:!1,autostart:!1,loopStart:0,loopEnd:0,retrigger:!1,reverse:!1},a.Player.prototype.load=function(a,b){return this._buffer.load(a,this._onload.bind(this,b))},a.Player.prototype._onload=function(b){b=this.defaultArg(b,a.noOp),b(this),this.autostart&&this.start()},a.Player.prototype._start=function(b,c,d){if(!this._buffer.loaded)throw Error("Tone.Player: tried to start Player before the buffer was loaded");if(c=this._loop?this.defaultArg(c,this._loopStart):this.defaultArg(c,0),c=this.toSeconds(c),d=this.defaultArg(d,Math.max(this._buffer.duration-c,0)),d=this.toSeconds(d),b=this.toSeconds(b),this._source=this.context.createBufferSource(),this._source.buffer=this._buffer.get(),this._loop?(this._source.loop=this._loop,this._source.loopStart=this.toSeconds(this._loopStart),this._source.loopEnd=this.toSeconds(this._loopEnd)):this._synced||this._state.setStateAtTime(a.State.Stopped,b+d),this._source.playbackRate.value=this._playbackRate,this._source.connect(this.output),this._loop){var e=this._source.loopEnd||this._buffer.duration,f=this._source.loopStart,g=e-f;if(c>e)for(;c>e;)c-=g;this._source.start(b,c)}else this._source.start(b,c,d);return this},a.Player.prototype._stop=function(a){return this._source&&(this._source.stop(this.toSeconds(a)),this._source=null),this},a.Player.prototype.seek=function(b,c){return c=this.toSeconds(c),this._state.getValueAtTime(c)===a.State.Started&&(b=this.toSeconds(b),this._stop(c),this._start(c,b)),this},a.Player.prototype.setLoopPoints=function(a,b){return this.loopStart=a,this.loopEnd=b,this},Object.defineProperty(a.Player.prototype,"loopStart",{get:function(){return this._loopStart},set:function(a){this._loopStart=a,this._source&&(this._source.loopStart=this.toSeconds(a))}}),Object.defineProperty(a.Player.prototype,"loopEnd",{get:function(){return this._loopEnd},set:function(a){this._loopEnd=a,this._source&&(this._source.loopEnd=this.toSeconds(a))}}),Object.defineProperty(a.Player.prototype,"buffer",{get:function(){return this._buffer},set:function(a){this._buffer.set(a)}}),Object.defineProperty(a.Player.prototype,"loop",{get:function(){return this._loop},set:function(a){this._loop=a,this._source&&(this._source.loop=a)}}),Object.defineProperty(a.Player.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(a){this._playbackRate=a,this._source&&(this._source.playbackRate.value=a)}}),Object.defineProperty(a.Player.prototype,"reverse",{get:function(){return this._buffer.reverse},set:function(a){this._buffer.reverse=a}}),a.Player.prototype.dispose=function(){return a.Source.prototype.dispose.call(this),null!==this._source&&(this._source.disconnect(),this._source=null),this._buffer.dispose(),this._buffer=null,this},a.Player}),b(function(a){return a.Sampler=function(){var b=this.optionsObject(arguments,["url","onload"],a.Sampler.defaults);a.Instrument.call(this,b),this.player=new a.Player(b.url,b.onload),this.player.retrigger=!0,this.envelope=new a.AmplitudeEnvelope(b.envelope),this.player.chain(this.envelope,this.output),this._readOnly(["player","envelope"]),this.loop=b.loop,this.reverse=b.reverse},a.extend(a.Sampler,a.Instrument),a.Sampler.defaults={onload:a.noOp,loop:!1,reverse:!1,envelope:{attack:.001,decay:0,sustain:1,release:.1}},a.Sampler.prototype.triggerAttack=function(a,b,c){return b=this.toSeconds(b),a=this.defaultArg(a,0),this.player.playbackRate=this.intervalToFrequencyRatio(a),this.player.start(b),this.envelope.triggerAttack(b,c),this},a.Sampler.prototype.triggerRelease=function(a){return a=this.toSeconds(a),this.envelope.triggerRelease(a),this.player.stop(this.toSeconds(this.envelope.release)+a),this},Object.defineProperty(a.Sampler.prototype,"loop",{get:function(){return this.player.loop},set:function(a){this.player.loop=a}}),Object.defineProperty(a.Sampler.prototype,"reverse",{get:function(){return this.player.reverse},set:function(a){this.player.reverse=a}}),Object.defineProperty(a.Sampler.prototype,"buffer",{get:function(){return this.player.buffer},set:function(a){this.player.buffer=a}}),a.Sampler.prototype.dispose=function(){return a.Instrument.prototype.dispose.call(this),this._writable(["player","envelope"]),this.player.dispose(),this.player=null,this.envelope.dispose(),this.envelope=null,this},a.Sampler}),b(function(a){return a.GainToAudio=function(){this._norm=this.input=this.output=new a.WaveShaper(function(a){return 2*Math.abs(a)-1})},a.extend(a.GainToAudio,a.SignalBase),a.GainToAudio.prototype.dispose=function(){return a.prototype.dispose.call(this),this._norm.dispose(),this._norm=null,this},a.GainToAudio}),b(function(a){return a.Normalize=function(b,c){this._inputMin=this.defaultArg(b,0),this._inputMax=this.defaultArg(c,1),this._sub=this.input=new a.Add(0),this._div=this.output=new a.Multiply(1),this._sub.connect(this._div),this._setRange()},a.extend(a.Normalize,a.SignalBase),Object.defineProperty(a.Normalize.prototype,"min",{get:function(){return this._inputMin},set:function(a){this._inputMin=a,this._setRange()}}),Object.defineProperty(a.Normalize.prototype,"max",{get:function(){return this._inputMax},set:function(a){this._inputMax=a,this._setRange()}}),a.Normalize.prototype._setRange=function(){this._sub.value=-this._inputMin,this._div.value=1/(this._inputMax-this._inputMin)},a.Normalize.prototype.dispose=function(){return a.prototype.dispose.call(this),this._sub.dispose(),this._sub=null,this._div.dispose(),this._div=null,this},a.Normalize}),b(function(a){return a.MultiPlayer=function(){var b=this.optionsObject(arguments,["urls","onload"],a.MultiPlayer.defaults);b.urls instanceof a.Buffers?this.buffers=b.urls:this.buffers=new a.Buffers(b.urls,b.onload),this._activeSources={},this.fadeIn=b.fadeIn,this.fadeOut=b.fadeOut,this._volume=this.output=new a.Volume(b.volume),this.volume=this._volume.volume,this._readOnly("volume"),this._volume.output.output.channelCount=2,this._volume.output.output.channelCountMode="explicit",this.mute=b.mute},a.extend(a.MultiPlayer,a.Source),a.MultiPlayer.defaults={onload:a.noOp,fadeIn:0,fadeOut:0},a.MultiPlayer.prototype._makeSource=function(b){var c;this.isString(b)||this.isNumber(b)?c=this.buffers.get(b).get():b instanceof a.Buffer?c=b.get():b instanceof AudioBuffer&&(c=b);var d=new a.BufferSource(c).connect(this.output);return this._activeSources.hasOwnProperty(b)||(this._activeSources[b]=[]),this._activeSources[b].push(d),d},a.MultiPlayer.prototype.start=function(a,b,c,d,e,f){b=this.toSeconds(b);var g=this._makeSource(a);return g.start(b,c,d,this.defaultArg(f,1),this.fadeIn),d&&g.stop(b+this.toSeconds(d),this.fadeOut),e=this.defaultArg(e,0),g.playbackRate.value=this.intervalToFrequencyRatio(e),this},a.MultiPlayer.prototype.startLoop=function(a,b,c,d,e,f,g){b=this.toSeconds(b);var h=this._makeSource(a);return h.loop=!0,h.loopStart=this.toSeconds(this.defaultArg(d,0)),h.loopEnd=this.toSeconds(this.defaultArg(e,0)),h.start(b,c,void 0,this.defaultArg(g,1),this.fadeIn),f=this.defaultArg(f,0),h.playbackRate.value=this.intervalToFrequencyRatio(f),this},a.MultiPlayer.prototype.stop=function(a,b){if(!this._activeSources[a]||!this._activeSources[a].length)throw new Error("Tone.MultiPlayer: cannot stop a buffer that hasn't been started or is already stopped");return b=this.toSeconds(b),this._activeSources[a].shift().stop(b,this.fadeOut),this},a.MultiPlayer.prototype.stopAll=function(a){a=this.toSeconds(a);for(var b in this._activeSources)for(var c=this._activeSources[b],d=0;d<c.length;d++)c[d].stop(a);return this},a.MultiPlayer.prototype.add=function(a,b,c){return this.buffers.add(a,b,c),this},Object.defineProperty(a.MultiPlayer.prototype,"state",{get:function(){return this._activeSources.length>0?a.State.Started:a.State.Stopped}}),Object.defineProperty(a.MultiPlayer.prototype,"mute",{get:function(){return this._volume.mute},set:function(a){this._volume.mute=a}}),a.MultiPlayer.prototype.dispose=function(){a.prototype.dispose.call(this),this._volume.dispose(),this._volume=null,this._writable("volume"),this.volume=null;for(var b in this._activeSources)this._activeSources[b].forEach(function(a){a.dispose()});return this.buffers.dispose(),this.buffers=null,this._activeSources=null,this},a.MultiPlayer}),b(function(a){return a.GrainPlayer=function(){var b=this.optionsObject(arguments,["url","onload"],a.GrainPlayer.defaults);a.Source.call(this),this.buffer=new a.Buffer(b.url,b.onload),this._player=(new a.MultiPlayer).connect(this.output),this._clock=new a.Clock(this._tick.bind(this),1),this._loopStart=0,this._loopEnd=0,this._playbackRate=b.playbackRate,this._grainSize=b.grainSize,this._overlap=b.overlap,this.detune=b.detune,this.drift=b.drift,this.overlap=b.overlap,this.loop=b.loop,this.playbackRate=b.playbackRate,this.grainSize=b.grainSize,this.loopStart=b.loopStart,this.loopEnd=b.loopEnd,this.reverse=b.reverse},a.extend(a.GrainPlayer,a.Source),a.GrainPlayer.defaults={onload:a.noOp,overlap:.1,grainSize:.2,drift:0,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1},a.GrainPlayer.prototype._start=function(a,b,c){b=this.defaultArg(b,0),b=this.toSeconds(b),
a=this.toSeconds(a),this._offset=b,this._clock.start(a),this._player.volume.setValueAtTime(0,a),c&&this._stop(a+this.toSeconds(c))},a.GrainPlayer.prototype._stop=function(a){this._clock.stop(a),this._player.volume.cancelScheduledValues(a),this._player.volume.setValueAtTime(-(1/0),a)},a.GrainPlayer.prototype._tick=function(a){var b=this.buffer.duration;this.loop&&this._loopEnd>0&&(b=this._loopEnd);var c=(2*Math.random()-1)*this.drift,d=this._offset-this._overlap+c,e=this.detune/100;d=Math.max(d,0),d=Math.min(d,b);var f=this._player.fadeIn;if(this.loop&&this._offset>b){var g=this._offset-b;this._player.start(this.buffer,a,d,g+this._overlap,e),d=this._offset%b,this._offset=this._loopStart,this._player.fadeIn=0,this._player.start(this.buffer,a+g,this._offset,d+this._overlap,e)}else this._offset>b?this.stop(a):(0===d&&(this._player.fadeIn=0),this._player.start(this.buffer,a,d,this.grainSize+this._overlap,e));this._player.fadeIn=f;var h=this._clock._nextTick-a;this._offset+=h*this._playbackRate},a.GrainPlayer.prototype.scrub=function(a,b){return this._offset=this.toSeconds(a),this._tick(this.toSeconds(b)),this},Object.defineProperty(a.GrainPlayer.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(a){this._playbackRate=a,this.grainSize=this._grainSize}}),Object.defineProperty(a.GrainPlayer.prototype,"loopStart",{get:function(){return this._loopStart},set:function(a){this._loopStart=this.toSeconds(a)}}),Object.defineProperty(a.GrainPlayer.prototype,"loopEnd",{get:function(){return this._loopEnd},set:function(a){this._loopEnd=this.toSeconds(a)}}),Object.defineProperty(a.GrainPlayer.prototype,"reverse",{get:function(){return this.buffer.reverse},set:function(a){this.buffer.reverse=a}}),Object.defineProperty(a.GrainPlayer.prototype,"grainSize",{get:function(){return this._grainSize},set:function(a){this._grainSize=this.toSeconds(a),this._clock.frequency.value=this._playbackRate/this._grainSize}}),Object.defineProperty(a.GrainPlayer.prototype,"overlap",{get:function(){return this._overlap},set:function(a){a=this.toSeconds(a),this._overlap=a,this._overlap<0?(this._player.fadeIn=.01,this._player.fadeOut=.01):(this._player.fadeIn=a,this._player.fadeOut=a)}}),a.GrainPlayer.prototype.dispose=function(){return a.Source.prototype.dispose.call(this),this.buffer.dispose(),this.buffer=null,this._player.dispose(),this._player=null,this._clock.dispose(),this._clock=null,this},a.GrainPlayer}),b(function(a){return a.UserMedia=function(){var b=this.optionsObject(arguments,["volume"],a.UserMedia.defaults);this._mediaStream=null,this._stream=null,this._device=null,this._volume=this.output=new a.Volume(b.volume),this.volume=this._volume.volume,this._readOnly("volume"),this.mute=b.mute},a.extend(a.UserMedia),a.UserMedia.defaults={volume:0,mute:!1},a.UserMedia.prototype.open=function(a){return a=this.defaultArg(a,"default"),this.enumerateDevices().then(function(b){var c;if(this.isNumber(a)?c=b[a]:(c=b.find(function(b){return b.label===a||b.deviceId===a}),c||(c=b[0])),!c)throw new Error("Tone.UserMedia: no matching audio inputs.");this._device=c;var d={audio:{deviceId:c.deviceId,echoCancellation:!1,sampleRate:this.context.sampleRate}};return navigator.mediaDevices.getUserMedia(d).then(function(a){return this._stream||(this._stream=a,this._mediaStream=this.context.createMediaStreamSource(a),this._mediaStream.connect(this.output)),this}.bind(this))}.bind(this))},a.UserMedia.prototype.close=function(){return this._stream&&(this._stream.getAudioTracks().forEach(function(a){a.stop()}),this._stream=null,this._mediaStream.disconnect(),this._mediaStream=null),this._device=null,this},a.UserMedia.prototype.enumerateDevices=function(){return navigator.mediaDevices.enumerateDevices().then(function(a){return a.filter(function(a){return"audioinput"===a.kind})})},Object.defineProperty(a.UserMedia.prototype,"state",{get:function(){return this._stream&&this._stream.active?a.State.Started:a.State.Stopped}}),Object.defineProperty(a.UserMedia.prototype,"deviceId",{get:function(){return this._device?this._device.deviceId:void 0}}),Object.defineProperty(a.UserMedia.prototype,"groupId",{get:function(){return this._device?this._device.groupId:void 0}}),Object.defineProperty(a.UserMedia.prototype,"label",{get:function(){return this._device?this._device.label:void 0}}),Object.defineProperty(a.UserMedia.prototype,"mute",{get:function(){return this._volume.mute},set:function(a){this._volume.mute=a}}),a.UserMedia.prototype.dispose=function(){return a.prototype.dispose.call(this),this.close(),this._writable("volume"),this._volume.dispose(),this._volume=null,this.volume=null,this},Object.defineProperty(a.UserMedia,"supported",{get:function(){return!a.prototype.isUndef(navigator.mediaDevices)&&a.prototype.isFunction(navigator.mediaDevices.getUserMedia)}}),a.UserMedia}),c})}]);